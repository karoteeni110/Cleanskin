<opml version="2.0">
  <head>
    <title>Counting Lyndon factors</title>
    <abstract>In this paper, we determine the maximum number of distinct Lyndon
factors that a word of length can contain. We also derive formulas for
the expected total number of Lyndon factors in a word of length on an
alphabet of size , as well as the expected number of distinct Lyndon
factors in such a word. The minimum number of distinct Lyndon factors in
a word of length is and the minimum total number is , with both bounds
being achieved by where is a letter. A more interesting question to ask
is WHAT IS THE MINIMUM NUMBER OF DISTINCT LYNDON FACTORS IN A LYNDON
WORD OF LENGTH ? In this direction, it is known that an optimal lower
bound for the number of distinct Lyndon factors in a Lyndon word of
length is , where denotes the GOLDEN RATIO . Moreover, this lower bound
is attained by the so-called finite FIBONACCI LYNDON WORDS, which are
precisely the Lyndon factors of the well-known INFINITE FIBONACCI WORD &#8212;
a special example of a INFINITE STURMIAN WORD. Saari conjectured that if
is Lyndon word of length , , containing the least number of distinct
Lyndon factors over all Lyndon words of the same length, then is a
CHRISTOFFEL WORD (i.e., a Lyndon factor of an infinite Sturmian word).
We give a counterexample to this conjecture. Furthermore, we generalise
Saari&#8217;s result on the number of distinct Lyndon factors of a Fibonacci
Lyndon word by determining the number of distinct Lyndon factors of a
given Christoffel word. We end with two open problems. </abstract>
  </head>
  <body>
<outline _note="This paper is concerned with counting Lyndon words occurring in a given word of length&#160;. First, let us recall some terminology and notation from combinatorics on words (see, e.g., ). A WORD is a (possibly empty) finite or infinite sequence of symbols, called LETTERS, drawn from a given finite set , called an ALPHABET, of size . A finite word with each is said to have LENGTH , written . The [EMPTY WORD]{} is the unique word of length , denoted by . The set of all finite words over (including the empty word) is denoted by , and for each integer , the set of all words of length over is denoted by .  A finite word is said to be a FACTOR of a given finite word if there exist words , such that . If , then is said to be a PREFIX of , and if , then is said to be a SUFFIX of . If both and are non-empty, we say that is a PROPER FACTOR of . A prefix (respectively, suffix) of that is not equal to itself is said to be a PROPER PREFIX (respectively, PROPER SUFFIX) of . A factor of an infinite word is a finite word that occurs within it.  A non-empty word that is both a proper prefix and a proper suffix of a finite word is said to be a BORDER of . We say that a word which has only an empty border is BORDERLESS. If, for some word&#160;, ( times for some integer ), we write , and is called the -TH POWER OF . A non-empty finite word is said to be PRIMITIVE if it is not a power of a shorter word. Two finite words , are said to be CONJUGATE if there exist words such that and . Accordingly, conjugate words are cyclic shifts of one another, and thus conjugacy is an equivalence relation. A primitive word of length has exactly distinct conjugates. For example, the primitive word of length has distinct conjugates; namely, itself and the six words , , , , , . The set of all conjugates of a finite word is called the CONJUGACY CLASS of .  In this paper we consider only words on an ordered alphabet where . This total order on naturally induces a LEXICOGRAPHICAL ORDER (i.e., an alphabetical order) on the set of all finite words over . A LYNDON WORD over is a non-empty primitive word that is the lexicographically least word in its conjugacy class, i.e., or for all non-empty words such that (e.g., see ). Equivalently, a non-empty finite word over is Lyndon if and only if or for all proper suffixes of . Note, in particular, that there is a unique Lyndon word in the conjugacy class of any given primitive word. For example, is the unique Lyndon conjugate of the primitive word . Lyndon words are named after R.C.&#160;Lyndon , who introduced them in 1954 under the name of &#8220;standard lexicographic sequences&#8221;. Such words are well known to be borderless .  We begin in Section&#160;  by computing , the maximum number of distinct Lyndon factors in a word of length on an alphabet of size . In Section&#160;  we compute , the expected total number of Lyndon factors (that is, counted according to their multiplicity) in a word of length over , while Section&#160;  computes , the expected number of distinct Lyndon factors in word of length over . Section&#160;  considers distinct Lyndon factors in a Lyndon word of length ; in particular, we generalise a result of Saari on the number of distinct Lyndon factors of a FIBONACCI LYNDON WORD by determining the number of distinct Lyndon factors of a given CHRISTOFFEL WORD (i.e., a Lyndon factor of an infinite Sturmian word &#8212; to be defined later). Lastly, in Section&#160; , we state some open problems." text="Introduction">
</outline>
<outline _note="Let be the maximum number of distinct Lyndon factors in a word of length on the alphabet . We want to find a word that achieves , given and . It is clear that a necessary condition for attaining the maximum is that takes the form . This word contains factors of lengths , of which each is a Lyndon word except those of the form . The number of powers of each is , including itself. The total number of Lyndon factors in is therefore  where the final counts the single letters . We claim that the summation is minimised when the differ by at most one. Suppose to the contrary that for some , and . It is easily checked that for . Thus the summation term will be minimised when each equals either or . If , where , then and . If then each equals . We therefore have the following result.    If , where , then and the maximum is attained using  If then  If , Theorem&#160;  gives  The following table shows values of for low values of ." text="The maximum number of distinct Lyndon factors in a word">
</outline>
<outline _note="We now wish to calculate the total number of Lyndon factors (that is, counted according to multiplicity) appearing in all words in . Consider a Lyndon word of length and a position , , in words of length . Words containing starting at position have the form where is any word on with length . Thus there will be words in which contain in this position. This will be the same for any of the possible values of so in the words in there will be appearances of . This is the same for all Lyndon words of this length. The number of such Lyndon words is of the number of primitive words of this length, since exactly one conjugate of each primitive word is Lyndon. The number of primitive words of length (, equation (1.3.7)) is where is the M&#246;bius function. To get the total number of Lyndon factors appearing in , we sum over possible values of : Dividing by gives the expected total number of Lyndon factors in a word of length on the alphabet . Table   below shows values for and low values of ." text="The expected total number of Lyndon factors in a word">
</outline>
<outline _note="We use the notation from above, with being the set . Most of the following analysis counts the number of words in that contain at least one factor equal to a specific Lyndon word&#160;. At the end we sum over all possible . Let be a non-empty set of positions in a word and let if contains factors equal to at each position in beginning at a position in the set , and 0 otherwise. Note that may contain other factors equal to . We claim that  If contains no factor equal to then equals 0 for all so the &#8220;otherwise&#8221; part of the claim holds. Suppose contains copies of beginning at positions in and nowhere else. Then equals 1 if and only if is any non-empty subset of , so the left hand side of ( ) becomes This equals 1 since the final sum is the binomial expansion of . The number of words in which contain at least one factor equal to is therefore  We now evaluate . This is counting the words in which have factors beginning at positions . It clearly equals 0 if since then there is no room in for factors (recalling that is Lyndon, therefore borderless, and therefore cannot intersect a copy of itself). We also need the members of to be separated by at least . The number of such sets is Once is chosen there are ways of choosing the letters in which are not in the specified factors . Thus  Substituting in ( ) we see that the number of words in which contain at least one occurrence of is To get the expected number of distinct Lyndon factors in a word of length , we sum this over all with length at most , using the same technique as in the previous section, and divide by&#160;. Replacing with we get the following:  The following table shows values of for low values of and several values of ." text="The expected number of distinct Lyndon factors in a word">
</outline>
<outline _note="Minimising the number of Lyndon factors over words of length is not very interesting: the minimum number of distinct Lyndon factors is and the minimum total number is . Both bounds are achieved by where is a letter. A more interesting question has been studied by Saari : WHAT IS THE MINIMUM NUMBER OF DISTINCT LYNDON FACTORS IN A LYNDON WORD OF LENGTH ? He proved that an optimal lower bound for the number of distinct Lyndon factors in a Lyndon word of length is where denotes the GOLDEN RATIO . Moreover, this lower bound is attained by the so-called finite FIBONACCI LYNDON WORDS, which are precisely the Lyndon factors of the well-known INFINITE FIBONACCI WORD &#8212; a special example of a CHARACTERISTIC STURMIAN WORD.  Following the notation and terminology in , an infinite word over is STURMIAN if and only if there exists an irrational , and a real number , such that is one of the following two infinite words: defined by  The irrational is called the SLOPE of and is the INTERCEPT. If , we have where is called the CHARACTERISTIC STURMIAN WORD of slope . Sturmian words of the same slope have the same set of factors , so when studying the factors of Sturmian words, it suffices to consider only the characteristic ones.  The INFINITE FIBONACCI WORD is the characteristic Sturmian word of slope . It can be constructed as the limit of an infinite sequence of so-called FINITE FIBONACCI WORDS , defined by: That is, , , , , , etc. (where is a prefix of for each ), and we have  The length of the -th finite Fibonacci word is the -th FIBONACCI NUMBER , defined by: for .  More generally, any characteristic Sturmian word can be constructed as the limit of an infinite sequence of finite words. To this end, we recall that every irrational has a unique simple continued fraction expansion: where each is a positive integer. The -th CONVERGENT of is defined by where the sequences and are given by  Suppose , with and all other . To the DIRECTIVE SEQUENCE , we associate a sequence of words defined by Such a sequence of words is called a STANDARD SEQUENCE, and we have Note that is a suffix of and is a suffix of for all .  Standard sequences are related to characteristic Sturmian words in the following way. Observe that, for any , is a prefix of , which gives obvious meaning to as an infinite word. In fact, one can prove that each is a prefix of , and we have  The following lemma collects together some properties of the STANDARD WORDS . Note that from now on when referring to Lyndon words over the alphabet we assume the natural order&#160;.    Let be the characteristic Sturmian word of slope with where the words are defined as above.  For all , is a primitive word .  For all , there exist uniquely determined palindromes , , such that where and .  For all , the reversal of is the -nd conjugate of , and hence the conjugacy class of is closed under reversal.  The Lyndon factors of of length at least are precisely the Lyndon conjugates of the (primitive) standard words for all .  The following lemma is a generalisation of .    Let be the characteristic Sturmian word of slope with where with . The Lyndon conjugate of is the word for all . Moreover, every Lyndon factor of that is shorter than is either a prefix or a suffix of .  First we show that, for all , the Lyndon conjugate of is the word . If , then is clearly a conjugate of and it is Lyndon . On the other hand, if , then is a clearly a conjugate of , and since the conjugacy class of is closed under reversal and is a palindrome (by Lemma&#160; ), it follows that is a conjugate of and it is Lyndon .  To prove the second claim, it suffices to show that if , then the Lyndon conjugate of is a prefix or suffix of (since, by Lemma&#160; , the Lyndon factors of of length at least are precisely the Lyndon conjugates of the (primitive) standard words in ). The claim is true for and since and . It is also true for because is the Lyndon conjugate of itself, and is a prefix of if and a suffix of if . Now suppose that . Then implies that is a prefix of . Furthermore, since is a palindrome, the reversal of is a suffix of . Therefore if , then its Lyndon conjugate is a prefix of ; otherwise, if , then its Lyndon conjugate is a suffix of .  The Lyndon factors of (characteristic) Sturmian words of length at least (i.e., the Lyndon conjugates of standard words) over are precisely the so-called CHRISTOFFEL WORDS beginning with the letter&#160; (see, e.g., the nice survey ). Christoffel words take the form and where and is ITERATED PALINDROMIC CLOSURE, defined by: where denotes the shortest palindrome beginning with (called the PALINDROMIC CLOSURE of ). For example, where the underlined letters indicate the points at which palindromic closure is applied.  Let , be co-prime integers with . The rational has two distinct simple continued fraction expansions: where and all other . The so-called CHRISTOFFEL WORD OF SLOPE beginning with the letter is the unique Sturmian Lyndon word over of length containing occurrences of the letter , given by: For example, the Christoffel word of slope beginning with the letter is .    Note, in particular, that the Christoffel word of slope beginning with the letter is precisely the Lyndon conjugate of the standard word where , , and for (see, e.g., ).  For all , the FIBONACCI LYNDON WORD OF LENGTH (i.e., the Lyndon conjugate of the finite Fibonacci word ) is the Christoffel word of slope beginning with .  Saari proved that if is a Lyndon word with for some , then contains at least distinct Lyndon factors, with equality if and only if is the Fibonacci Lyndon word of length . For example, is the Fibonacci Lyndon word of length and contains the minimum number () of distinct Lyndon factors over all Lyndon words of the same length. Saari also made the following conjecture.   If is a Lyndon word of length , , containing the least number of distinct Lyndon factors over all Lyndon words of the same length, then is a CHRISTOFFEL WORD.  The number 6 is excluded because the following words all contain 7 distinct Lyndon factors, which is the minimum for length 6 words, and only the first and last are Christoffel:  However the conjecture is not true. The following Lyndon word has length 28 and contains 10 distinct Lyndon factors &#8212; the minimum number of distinct Lyndon factors in a Lyndon word of this length &#8212; but it is not Christoffel (compare the prefix of length 5 to the suffix of length 5):  The minimum of 10 distinct Lyndon factors for a Lyndon word of length is also attained by the Lyndon word which is the Christoffel word of slope .  We now generalise Saari&#8217;s result on the number of distinct Lyndon factors in a Fibonacci Lyndon word by determining the number of distinct Lyndon factors in a given Christoffel word. Let denote the number of distinct Lyndon factors in a word .    If is a Sturmian Lyndon word on with , i.e., a Christoffel word (beginning with the letter ) of slope for some co-prime integers , with , then .  The word is the Lyndon conjugate of the standard word with , , and for (see Remark&#160; ). By Lemma  , the Lyndon conjugates of for are either prefixes or suffixes of . Moreover, for each with , the standard word contains distinct Lyndon factors of lengths for . By Lemma&#160; , these are the only Lyndon factors of the Lyndon word besides itself and the two letters and . Hence .  The above result is a generalisation of , which reworded (with the indexing of Fibonacci words and numbers shifted back by ) states that if is the Fibonacci Lyndon word of length for some , i.e., the Christoffel word of slope beginning with the letter , then .  **Examples:**  The Christoffel word of slope beginning with the letter , namely , is the FIBONACCI LYNDON WORD of length that contains the minimum number () of distinct Lyndon factors for its length.  The Christoffel word of slope beginning with the letter , namely , is a Sturmian Lyndon word of length containing the minimum number () of distinct Lyndon factors for its length.  The Christoffel word of slope beginning with the letter , namely , is the Fibonacci Lyndon word of length containing the minimum number () of distinct Lyndon factors for its length." text="Distinct Lyndon factors in a Lyndon word">
</outline>
<outline _note="Open Problem 1  :   One might suspect that any given Christoffel word contains the     minimum number of distinct Lyndon factors over all Lyndon words of     the same length. However, this is not true. For instance, the     Christoffel word of slope beginning with the letter , namely ,     contains () distinct Lyndon factors, but the minimum number of     distinct Lyndon factors of a Lyndon word of length is actually&#160;.     This minimum is attained by the Christoffel word of slope .      Is it true that the minimum number of distinct Lyndon factors over     all Lyndon words of the same length is attained by at least one     Christoffel word of that length?  Open Problem 2  :   Tables   and  , showing values for and , raise the     question of whether there may exist asymptotic formulas for these     quantities, simpler than the exact values displayed in equations     ( ) and ( ), respectively.  [99]{}  J.&#160;Berstel, Sturmian and episturmian words (a survey of some recent results), CAI 2007, LECTURE NOTES IN COMPUTER SCIENCE, vol. 4728, 2007, pp.&#160;23&#8211;47.  J. Berstel, A. de Luca, Sturmian words, Lyndon words and trees, THEORET. COMPUT. SCI. 178 (1997) 171&#8211;203.  T.C.&#160;Brown, Descriptions of the characteristic sequence of an irrational, CANAD. MATH. BULL. 36 (1993) 15&#8211;21.  K.T.&#160;Chen, R.H.&#160;Fox, R.C.&#160;Lyndon, Free differential calculus, IV. The quotient groups of the lower central series, ANN. MATH. 68 (1958) 81&#8211;95.  A. de Luca, Sturmian words: structure, combinatorics and their arithmetics, THEORET. COMPUT. SCI. 183 (1997) 45&#8211;82.  A. de Luca, F. Mignosi, Some combinatorial properties of Sturmian words, THEORET. COMPUT. SCI. 136 (1994) 361&#8211;385.  J.P.&#160;Duval, Factorizing words over an ordered alphabet, J. ALGS. 4 (1983) 363&#8211;381.  A.S.&#160;Fraenkel, M.&#160;Mushkin, U.&#160;Tassa, Determination of by its sequence of differences, CANAD. MATH. BULL. [21]{} (1978) 441&#8211;446.  A. Glen, On Sturmian and episturmian words, and related topics, PHD THESIS, The University of Adelaide, Australia, April 2006, &lt;http://hdl.handle.net/2440/37765&gt;.  M.&#160;Lothaire, COMBINATORICS ON WORDS, ENCYCLOPEDIA OF MATHEMATICS AND ITS APPLICATIONS, vol.&#160;17, CAMBRIDGE UNIVERSITY PRESS, UK, 1997.  M.&#160;Lothaire, ALGEBRAIC COMBINATORICS ON WORDS, ENCYCLOPEDIA OF MATHEMATICS AND ITS APPLICATIONS, vol.&#160;90, CAMBRIDGE UNIVERSITY PRESS, UK, 2002.  R.C. Lyndon, On Burnside&#8217;s problem, TRANS. AMER. MATH. SOC. 77 (1954) 202&#8211;215.  K. Saari, Lyndon words and Fibonacci numbers, J. COMBIN. THEORY SER. A 121 (2014) 34&#8211;44." text="Open Problems">
</outline>
  </body>
</opml>