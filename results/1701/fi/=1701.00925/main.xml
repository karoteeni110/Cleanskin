<opml version="2.0">
  <head>
    <title>Warped Gaussian Processes Occupancy Mapping with Uncertain Inputs</title>
    <abstract>In this paper, we study extensions to the Gaussian Processes (GPs)
continuous occupancy mapping problem. There are two classes of occupancy
mapping problems that we particularly investigate. The first problem is
related to mapping under pose uncertainty and how to propagate pose
estimation uncertainty into the map inference. We develop expected
kernel and expected sub-map notions to deal with uncertain inputs. In
the second problem, we account for the complication of the robot&#8217;s
perception noise using Warped Gaussian Processes (WGPs). This approach
allows for non-Gaussian noise in the observation space and captures the
possible nonlinearity in that space better than standard GPs. The
developed techniques can be applied separately or concurrently to a
standard GP occupancy mapping problem. According to our experimental
results, although taking into account pose uncertainty leads, as
expected, to more uncertain maps, by modeling the nonlinearities present
in the observation space WGPs improve the map quality. </abstract>
  </head>
  <body>
<outline _note="many scenarios such as robotic navigation, the robot pose is partially observable; and we have access only to an estimate (noise-corrupted version) of the robot pose, as depicted in Figure&#160; . Under these circumstances, the robot requires to navigate in an uncertain environment&#160;, and the probability distribution of the robot pose will be the input for the mapping problem. In practice, and based on the application, most of the occupancy mapping techniques ignore robot pose uncertainty for map representation; either for efficiency or as the resultant map is not suitable for navigation. Furthermore, dense representation of the state often makes uncertainty propagation intractable. This problem is not unique to GAUSSIAN PROCESSES OCCUPANCY MAPS (GPOMs), but it is also present in OCCUPANCY GRID MAPS. With this motivation, we study the problem of GP occupancy mapping under pose uncertainty. The first solution is uncertainty propagation through KERNEL functions. The second solution we propose uses the EXPECTED SUB-MAP notion to incorporate pose uncertainties into the map building process.  The second problem studied is motivated by the fact that due to the smoothness common in the resultant regressed maps, inferring a high-quality map compatible with the actual shape of the environment is non-trivial&#160;. Furthermore, for a complicated task such as robotic mapping&#160;, the additive white Gaussian noise assumption in standard GPs can be simplistic. To account for these problems, we improve the incremental GPOM technique using WARPED GAUSSIAN PROCESSES (WGPs)&#160;. The core idea is to map the target values through a warping (transforming) function to capture the nonlinear behavior of the observations.  We tackle the mentioned problems to improve map quality and provide results using incremental WGP Occupancy Maps (WGPOMs) under pose uncertainty.Probabilities and probability densities are not distinguished in general. Matrices are capitalized in bold, such as in , and vectors are in lower case bold type, such as in . Vectors are column-wise and means integers from to . The Euclidean norm is shown by . and denote the trace and the determinant of matrix , respectively. Random variables, such as , and their realizations, , are sometimes denoted interchangeably. denotes a reference to the -th element of the variable. An alphabet such as denotes a set. A reference to a test set quantity is shown by . The -by- identity matrix is denoted by . The sign function, and the absolute value are denoted by , and , respectively. Finally, and denote the expected value and variance of a random variable, respectively. &#10;A review of related works is given in the following section. We first discuss the problem of Gaussian processes occupancy mapping under pose uncertainty in Section&#160; ; followed by presenting the warped Gaussian processes occupancy mapping in Section&#160; . Robotic mapping experiments are presented in Section&#160; , and finally, Section&#160;  concludes the paper. &#10;" text="INTRODUCTION">
  </outline>
<outline _note="Current robotic navigation algorithms rely on a dense environment representation for safe navigation. Occupancy grid maps are the standard way of environment representation in robotics and are the natural choice for online implementations&#160;. However, they simplify the mapping problem to a set of independent cells and estimate the probability of occupancy for each cell by ignoring the correlation between them. The map posterior is then approximated as the product of its marginals.  The FastSLAM algorithm&#160; exploits RAO-BLACKWELLIZED PARTICLE FILTERS&#160;, and relies on the fact that, given the robot trajectory, landmarks are conditionally independent. In practice, FastSLAM can generate accurate maps; however, it suffers from degeneracy and depletion problems&#160;. Full SLAM methods estimate the SMOOTHING DISTRIBUTION of the robot trajectory and the map, given all available data. In robotics, full SLAM using probabilistic graphical models representation and the MAXIMUM A POSTERIORI estimate derived by solving a nonlinear least squares problem&#160; can be considered the state-of-the-art and we thus focus our attention on using a pose-graph estimation of the robot trajectory as in&#160;.  Kernel methods in the form of Gaussian processes (GPs) framework&#160; are non-parametric regression and classification techniques that have been used to model spatial phenomena&#160;. The development of GPOM is discussed in&#160;. The incremental GP map building using the Bayesian Committee Machine (BCM) technique&#160; is developed in&#160; and for online applications in&#160;. In&#160;, the Hilbert maps technique is proposed and is more scalable. However, it is an approximation for continuous occupancy mapping and produces maps with less accuracy than GPOM.  Approximate methods for uncertainty propagation into GPs models through kernel functions are proposed in&#160;, and developed for GPOM in&#160;. Generally speaking, training and query points can both be noisy. In&#160;, the problem of prediction at an uncertain input is discussed while it is assumed the input in training data is noise free. In&#160;, using a similar approach, the idea is extended to account for noisy training input. Similarly, we assume the input in training data is uncertain and query points are deterministic. In this paper, we employ this technique and develop the expected sub-map technique for approximate uncertainty propagation, then incorporate both techniques into the WGPOM framework." text="Related Work">
</outline>
<outline _note="The main challenge in building occupancy maps under robot pose uncertainty is the dense representation of map belief which makes uncertainty propagation computationally expensive. Maximum likelihood dense map representations are currently the common practice which does not necessarily produce correct maps, especially if pose estimation uncertainties are significant. This popularity can be understood from the fact that employing an environment representation constructed with significant uncertainties results in vague obstacles and free space and is not suitable for robotic motion planning and navigation. However, accounting for pose uncertainties in mapping is not only important for correct map representations, but also for motion planning (prediction) tasks.Let be the set of possible static occupancy maps. We consider the map of the environment as an -tuple random variable whose elements are described by a normal distribution . Let be the set of spatial coordinates to build a map on. Let be a noisy measurement (class label; and for unoccupied and occupied, respectively) at a noisy sample , where and . Define a training set which consists of noisy measurements at noisy locations. Let function , i.e. , be the real underlying process that we model as a Gaussian process , where is the COVARIANCE FUNCTION or KERNEL; and and are either in the training or the test (query) sets. Estimate , i.e. the map posterior probability given a noisy training set. For a given query point in the map, , GP predicts a mean, , and an associated variance, . We can write . To show a valid probabilistic representation of the map , the classification step squashes data into the range .  We propose two methods to solve the defined problem. The first approach is based on the EXPECTED KERNEL. The alternative approach, EXPECTED SUB-MAP, treats all inputs deterministically and propagates pose uncertainties through uncertain map fusion. The following assumptions are made in the present work:  In the problem of Gaussian processes occupancy mapping under robot pose uncertainty, query points are deterministic.    The covariance function in the expected sub-map method is stationary, .  Using Assumption&#160; , map inference in the local coordinates of the robot (local map) can be done using deterministic inputs. &#10;The equation of motion of the robot is governed by the nonlinear partially observable equation as follows. moreover, with appropriate linearization at the current state estimate, we can predict the state covariance matrix as where and are the Jacobian matrices calculated with respect to and , respectively. &#10;The core idea in the expected kernel approach is taking an expectation of the covariance function over uncertain inputs. Let be distributed according to a probability distribution . The expected covariance function can be computed as In general, this integral is analytically intractable; therefore we employ two numerical approximations to solve&#160;. However, for the case of the squared exponential (SE) kernel, a closed-form solution exists&#160;. Hence, once the expected covariance matrix is calculated, we can compute the predictive conditional distribution for a single query point similar to standard GPs. &#10;We exploit the fact that a stationary covariance function does not depend on the selected coordinates, i.e. the global or a local sub-map frame. Therefore, we treat all training inputs as noise free and conduct map inference using deterministic inputs in the local (sensor/robot) frame. To fuse the inferred sub-map into the global map, we draw independent samples from . In other words, by taking the expectation over the location of the sub-map, we propagate uncertainty of each map point to its neighborhood. Thus, we have , and by drawing independent samples from and using a Monte-Carlo approximation it follows that . Note that any sub-map can be fused into the global map using the algorithms in&#160;. However, as a result of sampling, the expected map, , is similar to a mixture distribution; therefore, the mean and variance calculations need to be addressed accordingly. We present the following proposition to calculate the first two moments of .    Let be random variables that are distributed according to probability densities , with constant weights , where . The probability density function of the mixture is . Given and , the mean and variance of the mixture density is given by and .  The proof follows from the fact that for the -th moment of the mixture, we can write and define the variance accordingly.  In incremental map building, to compute , sampled sub-maps can be fused into the global map using the following equations where is the updated global map built using the -th independently drawn robot pose sample, and and can be computed point-wise for every map point .  The proof directly follows from Lemma&#160; .  Therefore, we can perform incremental map fusion by considering the robot pose uncertainty without modifying the GP framework. &#10;" text="Mapping under Pose Uncertainty">
  </outline>
<outline _note="The primary challenge in modeling the environment &#8220;accurately&#8221; is the different nature of free and occupied classes. Free space tends to span vast areas while occupied space often represents the structural shape of the environment. In addition, the assumption of additive Gaussian noise in the observations in standard GPs is unable to capture complexity in observations appropriately. We propose to employ Warped Gaussian Processes to account for the nonlinear behavior of observations. This method is appealing as it allows for non-Gaussian noise in the observation space. However, exact inference is not possible anymore, and approximate inference algorithms such as EXPECTATION PROPAGATION&#160; or VARIATIONAL BAYES&#160; are required.  The idea to accommodate non-Gaussian distributions and noise is to use a nonlinear monotonic function for warping (transforming) the observation space&#160;. Let be a transformation from the observation space to a latent space as where denotes the vector of warping function hyperparameters and is the vector of latent targets. Now we can re-write the GP formulation for the latent target and by accounting for the transformation between a true observation and the latent target, the negative log of the marginal likelihood (NLML) can be written as in which the last term is the Jacobian of the defined transformation. To compute the mean at a new test point, it is possible to calculate the expectation of the inverse warping function over the latent target predictive density, therefore This integral can be computed numerically using Gauss-Hermite quadrature with a weighted sum of the inverse warping function .  Inspired by the neural network transfer functions, a sum of hyperbolic tangent functions satisfies the requirements for the transformation to be monotonic and at the same time allowing for complicated mappings. With hyperparameters vector , the function can be defined as where the parameter is the number of steps and has to be set depending on the complexity of observations, , , and . Alternative warping functions can be polynomials ():  Figure&#160;  shows a simple yet challenging example for regression using standard and Warped GPs. The measurements are corrupted by an additive Gaussian noise. Even though the noise is still Gaussian, the complicated structure of the underlying function makes modeling it non-trivial. Note that the inputs are deterministic.  By increasing the number of training points, it is possible to generate more accurate results using standard GPs. However, given the cubic time complexity of GPs, dense training datasets reduce the scalability of the algorithms significantly." text="Warped GP Occupancy Mapping">
</outline>
<outline _note="We now present results from experiments using a synthetic dataset and a real publicly available pose-graph dataset. The synthetic dataset, Figure&#160; , is built in such a way as to highlight the strength of WGPOM to model complicated structural shapes and to better appreciate the mapping performance of the incremental GPOM and WGPOM under the expected kernel (EK) and expected sub-map (ESM) uncertainty propagation techniques. On the other hand, the Intel dataset&#160;, as shown in Figure&#160; , exposes an extreme real-world example of the problem at hand where highly uncertain robot poses along the estimated trajectory are present.  We compare the overall taken time to build the entire map (using all the available data) as well as the map accuracy using the Area Under the receiving operating characteristic Curve (AUC)&#160;. For each model, we learn the hyperparameters at the first increment of map building by minimization of the NLML using the first set of training data with manual supervision to ensure the best possible outcome for all models. The data processing and computations for the incremental map building are implemented using MATLAB.  \  \ The map of the environment, the robot trajectory, the observations collected at each pose using a simulated rangefinder sensor, together with the evolution of the robot pose uncertainty due to its motion noise, are illustrated in Figure&#160; . The uncertainty ellipsoids show the worst-case covariance of the robot position, and there is no uncertainty reduction along the path by closing loops.  Details from the model selection, compared techniques, and conducted experiments are collected in Table&#160; . We use Mat&#233;rn () covariance function for GPOM as its performance has been shown fitting in earlier works&#160;. For WGPOM, we use SE covariance function with Automatic Relevance Determination (ARD)&#160;. Since the observations do not cover the entire map, we use with as the warping function to improve the extrapolation ability of GPs (Figure&#160; ). The experiment for each mapping technique using EK and ESM uncertainty propagation is repeated by increasing the robot motion noise covariance in five steps. In Figure&#160; , the map accuracy and runtime comparisons of all methods using AUC are shown. In the bottom plot, the runtime for the ESM is higher than the EK for both mapping techniques. From the top plot, we can see that applying WGPs improves the map quality regardless of the uncertainty propagation choice. The expected kernel is computed using Gauss-Hermite quadrature with sample points, and the expected sub-map computations are performed using Monte-Carlo approximations with samples. When increasing the number of samples from to we did not observe any improvement in the map accuracy.  Figure&#160;  illustrates the results of all combinations of the proposed techniques. GPOM and WGPOM by ignoring the robot pose uncertainty are shown in Figures&#160;  and  , respectively. WGPOM demonstrates a better discrimination performance between class labels in the absence of measurements. This effect can be seen in the middle of the smaller star in both maps. Note that further optimization of hyperparameters can lead to over-fitting instead of solving the discussed problem.  Even though ESM and EK try to achieve the same goal, they demonstrate different behaviors. Generally speaking, integration over the covariance function (EK) has a smoothing effect that sometimes can be desirable. For example, in all the presented maps the central part of the map due to the lack of observation is partially complete. As a result of this smoothing effect of the EK, this part is correctly classified to be closer to the free space class. However, the probabilities are closer to , and the robot cannot be completely confident about the status of the area. Alternatively, ESM leads to relatively more confident maps with smaller smoothing effects. The resultant maps are safer for navigation as the gap between occupied and unoccupied areas is classified as an unknown region. While this behavior can be an appealing property from a motion planning point of view, the occupied areas are faded; and we cannot see the structural shape of the environment accurately. Overall, by propagating more uncertainty into the map inference process, we expect less accuracy in the outcome and more realistic estimation of the belief. However, WGPs by modeling nonlinearity in the observation space improve the map quality. &#10;The experimental results of occupancy mapping using the Intel dataset are shown in Table&#160;  and Figure&#160; . In the absence of a complete groundtruth map, the groundtruth map for this dataset is generated using the estimated robot trajectory and rangefinder measurements. In this way, the groundtruth map has the same orientation which makes the comparison convenient. The covariance function used is an intrinsically sparse kernel&#160;. The logic behind this choice is that the structural shape of the environment is complex, and it is cluttered with random people and typical office furniture; therefore, using a covariance function that correlates map points over a long range is not suitable. We use the Sparse covariance function for both GPOM and WGPOM and their corresponding uncertainty propagation experiments.     Table&#160;  shows the runtime and accuracy comparison of the mapping techniques. In this scenario, where the pose uncertainties are ignored, GPOM performs marginally better than WGPOM. This result, shown in Figures&#160;  and  , can be understood from the fact that WGPOM has covered more partially observed areas in the map. While this is desirable, in the absence of a complete groundtruth map, it leads to a lower AUC. However, WGPOM maintains more accurate maps by incorporating the pose uncertainties which is the actual problem to be solved.  \  In this experiment, the uncertainty propagation using the ESM method leads to poor map qualities and the maps, shown in Figures&#160;  and  , are almost entirely faded due to the significant pose uncertainties resulting from the robot repeatedly traveling through the same areas. This fading effect could be partially mitigated by increasing the number of samples, but based on the runtimes in Table&#160; , it is not justifiable. Nevertheless, WGPOM using the EK demonstrates a better performance in comparison to all methods that incorporated pose uncertainties; moreover, it produces a map that is also usable for navigation tasks, i.e. obstacle avoidance, and path planning. &#10;Uncertainty propagation through the developed methods can provide safer maps for robotic navigation. However, long-term uncertainty propagation leads to highly faded maps. If the uncertainty at each step is large and the robot cannot improve the localization confidence through loop-closures, this fading effect is more severe. Also, the uncertainty of the robot orientation has a large impact on the map quality. As we have seen in the presented results, in the expected sub-map approach, if the orientation uncertainty is significant, integration using a small number of samples leads to poor map accuracies. The expected kernel technique has an advantage from this perspective, as the unscented transform maps the measurement into the map space, and samples are related to the map spatial dimensions.  It is also demonstrated that the concept of accounting for possible nonlinearities in the observation space, here through the warping function, has desirable effects on the map quality. Our results showed that regardless of the uncertainty propagation technique, applying WGPs provide better maps than standard GPs. We reiterate that by ignoring the robot pose uncertainty, the map is a potentially incorrect representation of the environment.  Finding an appropriate warping function that is compatible with non-Gaussianity in the observation space can be time-consuming unless the model selection is performed in a more systematic way. In this work, we tried several functions and chose the best one. Moreover, since the exact inference is not possible, approximate methods may not always converge. Although the upper-bound time complexity of WGPOM is similar to that of GPOM, in practice for larger datasets the inference takes longer. Improving the computational efficiency of the proposed methods is an interesting direction to follow. &#10;For both GPOM and WGPOM, the worst-case time complexity is cubic in the number of training data, . For ESM, the number of sub-map fusion into the global map scales linearly with the number of samples, , and the sub-map fusion involves a nearest neighbor query for each test point resulting in . In the case of two-dimensional mapping, using Gauss-Hermite quadrature, the time complexity of EK computation is quadratic in the number of sample points and together with sub-map fusion leads to . In EK, applying the unscented transform to all training points involves a Cholesky factorization of the input covariance matrix which is ignored for the two-dimensional case. &#10;" text="Results and Discussion">
  </outline>
<outline _note="In this paper, we studied incremental GP occupancy mapping extensions through warped GPs. Since occupancy maps have dense belief representations, the robot pose uncertainty is often ignored. We proposed two methods to incorporate robot pose uncertainty into the map inference, the expected kernel and the expected sub-map. While the expected kernel handles the input uncertainty within the GPs framework, the expected sub-map exploits the inherent property of stationary covariance functions for map inference in the local frame with deterministic inputs. The proposed methods can also be useful if the belief representation is not dense (as opposed to occupancy mapping). Furthermore, the WGPOM technique can deal with the nonlinear behavior of measurements through a nonlinear transformation which improves the ability of GPs to learn complex structural shapes more accurately, especially, under uncertain inputs.  Future work includes further examinations of the proposed methods in practical robotic exploration and obstacle avoidance scenarios, for example, using currently popular visual-inertial odometry systems." text="CONCLUSION">
</outline>
  </body>
</opml>