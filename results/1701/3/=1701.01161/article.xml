<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>The World’s First Real-Time Testbed for Massive MIMO: Design,
Implementation, and Validation</title>
    <abstract>This paper sets up a framework for designing a massive testbed by
investigating and system-level requirements such as processing
complexity, duplexing mode and frame structure. Taking these into
account, a generic system and processing partitioning is proposed which
allows flexible scaling and processing distribution onto a multitude of
physically separated devices. Based on the given constraints such as
maximum number of links and maximum throughput for interconnections
combined with processing capabilities, the framework allows to evaluate
modular components. To verify our design approach, we present the LuMaMi
(Lund University Massive MIMO) testbed which constitutes the first
reconfigurable real-time platform for prototyping massive MIMO.
Utilizing up to 100 antennas and more than 50 , up to 12 are served on
the same time/frequency resource using an LTE-like -based transmission
scheme. Proof-of-concept tests with this system show that massive MIMO
can simultaneously serve a multitude of users in a static indoor and
static outdoor environment utilizing the same time/frequency resource. </abstract>
  </head>
  <body>
<outline text="Introduction" _note="an unconventionally high number of antennas (hundreds or even higher) is employed to serve a factor of ten less . Due to the excess number of antennas, linear signal processing may be used to spatially focus energy with high precision, allowing to separate a multitude of in the spatial domain while using the same time/frequency resource . theory promises a variety of gains, increase in spectral and energy efficiencies as compared with single antenna and traditional MU-MIMO systems, thereby tackling the key challenges defined for 5G.  Although is a promising theoretical concept, further development requires prototype systems for proof-of-concept and performance evaluation under real-world conditions to identify any further challenges in practice. Because of its importance, both industry and academia are making efforts in building testbeds, including the Argos testbed with 96-antennas, Eurecom’s 64-antenna compatible testbed, Samsung’s Full-Dimension (FD) testbed and Facebook’s Project Aries. Nevertheless, publications systematically describing the design considerations and methodology of a testbed are missing and real-time real-scenario performance evaluation of systems using testbeds have not been reported yet. At Lund University, the first real-time testbed, the testbed, showing successful transmission on the , was built. Ever since, many testbeds have been constructed based on identical utilizing the same generic design principle, the testbeds at the University of Bristol, Norwegian University of Science and Technology in Trondheim and University of Leuven in Belgium. The testbed provides a fully reconfigurable platform for testing under real-life conditions. To build a real-time testbed many challenges have to be coped with. For example, shuffling data from 100 or more antennas, processing large-scale matrices and synchronizing a huge number of physically separated devices. All this has to be managed while still ensuring an overall reconfigurability of the system allowing experimental hardware and software solutions to be tested rapidly.  This paper discusses how implementation challenges are addressed by first evaluating high-level and system requirements, and then setting up a generic framework to distribute the data shuffling and processing complexity in a system based on the given constraints for interconnection network and processing capabilities. Taking into account the framework and requirements, a suitable modular platform is selected and evaluated. Thereafter, a thorough description of the testbed is provided including system parameters, base-band processing features, synchronization scheme and other details. The testbed constitutes a flexible platform that supports prototyping of up to 100-antenna bandwidth , simultaneously serving 12 in real-time using modulation in transmission mode. and constellations for real-time and uncoded transmission in a static indoor and static outdoor scenario are presented. Our first real-life proof-of-concept measurement campaigns show, that is capable of serving up to 12 in the same time/frequency resource even for high user density per unit area. The gathered results suggest a significant increase in spectral efficiency compared to traditional point-to-point systems. By building the testbed we now have a tool which supports accelerated design of algorithms and their validation based on real measurement data, with the additional benefit of real-world verification of digital base-band solutions.  Our main contributions can be summarized as follows:  We provide overall and thorough analysis for systems, especially from a signal processing perspective, and identify design requirements as well as considerations on building up a testbed.  We propose signal processing breakdown and distribution strategy to master the tremendous computational complexity in a system and introduce general hardware architecture for a testbed.  We present the world’s first real-time 100-antenna testbed, built upon technology.  We validate the concept and its spatial multiplexing capability in real-life scenarios (both indoor and outdoor) with over-the-air transmission and real-time processing.">
</outline>
<outline text="Massive MIMO Basics" _note="In this section, the basic key detection and precoding algorithms utilized in are presented. Implementation specific details required to apply these algorithms, such as estimation, are discussed in Sec.  . A simplified model of a using antennas while simultaneously serving single antenna in operation in a propagation channel is shown in   . To simplify notation, this discussion assumes a base-band equivalent channel and expressions are given per subcarrier, with subcarrier indexing suppressed throughout.   ">
  <outline text="Up-link" _note="The power levels used by the during transmission build the diagonal matrix . By collecting the transmitted symbols in a vector , the received signals at the are described as where is the channel matrix[^1], an elementwise square-root, and is circularly-symmetric zero-mean complex Gaussian noise. The estimated user symbols from the are obtained by linear filtering of the received vector as where constructs an appropriate equalization matrix.  [^1]:  is the up-link radio channel capturing both, the propagation     channel and the up-link hardware transfer functions.">
  </outline>
  <outline text="Down-link" _note="On the , each receives its corresponding symbol which are collected in a vector , representing the symbols received by all . With this notation, the received signal becomes where the matrix is the radio channel[^1], is an circularly-symmetric zero-mean complex Gaussian receive noise vector with covariance matrix , and is the transmit vector.  As explicit channel estimation is very resource consuming, it is not considered practical in a setup. Taking into account that the propagation channel is generally agreed on to be reciprocal, the estimated channel matrix can be utilized to transmit on the . However, differences due to analog circuitry in the and channels, and , need to be compensated. Thus, a possible construction for is of the form where is a vector containing the symbols intended for the , is some precoding function, and is a reciprocity calibration function to be discussed next.  [^1]:  is the down-link radio channel capturing both, the propagation     channel and the down-link hardware transfer functions.">
  </outline>
  <outline text="Reciprocity Calibration" _note="In most practical systems, the and channels are not reciprocal, i.e. . This is easily seen by factorizing and as where the two and diagonal matrices and model the non-reciprocal hardware responses of and , respectively, and the two and diagonal matrices and similarly model hardware responses of their . Thus, in order to construct a precoder based on the channel estimates, the non-reciprocal components of the channel have to be calibrated. Previous calibration work showed that this is possible by using where is the, so-called, calibration matrix which can be estimated internally at the . Such calibration is sufficient to cancel inter-user interference stemming from non-reciprocity.">
  </outline>
  <outline text="Linear Detection &amp;amp; Precoding Schemes" _note="Table   shows a selection of weighting matrices used in linear precoding and detection schemes, with non-reciprocity compensation included in the form of the diagonal matrix as defined above. The precoder and the decoder maximize array gain without active suppression of interference among the . The precoder and combiner employ the pseudo-inverse, which provides inter-user interference suppression with the penalty of lowering the achievable array gain. A scheme that allows trade-off between array gain and interference suppression is the precoder and combiner. This is achieved by properly selecting the regularization constants and . If and are selected to minimize , where is a scaling constant, we obtain the precoder/detector .">
  </outline>
</outline>
<outline text="System Design Aspects" _note="Having discussed the basics, we move on to system design aspects. These include modulation scheme, frame structure and hardware requirements.">
  <outline text="Modulation Scheme" _note="While many different modulation schemes can be used with , this paper focuses on , employed in many modern wireless communication systems. Properly designed renders frequency-flat narrowband subcarriers, facilitating the single channel equalization strategy used here. For ease of comparison and simplicity, -like parameters, as shown in Table  , are used throughout this discussion. The more common parameters with , the easier it is to evaluate how as an add-on would influence current cellular systems.  [@\*[7]{}[l]{}@]{} **Parameter** &amp; **Variable** &amp; **Value**\ Bandwidth &amp; &amp; 20MHz\ Sampling Rate &amp; &amp; 30.72MS/s\ FFT Size &amp; &amp; 2048\ \# Used subcarriers &amp; &amp; 1200\ Cyclic prefix &amp; &amp; 144 samples\ OFDM symbol length &amp; &amp;\   ">
  </outline>
  <outline text="TDD versus FDD" _note="Current cellular systems either operate in or mode. is, however, considered impractical for due to excessive resources needed for pilots and feedback. operation relying on reciprocity only requires orthogonal pilots in the from the , making it the feasible choice . For this reason, we focus entirely on below.">
  </outline>
  <outline text="Reciprocity" _note="To allow operation in mode, differences in the and transfer functions on both, the and have to be calibrated as discussed in Sec.  . Drifts over time are mainly caused by temperature and voltage changes, and thus, the calibration interval depends on the operating environment of the .">
  </outline>
  <outline text="Frame Structure" _note="The frame structure defines among other things, the pilot rate which determines how well channel variations can be tracked and, indirectly, the largest supported UE speed.">
    <outline text="Mobility" _note="The maximum supportable mobility, the maximum speed of the is defined by the pilot transmission interval. In order to determine this constraint, a 2D wide-sense stationary channel with uncorrelated isotropic scattering is assumed. For the contributions from the different antennas to add up coherently high channel correlation is required and, as an approximation to formulate the final requirement, a correlation of was used to ensure sufficient channel coherency. Further discussions on such modeling assumption are found in. Although these assumptions may not be completely valid for channels, they allow an initial evaluation based on a maximum supported Doppler frequency, , by solving for , where is the zeroth-order Bessel function of the first kind, stemming from a standard Jakes’ fading assumption, and the distance between pilots in time. Hence, the maximum supportable speed of any may be evaluated using once a specific frame structure is provided. In ( ) is the maximum supported speed of a , the speed of light and the chosen carrier frequency.">
    </outline>
    <outline text="Processing latency" _note="The frame structure has to be designed for the highest speed of to be supported which requires a high pilot rate for high mobility scenarios. Within two consecutive pilot symbols, all data, data and guard symbols have to be accommodated which in turn decreases the available time between UL pilot reception and DL transmission. In a high mobility scenario this poses tight latency requirements for transmission as has to be estimated in order to produce the precoding matrix to beamform the data. To formulate the precoder turnaround time, , all units introducing a delay must be taken into account. This includes the analog front-end delays for the and , the processing latency for modulation/demodulation (including and guard band operation) , the time for processing pilots to estimate , and the processing latency for precoding including reciprocity compensation. Additional sources of latency include overhead in data routing, packing, and unpacking, such that the overall precoder turnaround time may be formulated as Depending on the specific arrangement of the symbols and the pilot repetition pattern in the frame structure, base-band processing solutions, especially and , have to be optimized to not violate the given constraint, .">
    </outline>
    <outline text="Pilot pattern" _note="In general, to acquire at the , the transmit orthogonal pilots on the . Different approaches are, distributed pilots over orthogonal subcarriers or sending orthogonal pilot sequences over multiple subcarriers but also semi-blind and blind techniques have been proposed.     shows a generic frame structure capturing the aforementioned aspects in a hierarchical manner assuming all transmit their pilots within one dedicated pilot symbol.  At the beginning of each reciprocity cycle, reciprocity calibration at the is performed and within these a certain number of pilot cycles are encapsulated where precoded pilot symbols are transmitted. The length of the BS reciprocity cycle is determined by the stability of the transceiver chains in the . As the reciprocity calibration at the side only compensates for transceivers, pilots are necessary to compensate for transceiver differences at the side. Their frequency depends on the stability at the side and can be considered significantly smaller than for the as are subject to faster changes in their operational environment, thermal differences when having the in a pocket or using it indoors or outdoors. To be able to send precoded pilots on the , transmission of pilots is required beforehand. Several control cycles are embedded inside each pilot cycle carrying a certain number of data time slots. Time slots contain five different symbol types for physical layer implementation. These are (I) UL Pilot where the transmit orthogonal pilots to the , (II) UL Data where all simultaneously send data to the , (III) DL Pilot where the sends precoded pilots to all , (IV) DL Data where the transmits data to all and (V) Switch Guard, which idles the RF chains to allow switching from RX to TX or vice versa.">
    </outline>
  </outline>
  <outline text="Hardware Requirements" _note="To illustrate the required capabilities for the testbed, the values from Table   are used to estimate the [^1] and the data shuffling on a per symbol basis for the general case and a specific case assuming and .  [^1]: is used here, but these can be seen as , the number of     multiply-accumulate operations, as almost all operations involve     matrix-matrix and matrix-vector calculations.">
    <outline text="Processing Capabilites" _note="Table   summarizes the overall number of real-valued arithmetic operations. For the processing estimates, it is assumed that each complex multiplication requires four real multiplications. Close to the antennas, or are needed equating to . Data precoding and detection as well as reciprocity compensation require large matrix and vector multiplications, for instance, an matrix with a vector leading to up to .  Finally, when using ZF, the pseudo-inverse matrix is required which includes the calculation of the Gram matrix requiring multiplications with the matrix inversion adding another in complexity assuming a Neumann-Series approximation or a QR decomposition. The last multiplication of the inverse with the Hermitian of the channel matrix needs another multiplications which combined with a requirement of finishing within two symbols leads to approximately for the overall pseudo-inverse calculation.   ">
    </outline>
    <outline text="Data Shuffling Capabilities" _note="Table   summarizes required interconnect bandwidth and number of links. Communication paths to each antenna transfer at the sampling rate of which is decreased to the subcarrier rate by performing processing . Considering antennas, the overall subcarrier data rate is , with being the combined wordlength for the in-phase and quadrature components in bytes. The information rate in an symbol carrying data is assuming bit per sample, QAM as highest modulation. Assuming separate links between centralized processing and the antenna units on and , links[^1] are needed between the antennas and the centralized processing.     [^1]: In this discussion, each interconnection transferring data between     physically separated devices is denoted a link.">
    </outline>
    <outline text="Reconfigurability" _note="The testbed has to be reconfigurable and scalable, to support different system parameters, different processing algorithms and adaptive processing. It is also crucial to have the possibility to integrate in-house developed designs for validation and performance comparison of algorithms. Variable center frequencies, run-time adjustable and gains as well as configurable sampling rates are highly desirable to be able to adapt to other parameters than the ones presented in Table  .">
    </outline>
  </outline>
</outline>
<outline text="Generic Hardware and Processing Partitioning" _note="In this section a generic and processing partitioning is presented to explore the parallelism in , which needs consideration of processing together with data transfer requirements (throughput, latency, \# of links), and at the same time provides scalability.">
  <outline text="Hierarchical Overview" _note="To be able to build a testbed with modular components, a hierarchical distribution as shown in    is proposed. The main blocks are detailed as follows:  ">
    <outline text="SDR" _note="provide the interface between the digital and domain as well as local processing capabilities.">
    </outline>
    <outline text="Switches" _note="Switches aggregate/disaggregate data between different parts of the system, between and the co-processors.">
    </outline>
    <outline text="Co-processing modules" _note="Co-processing modules provide a centralized node to perform processing.">
    </outline>
    <outline text="Higher Layer Processing" _note="Higher layer processing controls the system, configures the radios, and provides run-time status metrics of the system.">
    </outline>
  </outline>
  <outline text="Processing and Data Distribution" _note="For proper base-band processing partitioning, throughput constraints of components have to be taken into account. Assuming each supports antennas, the required number of becomes for an -antenna system.">
    <outline text="Subsystems" _note="As shown in   , RF-Front End, processing and reciprocity compensation are performed on a per-antenna basis using the . This distributes a large fraction of the overall processing and reduces the data rate before transferring the acquired samples over the bus. Still, the number of direct devices on a bus is limited, and thus, setting up links directly to the co-processors would most likely exceed the number of maximum links for any reasonable number of antennas. To reduce this number, data can be aggregated using the concept of grouping. The different data streams from several are interleaved on one common and then sent via one link. Therefore, subsystems are defined, each containing . Data from all antennas within a subsystem is aggregated/disaggregated on the outer two and distributed to the co-processors using high-speed routers.  At closer look,    reveals that the on the outer edges which realize the and router functionalities, require the highest number of links, and thus have to deliver the highest throughput. Hence, the following inequalities have to be fulfilled for the subsystems not to exceed the constraints for maximum number of links () and maximum bidirectional throughput (): where it is assumed that if an employs more than one antenna, the data is interleaved before it is sent to the router on the outer . The constraints given in equation ( )-( ) can be used to determine the maximum number of per subsystem () such that hardware constraints are not exceeded.">
    </outline>
    <outline text="Co-processors" _note="As shown in   , detection, precoding, acquisition, symbol mapping and symbol demapping are integrated in the centrally localized co-processor modules which collect data from all . Using estimated from pilots, processing as discussed in Sec.   and symbol mapping/de-mapping is performed. Based on the selected modulation scheme the subcarrier independence can be exploited allowing each of the co-processors to work on a sub-band of the overall bandwidth. This efficiently circumvents issues with throughput and latency constraints in the signal processing chain. The co-processors aggregate/disaggregate data from all the antennas in the system using reconfigurable high-speed routers, as shown in    for a system having subsystems and co-processors.  Similarly to the , the two main constraints for the co-processors are the maximum number of links denoted and the maximum throughput denoted .  The following inequalities have to hold for the co-processor not to exceed these constraints:  Using this modular and generic system partitioning, platforms built using modular components can be evaluated. Note, that expressions ( ) - ( ) may also be used with other system parameters, by redefining and .   ">
    </outline>
  </outline>
</outline>
<outline text="Testbed Implementation" _note="In this section the specific implementation details are discussed based on the aforementioned general architecture. The system was designed with antennas and can serve up to simultaneously. Based on these parameters, the selected modular platform is presented and given constraints are evaluated. Consequently, the specific frame structure and other features of the system including base-band processing, antenna array, mechanical structure and synchronization are briefly described. Before providing details, the authors would like to emphasize, that this is the initial version of the testbed and that add-ons and further improvements are planned for the future.">
  <outline text="Selected Hardware Platform" _note="The hardware platform was selected based on requirements discussed in Sec.  . Table   shows the selected off-the-shelf modular hardware from National Instruments used to implement the testbed. The allow up to 15 links () with a bidirectional throughput of , support a variable center frequency from to and have a power of . Each contains two chains, , and a Kintex-7 . Selected co-processors allow a bidirectional rate of with up to links and employ a powerful Kintex-7 with a reported performance of up to . This is sufficient for a 100 antenna testbed due to the fact that co-processors can be utilized in parallel. Interconnection among devices is achieved using 18-slot chassis combined with per-slot expansion modules . Each chassis integrates two switches based on using channels which allow inter-chassis traffic up to and intra-chassis traffic up to .  The host is an integrated controller, running LabVIEW on a standard Windows operating system and is used to configure and control the system. The integrated hardware/software stack provided by LabVIEW provides the needed reconfigurability as it abstracts the link setup, communication among all devices and allows programming as well as host processing using a single programming language. An additional feature of LabVIEW is the possibility to seamlessly integrate blocks generated via Xilinx Vivado platform paving a way to test in-house developed .  To be able to synchronize the full , a Reference Clock Source and Reference clock distribution network are required. Their functionalities will be later discussed when presenting the overall synchronization method.">
  </outline>
  <outline text="Subsystems and Number of Co-processors" _note="To build the testbed with antennas, are necessary. The maximum possible subsystem size is chosen to minimize the utilization of available links at the co-processors. By using ( ) and an internal fixed-point wordlength of corresponding to a 12-bit resolution on the I- and Q-components, is found to be . As this is not an integer divider of , the last subsystem only contains two .  Based on Table  , the combined subcarrier rate for all antennas is and another are needed for information symbols. To not exceed at least three co-processors must be utilized. To further lower the burden on the design of the low-latency signal processing chain, is chosen such that each co-processor processes of the overall 1200 subcarriers.  Table   summarizes the testbed parameters and shows that constraints are met according to ( )-( ). It can also be seen that the design is still within the constraints if scaling up the number of antennas to , which has been done in subsequent designs based on the same hardware, .   Note, that the last subsystem only consists of two SDRs.     ">
  </outline>
  <outline text="Frame Structure" _note="The default frame structure for the testbed is shown in   . One frame is and is divided in ten subframes of length . Each subframe consists of two slots having length , where the first subframe is used for control signals, to implement over-the-air synchronization, power control and other control signaling. The 18 slots in the other nine subframes encapsulate seven symbols each. Comparing to   , a reciprocity calibration cycle is defined over the whole run-time of the for simplicity and due to the fact that there is no large drift after warming up the system in a controlled environment. The pilot cycles and control cycles are both set to be the length of one frame. Each frame starts with one control subframe followed by one subframe with one pilot and one data symbol whereas all others use two DL data symbols.">
  </outline>
  <outline text="Mobility" _note="The pilot distance in time in the default frame structure given in    is or six symbols. Thus, for a correlation of 0.9. Due to availability from a network operator, a carrier frequency of is selected. Using ( ), is found as maximum supported speed.">
  </outline>
  <outline text="Turnaround Time" _note="The pre-coding turnaround time requirement for the implementation can be analyzed based on ( ). The analog front-end delay of the was measured to be about . Taking the frame structure in    (assuming which is not necessarily true), the latency budget for base-band processing is as follows: Overall time for pre-coding after receiving the UL pilots is ( symbols). The 2048 point / (assuming a clock frequency of ) requires around in total for TX and RX (including sample reordering). As a result, the remaining time for channel estimation, processing, and data routing is around , which is the design constraint for this specific frame structure. An analysis of the implemented design showed that the latency is far below the requirement for the default frame structure which makes it possible to use the testbed for higher mobility scenarios from this point of view.">
  </outline>
  <outline text="Implementation Features">
    <outline text="Base-band Processing" _note="On the testbed, each sends pilots on orthogonal subcarriers, each uses every -th subcarrier with the first starting at subcarrier 0, the second at subcarrier 1 etc., overall utilizing a full symbol. It was shown that performance does not suffer significantly compared to a full detector calculated for each subcarrier using this method. Moreover, it efficiently remedies processing requirements and reduces the required memory for storing estimated matrices by a factor of . A least-square estimation algorithm with zeroth-order hold over subcarriers was implemented, however, better estimates could be obtained by on-the-fly interpolation between the estimated subcarriers. Overall, utilizing this approach reduces the required detection matrix throughput to one matrix every 12 subcarriers, = .  Two versions for detection were implemented. The first one based on a QR decomposition of the channel matrix augmented with the regularizations factors to a matrix of size . This is then formulated into a partial parallel implementation employing a systolic array. The latter one based on a Neumann-series. In the QR decomposition, each column is processed using the discrete steps of the modified Gram-Schmidt algorithm. The logic on the co-processors can be reconfigured so that the same hardware resources that provide the decoder can also provide the and decoders, the detection / precoding schemes discussed in Sec.   are supported with run-time switching. The Neumann-series based detector utilizes the unique property that in , the Gramian matrix shows dominant diagonal elements if use power control, or if scheduling is performed to serve with similar power levels in the same time/frequency block to mitigate the influence of path loss differences. This, allows the matrix inversion to be approximated with low overall error . The utilizations for the two designs are shown in Table  .     Clearly, overall processing complexity and resource utilization can be significantly reduced by exploiting the special properties of . At this point, the regularizations factors and are not run-time optimized but set manually, however, implementation of this feature is planned in future. For a more detailed discussion of the low-latency signal processing implementation on the testbed we refer to.">
    </outline>
    <outline text="Host-based visualization and data capturing" _note="The available margin of and 14 links to the corresponding maximum values on the co-processors are used for visualization and system performance metrics. The host receives decimated equalized constellations and raw subcarriers for one pilot and one data symbol per frame. These features add another of data flowing in and out of the co-processor. The raw subcarriers are used to perform channel estimation and data detection on the host computer with floating point precision and allow fast implementation of different metrics, like constellation, channel impulse response, power level per antenna and user. Another 12 links available are utilized to transmit and store real-time for all 12 .  Moreover, to be able to capture dynamics in the channel for mobile , can be stored on a basis. An integrated buffer on each of the co-processors was utilized for this since direct streaming to disk would exceed the bandwidth limits. Snapshots can either be taken for in a interval or over in a interval, both corresponding to of data for subcarriers per co-processor.">
    </outline>
    <outline text="Scalability/Reconfigurability" _note="Before startup, the number of deployed antennas can be arbitrarily set between and . This is achieved by introducing zeros for non-existing antennas within the -based reconfigurable high-speed routers on the co-processors, thereby allowing to evaluate effects of scaling the antennas in real environments. Additionally, all symbols in a frame can be rearranged arbitrarily before start-up while each frame always repeats itself. For instance, we can choose to set the first symbol as UL pilots and all others as UL data in a static UL only scenario.">
    </outline>
    <outline text="Reciprocity Calibration" _note="Estimation of the reciprocity calibration coefficients was implemented on the host, mainly for two reasons: (I) the host can perform all operations in floating-point which increases precision and (II) the drift of the hardware is not significant once the system reached operating temperature . Estimated reciprocity coefficients are applied in a distributed manner on the .">
    </outline>
  </outline>
  <outline text="Mechanical structure and electrical characteristics" _note="Two computer racks containing all components measuring m were used, as shown   . An essential requirement for the testbed is to allow tests in different scenarios, indoor and outdoor. Therefore, the rack mount is attached on top of a 4-wheel trolley.">
  </outline>
  <outline text="Antenna Array" _note="The planar T-shaped antenna array with 160 dual polarized /2 patch elements was developed in-house. A 3.2mm Diclad 880 was chosen for the printed circuit board substrate. The T upper horizontal rectangle has elements and the central square has elements (see    right). This yields 320 possible antenna ports that can be used to explore different antenna array arrangements, for example or with the latter one being the default configuration. All antenna elements are center shorted, which improves isolation and bandwidth. The manufactured array yielded an average -bandwidth of centered at with isolation between antenna ports varying between and depending on location in the array.">
  </outline>
  <outline text="User Equipment" _note="Each represents a phone or other wireless device with single antenna capabilities. One serves as two independent such that overall six are required for the 12 . The base-band processing, modulation/demodulation and symbol mapping/demapping are essentially identical to the implementation. A least-square acquisition is performed on precoded DL pilot followed by a -equalizer. The pilots occupy a full symbol. The may be equipped with any type of antenna using SMA connectors.">
  </outline>
  <outline text="Synchronization" _note="A requires time synchronization and phase coherence between each RF chain. This is achieved using the reference clock source and the reference clock and trigger distribution network (see Table  ). The reference clock is used as the source of each radio local oscillator, providing phase coherence among devices. The trigger signal is used to provide a time reference to all the radios in the system. A master provides an output digital trigger that is amplified and divided among all the radios. Upon receipt of the rising edge of the event trigger, all are started. The basic structure can be identified in    on the left.  To synchronize the with the , the Zadoff-Chu is used, which occupies the center of the overall bandwidth. synchronization and frequency offset compensation are achieved by employing a frequency-shifted bank of replica filters. The process follows a two step procedure: finding a coarse candidate position by scanning over the whole radio frame followed by tracking the in a narrowed window located around the coarse candidate position. Additionally, by disciplining the with , frequency offset compensation may be avoided by lowering the frequency offset to .  ">
  </outline>
</outline>
<outline text="Proof-of-concept Results" _note="This section describes two experiments performed to validate our testbed design, the concept and its performance. The first test is performed indoors with high density of users per area unit to stress the spatial multiplexing capabilities of the system. The second test is conducted outdoors with less dense deployment of and is primarily designed to test the range and multiplexing capabilities outdoors. For all tests, the default antenna configuration, was used on the side whereas the were equipped with linear polarized ultra-wideband antennas. It has to be noted that all results shown in this section are obtained from real-time operation without power control.">
  <outline text="Indoor Test" _note="In this test real-time uncoded BER curves are measured, employing / and as decoders/precoders. The curves are obtained by sweeping all gains synchronously, and for the curves the gains of the chains while keeping other system parameters constant. Note that the initial parameterization of the system is chosen empirically, so it allows smooth curves starting at about . Each gain step is held constant for about corresponding to about and transmitted bits per step for QPSK and 64-QAM modulation, respectively.">
    <outline text="Scenario" _note="Twelve are set up in a lecture hall at Lund University with the at the front as shown in    including the respective placements. All are packed in groups of four resulting in a high density of per area unit. One of these groups can be seen in   .">
    </outline>
    <outline text="UL" _note="  , (a) and (b), show the for all 12 using detector for QPSK and 64-QAM modulation, respectively. For both constellation sizes, the furthest away, 0 to 3 show highest . 0 and 1 even show a sudden increase for the to 0.5 which was diagnosed to be due to saturation of their respective . Moreover, their performance shows severe limitation compared to the other , giving a clear indication that their performance is interference rather than power limited. The group closest to the , 9-12, shows best performance although the variation within the group is still quite significant. Overall, the expected trend, increasing performance with increased transmit gain is clearly noticeable with the curve shapes resembling those of channels. Comparing the amplifier gain settings for QPSK and 64-QAM to achieve the same the differences are found to be in the range of to whereas a difference of is expected for . Overall, it can be seen that all except 0 and 1 achieve below at an amplifier gain of for QPSK and for 64-QAM, respectively.">
    </outline>
    <outline text="DL" _note="  , (c) and (d), show the DL using precoder for QPSK- and 64-QAM modulation, respectively. Using QPSK modulation, the group closest to the , 9-12, achieves a considerably better performance than the other two groups. Using 64-QAM, all show an error-floor towards higher gain values which is likely a result of imperfect reciprocity calibration combined with leakage among due to non-perfect channel knowledge resulting in interference among . However, for the QPSK modulation case all experience better rates which can be explained by the significantly higher available transmit power on the side, utilizing 100 active -chains. Comparing again the difference in amplifier gain setting for QPSK and 64-QAM, their differences are about to . The tests performed were mainly to prove functionality, and thus, no special care was taken to achieve best possible accuracy for the reciprocity calibration. However, individual parts are continuously tested to be improved.">
    </outline>
    <outline text="Performance Evaluation" _note="While the plots in Fig.   nicely show the trend with increasing transmit power, they do not provide a real performance indication against . The current implementation of the testbed does not provide estimates in real-time such that the data presented in Fig.   can be seen as the raw data provided during measurements. To provide an indication of the system performance the of 4 was estimated based on the received channel estimates. Estimated subcarriers at different time instances (about apart) were subtracted / added to extract the noise / signal plus noise level which was then used to calculate the value. However, this practice has limits as for close users interference may be stronger than the noise whereas for far away users the signal level may be too low. Therefore, 4 was chosen which due to its placement during the measurement allowed a relatively good estimation. Fig.   shows the of 4 in comparison with the theoretical performance in and Rayleigh fading channels. It is visible that due to the excess amount of antennas the performance is close to the channel. To be more specific, due to the channel hardening the performance is only about worse than for a channel which would be achieved for perfect channel hardening. On the the are affected by several factors including the higher overall transmit power from the 100 active -chains and possible inaccuracies in the reciprocity calibration coefficients. As precoding is performed based on channel estimates, estimation is practically not feasible.  As all shown curves closely resemble the shape of an channel it can be claimed that the concept works and is capable of serving 12 on the same time/frequency resource even with a high density which in turn significantly improves the spectral efficiency compared to current cellular standards.">
    </outline>
    <outline text="MRC/MRT versus ZF" _note="\  To compare the performance of / and it is beneficial to isolate the analysis to one .   a and   b show the for 7 for QPSK, 16-QAM and 64-QAM modulations while the employs either / or on the and , respectively.  Overall, shows an superior performance trend with increasing gains, while the performance of appears to level off[^1]. Looking in more detail, is capable of achieving more than an order of magnitude lower , compared to . Using higher constellation sizes, 16-QAM or 64-QAM, the results for show an even more significant deterioration. On the , also outperforms by far, the latter shows a significant error floor towards higher gains as in the case.  Unfortunately, direct comparison between and results shown here is not easy to perform. This is due to the fact that on the , the performance is isolated to the transmit power only whereas on the a combination of channel estimate quality, transmit power and reciprocity accuracy determines overall performance.  [^1]: This is expected from theory, as inter-user interference is the     main source of error during data detection. The high density users     setup adopted in this experiment highly contributes to this     phenomena.">
    </outline>
  </outline>
  <outline text="Outdoor Test" _note="For the outdoor test, the testbed was placed on the rooftop of one of the wings of the department building while the where placed on the opposite wing utilizing scaffolding mounted to the building. Up to eight were served simultaneously in a distance of about 18 to 22 meters, six on the second floor and two on the first floor while the testbed was situated on the third floor (rooftop). The scenario is shown in   .     shows the placed on the rooftop of the department building facing towards the opposite wing. The placement for 0 and 1 is also marked.     shows a screenshot of the received QPSK constellations for this test setup when using and , respectively. Using without for this test, the six show significant interference. Therefore, focus is put on the results obtained with which is capable of separating up to eight and shows very clear constellations, due to the interference suppression.  \  Considering on the , the constellations for all 8 can be seen in   .  \  Although in-detail analysis is not provided for this test, it is clearly visible that outperforms which is often claimed to be sufficient in literature when analyzing performance based on channel models. The results observed in this experiment are representative for most tests performed so far, always showed to be the more challenging duplex case.  The testbed was also utilized to perform the first outdoor mobility measurements involving moving pedestrians and cars as , however, a discussion of this is out of scope of this paper. Results and analysis from the mobility tests can be found in.">
  </outline>
</outline>
<outline text="Conclusion" _note="This paper presented the testbed, which is the first fully operational real-time testbed for prototyping massive MIMO. Based on massive MIMO system requirements, system parameters were discussed and defined. Further, a detailed generic hardware partitioning to overcome challenges for data shuffling and link limitations while still allowing scalability, was proposed. By grouping and splitting overall bandwidth, implementation of massive MIMO signal processing was simplified to cope with challenges like precoding turnaround time and limited bandwidth enforcing strict design requirements when scaling the number of antennas up to 100 or higher. Based on the generic system partitioning and system requirements, a hardware platform was selected and evaluated. It was shown that internal system configuration is within throughput and processing capabilities before the complete testbed parameters were described. Finally, field trial results including performance measurements and constellations were presented from both indoor and outdoor measurement campaigns. The results showed that it is possible to separate up to 12 on the same time/frequency resource when using massive MIMO. Having established a flexible platform for testing new algorithms and digital base-band solutions we are able to take from theory to real-world tests and standardization for next generation wireless systems.">
</outline>
<outline text="Acknowledgment" _note="This work was funded by the Swedish foundation for strategic research SSF, VR, the strategic research area ELLIIT, and the EU Seventh Framework Programme (FP7/2007-2013) under grant agreement n 619086 (MAMMOET).  [Steffen Malkowsky]{} received the B.Eng. degree in Electrical Engineering and Information Technology from Pforzheim University, Germany in 2011 and the M.Sc. degree in Electronic Design from Lund University in 2013. He is currently a PhD student in the Digital ASIC group at the department of Electrical and Information Technology, Lund University. His research interests include development of reconfigurable hardware and implementation of algorithms for wireless communication with emphasis on massive MIMO. For the development of a massive MIMO testbed in collaboration with University of Bristol and National Instruments and a set spectral efficiency world record, he received 5 international awards from National Instruments, Xilinx and Hewlett Packard Enterprise.  [João Vieira]{} received the B.Sc. degree in Electronics and Telecommunications Engineering from University of Madeira in 2011, and the M.Sc. degree in Wireless Communications from Lund University, Sweden in 2013. He is currently working towards a Ph.D. degree at the department of Electrical and Information Technology in Lund University. His main research interests regard parameter estimation and implementation issues in massive MIMO systems.  [Liang Liu]{} received his B.S. and Ph.D. degree in the Department of Electronics Engineering (2005) and Micro-electronics (2010) from Fudan University, China. In 2010, he was with Rensselaer Polytechnic Institute (RPI), USA as a visiting researcher. He joined Lund University as a Post-doc in 2010. Since 2016, he is Associate Professor at Lund University. His research interest includes wireless communication system and digital integrated circuits design. He is a board member of the IEEE Swedish SSC/CAS chapter. He is also a member of the technical committees of VLSI systems and applications and CAS for communications of the IEEE circuit and systems society.  [Paul Harris]{} graduated from the University of Portsmouth with a 1st Class Honours degree in Electronic Engineering in 2013 and joined the Communication Systems &amp; Networks Group at the University of Bristol in the same year to commence a PhD. His research interests include massive MIMO system design, performance evaluation in real-world scenarios, and the optimisation of techniques such as user grouping or power control using empirical data. Working in collaboration with Lund University and National Instruments, he implemented a 128-antenna massive MIMO test system and led two research teams to set spectral efficiency world records in 2016. For this achievement, he received 5 international awards from National Instruments, Xilinx and Hewlett Packard Enterprise, and an honorary mention in the 2016 IEEE ComSoc Student Competition for “Communications Technology Changing the World”.  [Dr. Karl Nieman]{} is a Senior Wireless Platform Architect in the Advanced Wireless Research team at National Instruments. His interests are with research and standardization of 5G technology, particularly Massive MIMO architectures and signal processing. He has designed and implemented several FPGA-based real-time wireless communication systems, has made multiple contributions to 3GPP RAN1, and holds multiple issued and pending patents on 5G technologies. He earned his Ph.D. and M.S. in Electrical Engineering from University of Texas at Austin in 2014 and 2011, respectively, and his B.S. in Electrical Engineering from New Mexico Institute of Mining and Technology in 2009.  [Nikhil Kundargi]{} is a Senior Wireless Platform Architect in the Advanced Wireless Research Team at National Instruments since 2012. He leads the Massive MIMO research initiative at NI. He is the 3GPP RAN1 Delegate for NI and participates in LTE-Advanced and 5G cellular standardization. His research interests include Massive MIMO, Full Dimension MIMO, 5G New Radio, mmWave, PHY/MAC layer design and prototyping, Dense LTE networks, Real-time DSP, Software Defined Radio Architectures, Cognitive Radio Networks, Spectrum Sensing, Dynamic Spectrum Access, Anomaly Detection and Statistical Signal Processing. He received his Ph.D in Electrical Engineering from the University of Texas at Austin in 2012. He was a member of WNCG (Wireless Networking and Communications Group at UT Austin and formerly a Graduate School Fellow at the University of Minnesota from 2006-10. He is also an active member of IEEE Austin ComSoc Chapter and served as the Vice-Chair for the Industry Forum at IEEE Globecom 2015.  [Dr. Ian C. Wong]{} is Senior Manager of the Advanced Wireless Research group at National Instruments where he leads the company’s 3GPP and 802.11 wireless standards strategy and platforms for wireless system design, simulation, prototyping, and implementation. From 2007-2009, he was a systems research and standards engineer with Freescale Semiconductor where he represented Freescale in the 3GPP LTE standardization efforts. He was the Industry Program Chair for IEEE Globecom 2015 in Austin, the Director for Industry Communities for IEEE Communications Society 2016-2017, and a senior member of the IEEE. His current research interests include 5G wireless systems design and prototyping, and design automation tools for rapid algorithm development. Dr. Wong is the co-author of the Springer book “Resource Allocation for Multiuser Multicarrier Wireless Systems,” has over 10 patents, over 25 peer-reviewed journal and conference papers, and over 40 standards contributions. He was awarded the Texas Telecommunications Engineering Consortium Fellowship in 2003-2004, and the Wireless Networking and Communications Group student leadership award in 2007. He received the MS and PhD degrees in electrical engineering from the University of Texas at Austin in 2004 and 2007, respectively, and a BS degree in electronics and communications engineering (magna cum laude) from the University of the Philippines in 2000.  [Fredrik Tufvesson]{} received his Ph.D. in 2000 from Lund University in Sweden. After two years at a startup company, he joined the department of Electrical and Information Technology at Lund University, where he is now professor of radio systems. His main research interests are channel modelling, measurements and characterization for wireless communication, with applications in various areas such as massive MIMO, UWB, mm wave communication, distributed antenna systems, radio based positioning and vehicular communication. Fredrik has authored around 60 journal papers and 120 conference papers, recently he got the Neal Shepherd Memorial Award for the best propagation paper in IEEE Transactions on Vehicular Technology.  [Viktor Öwall]{} received the M.Sc. and Ph.D. degrees in electrical engineering from Lund University, Lund, Sweden, in 1988 and 1994, respectively. During 1995 to 1996, he joined the Electrical Engineering Department, the University of California at Los Angeles as a Postdoc where he mainly worked in the field of multimedia simulations. Since 1996, he has been with the Department of Electrical and Information Technology, Lund University, Lund, Sweden. He is currently full Professor and since 2015 the Dean of the Faculty of Engineering. He was the founder and the Director of the VINNOVA Industrial Excellence Center in System Design on Silicon (SoS) which he headed until 2014. His main research interest is in the field of digital hardware implementation, especially algorithms and architectures for wireless communication and biomedical applications. He was co-founder of the start-up company Phase Holographic Imaging who develops microscopes utilizing digital holography.  [Ove Edfors]{} is Professor of Radio Systems at the Department of Electrical and Information Technology, Lund University, Sweden. His research interests include statistical signal processing and low-complexity algorithms with applications in wireless communications. In the context of Massive MIMO, his main research focus is on how realistic propagation characteristics influence system performance and base-band processing complexity.">
</outline>
  </body>
</opml>