<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>Enforcing conservation laws in nonequilibrium cluster perturbation
theory</title>
    <abstract>Using the recently introduced time-local formulation of the
nonequilibrium cluster perturbation theory (CPT), we construct a
generalization of the approach such that macroscopic conservation laws
are respected. This is achieved by exploiting the freedom for the choice
of the starting point of the all-order perturbation theory in the
inter-cluster hopping. The proposed conserving CPT is a self-consistent
propagation scheme which respects the conservation of energy, particle
number and spin, which treats short-range correlations exactly up to the
linear scale of the cluster, and which represents a mean-field-like
approach on length scales beyond the cluster size. Using Green’s
functions, conservation laws are formulated as local constraints on the
local spin-dependent particle and the doublon density. We consider them
as conditional equations to self-consistently fix the time-dependent
intra-cluster one-particle parameters. Thanks to the intrinsic causality
of the CPT, this can be set up as a step-by-step time propagation scheme
with a computational effort scaling linearly with the maximum
propagation time and exponentially in the cluster size. As a proof of
concept, we consider the dynamics of the two-dimensional,
particle-hole-symmetric Hubbard model following a weak interaction
quench by simply employing two-site clusters only. Conservation laws are
satisfied by construction. We demonstrate that enforcing them has strong
impact on the dynamics. While the doublon density is strongly
oscillating within plain CPT, a monotonic relaxation is observed within
the conserving CPT. </abstract>
  </head>
  <body>
<outline text="Introduction" _note="A major challenge of the theory of strongly correlated lattice-fermion models is to predict the real-time dynamics of local observables on a long time scale. Using exact-diagonalization techniques, i.e., full diagonalization or Krylov-space methods, only lattices with a small number of sites can be addressed such that artificial boundary effects start to dominate the dynamics after a few elementary hopping processes. Much larger systems are in principle accessible by means of quantum Monte-Carlo methods, at least in thermal equilibrium. As concerns real-time dynamics, however, the sign (or complex phase) problem still prevents a computationally efficient simulation, even for impurity-type models which are typically sign-problem-free at thermal equilibrium, and despite substantial progress in the recent past. For impurity and for one-dimensional systems, recent extensions of the numerical renormalization group and of the density-matrix renormalization group to the time domain have been shown to be highly efficient and accurate.  For lattice models in two or higher dimensions, on the other hand, one has to resort to approximations, e.g., to the time-dependent variational principle evaluated with Gutzwiller or with Jastrow-like variational wave functions. Using a Green’s-function-based approach, on the other hand, one may also treat the problem within weak-coupling perturbation theory. Naive perturbative techniques, however, usually violate the macroscopic conservation laws that result from the continuous symmetries of the lattice-fermion model. As has been shown by Baym and Kadanoff, “conserving approximations” can be constructed diagrammatically by deriving the self-energy from a (truncated) Luttinger-Ward functional involving, e.g., certain infinite re-summations of diagram classes, and by calculating the single-particle Green’s function self-consistently. Due to the necessary approximation of the functional, however, certain low-order diagrams are neglected which implies that, strictly speaking, such conserving approximations are usually restricted to the weak-coupling limit.  Nonperturbative conserving approximations can either be constructed with the help of the many-body wave function, or, using Green’s functions, within the framework of the nonequilibrium generalization of self-energy-functional theory (SFT). Here, the Green’s function is self-consistently obtained from an optimal self-energy which makes the grand potential of the initial thermal state, expressed as a functional of the nonequilibrium self-energy, stationary. The equilibrium SFT comprises different approximations, such as the variational cluster approximation and the dynamical impurity approximation. These techniques have been extended to real-time dynamics and have been applied recently to study the dynamical Mott transition in the Hubbard model and a variant of the periodic Anderson model.  Another nonperturbative conserving approach, which can be derived within the SFT framework but has actually been proposed much earlier, is the (nonequilibrium) dynamical mean-field theory. Being the exact theory in the limit of infinite spatial dimensions, conservation laws are in principle naturally satisfied in this case. In practice, however, this requires the exact solution of a highly nontrivial quantum-impurity model out of equilibrium. First cluster extensions of the DMFT have been reported as well. Those combine the mean-field concept with an improved description of spatial correlations.  The nonequilibrium extension of cluster-perturbation theory (CPT) is a strongly simplified variant of a cluster-embedding approach. Still, the numerical solution of the basic CPT equation is complicated by the presence of memory effects which are encoded in real-time Green’s functions within the Keldysh formalism. This is very similar to the nonequilibrium Dyson or Kadanoff-Baym equations in other diagrammatic approaches. As has been shown recently, however, the problem can be mapped exactly onto a noninteracting problem with additional auxiliary degrees of freedom. Adopting this idea, we could demonstrate that the CPT real-time dynamics can be understood as a simple Markovian dynamics of a system of noninteracting fermions but in a much larger time-dependent bath of virtual degrees of freedom. Using this reformulation of the CPT, it has been possible to formally study the real-time dynamics of an inhomogeneous setup in the two-dimensional Hubbard model consisting of sites up to times of the order of where the inverse nearest-neighbor hopping serves as the time unit.  Those plain CPT calculations, however, suffer from a couple of conceptual problems. The drawback of [ANY]{} mean-field theory is the missing feedback of certain correlations on the dynamics of the observables of interest, such as, e.g., the missing feedback of nonlocal spatial correlations on the local self-energy in the case of the DMFT. In the case of plain CPT, the situation is even worse as there is no feedback at all. In particular, plain CPT calculations cannot be expected to respect the macroscopic conservation laws emerging from the symmetries of the underlying Hamiltonian. This can be traced back to the fact that the plain CPT does not contain any element of self-consistency. Therefore, it is not surprising that a violation of, e.g., total-energy conservation has been observed.  With the present study we give a proof of principle that this drawback can be overcome. We make use of the fact that the CPT can be viewed as an all-order perturbation theory in the inter-cluster hopping around a system of decoupled clusters, where the starting point, i.e., the intra-cluster Hamiltonian, is not at all predetermined. The idea is to formulate the macroscopic conservation laws as local constraints on the spin-dependent particle and doublon density. These equations are then used to fix the intra-cluster one-particle parameters and thereby to optimize the starting point for the cluster-perturbation expansion. This defines a novel “conserving cluster-perturbation theory.” The theory is conserving by construction, it is nonperturbative, and in principle controlled by the inverse cluster size as a small parameter. In practice, however, the accessible cluster size is limited by the exponential growth of the cluster Hilbert space. Hence, conserving CPT must be seen as a typical cluster mean-field theory which correctly accounts for nonlocal correlations up to the linear scale of the cluster. Opposed to standard mean-field theories, the “mean-field” or the renormalization of the one-particle parameters is determined by imposing local constraints expressing conservation laws, i.e., it is finally the symmetries of the lattice model which dictates the time-dependent cluster embedding. As the theory relies on [LOCAL]{} self-consistency or conditional equations, it can easily be extended to inhomogeneous models or inhomogeneous initial states.  While the underlying idea is conceptually simple, its practical realization requires a couple of new theoretical concepts which are discussed here in detail. In particular, the implementation of a causal time-stepping algorithm requires a careful analysis to which order the renormalization of the intra-cluster parameters at a certain time slice enters the conditional equations. We are able to demonstrate that an efficient numerical implementation of the theory is possible and discuss first results for weak interaction quenches in a two-dimensional Hubbard model. The algorithm scales linearly with the propagation time and exponentially in the cluster size. Conservation laws are satisfied with numerical accuracy. Yet, long time scales cannot be achieved with the present implementation due to singular points which are found to evolve during the time propagation.  The next section briefly states the model and the necessary elements of the Keldysh formalism. Section   introduces the CPT and discusses the formulation of the local constraints. The mapping onto a noninteracting auxiliary problem is described in Sec.  . The main theoretical work addresses the solution of the local constraints for the optimal starting point of the all-order perturbation theory. This is presented in Sec.  . Numerical results are discussed in Sec.  , and the conclusions are summarized in Sec.  .">
</outline>
<outline text="Model and nonequilibrium formalism" _note="We consider the single-band, fermionic Hubbard model on an arbitrary lattice with a time-dependent hopping matrix and interaction strength . The hopping is assumed as spin-diagonal for simplicity. The Hamiltonian reads where the operators () create (annihilate) a fermion with spin at site (), and where denotes the spin-dependent local density operator. At time , the system is assumed to be in thermal equilibrium with inverse temperature and chemical potential . Nonequilibrium real-time dynamics for is initiated by the time dependence of the hopping matrix or the interaction strength. In principle, this covers challenging experimental setups such as time-resolved photoemission spectroscopy or experiments with ultracold gases in optical lattices.  Our central quantity of interest is the one-particle Green’s function which is defined as Here “” traces over the Fock space, i.e., we take averages using the grand-canonical ensemble. defines the grand-canonical partition function and the time-ordering operator on the Keldysh-Matsubara contour . The time variables and are thus understood as contour times. An in-depth introduction to the Keldysh formalism can be found in Refs., . Throughout the text we use the convention that operators with a hat carry a time dependence according to the Heisenberg picture, i.e., , where , for , is the system’s time-evolution operator and the time-ordering operator. The dependence of the Green’s function on and is made explicit in the notation using subscripts, i.e., , where convenient. A similar notation is also used for other quantities.  Through Dyson’s equation, the Green’s function is linked to the self-energy where is the noninteracting propagator. Its (contour) inverse is In Eq. ( ) we made use of the shorthand notation “” for the convolution of contour matrices. In particular Note that in this context we implicitly assume a contour Dirac delta function present in case of time-local quantities. For example, should be replaced by in a contour convolution, so that  Combining Dyson’s equation with the equation of motion for the one-particle Green’s function, we get where is the two-particle Green’s function and where indicates a flip of the spin index , i.e., and vice versa. Analogously to Eq., we furthermore have where is defined as The local doublon density can be expressed through the two-particle Green’s functions as with being infinitesimally “later” than in the sense of time ordering on the Keldysh-Matsubara contour.">
</outline>
<outline text="Preparations" _note="To enforce conservation laws within cluster perturbation theory (CPT), we proceed in two steps. First, we work out that the CPT approach is not unique and that there are free parameters at one’s disposal. Second, to fix these parameters, we suggest to employ local constraints expressing the conservation laws that result from continuous symmetries of the Hubbard model. We start with a discussion of the main idea of the CPT and of the local constraints on the spin-dependent particle and doublon density.">
  <outline text="Conventional cluster perturbation theory" _note="The idea of the CPT is to partition the lattice into clusters small enough to be treated exactly, e.g., using Krylov-space methods or full diagonalization, and to subsequently include the connections between the clusters perturbatively. On the level of the Hamiltonian one starts by partitioning the full hopping matrix into the intra-cluster hopping and the inter-cluster hopping so that only contains terms which connect lattice sites within the individual clusters, while contains all remaining terms such that , see Fig.  . Corresponding to the intra-cluster hopping, we define a cluster Hamiltonian which describes the system of isolated clusters, also referred to as the reference system. Its Green’s function and self-energy are denoted as and , respectively.  For the equilibrium as well as for the nonequilibrium case, the CPT can be seen as an all-order perturbation theory in the inter-cluster hopping which provides the one-particle Green’s function of the original system by expanding around the cluster Green’s function: We also have: In the noninteracting case, this is exact since . For finite , however, the CPT Green’s function represents an approximation of the exact Green’s function .  A closer look reveals that the CPT is not unique since one may consider a different starting point for the all-order perturbation theory in . To this end, consider a starting point with a renormalized intra-cluster hopping, , resulting in a renormalized cluster Green’s function and self-energy . Correspondingly, also the inter-cluster hopping must be renormalized as . Summation of the geometrical series yields where we emphasized the special role of the renormalization parameter by square brackets. For , we have for any . For an interacting system, however, the choice for is crucial, i.e., the resulting CPT Green’s function does depend on the starting point of the all-order perturbation theory in the inter-cluster hopping.  This ambiguity in the definition of the CPT seems to be problematic on first sight, yet it can be turned into an advantage by interpreting the renormalization as an optimization parameter. This has been worked out systematically in the context of the (nonequilibrium) self-energy functional theory (SFT), where the optimal is derived from a variational principle based on the self-energy. Here, we will take a different route and use the freedom in to enforce the local constraints on spin-dependent particle and doublon density. Physically, the parameter set must be interpreted as a nonlocal mean-field and the resulting conserving CPT as a cluster mean-field theory.">
  </outline>
  <outline text="Formulation of the conservation laws as local constraints" _note="While conservation laws like particle-number or energy conservation are naturally fulfilled if one is able to treat a physical problem exactly, this is not necessarily the case when working with approximate methods. For Green’s-function-based methods it was shown by Baym and Kadanoff that respecting certain symmetry relations for the two-particle Green’s function is sufficient to ensure that an approximation is conserving.  Here, we build on an equivalent formulation of the macroscopic conservation laws for the particle number, spin and energy and reformulate them as local constraints for the spin-dependent particle density and the doublon density, respectively. This is in the spirit of expressing conservation laws of a classical field theory as continuity equations and follows the work of Baym and Kadanoff. One should note, however, that in our case the local constraints cannot be written in the standard form of continuity equations, as here we aim at an approach for a discrete lattice model.  To discuss the local constraints, we first consider the exact time evolution of a system described by the Hubbard Hamiltonian . We write , and in this subsection to keep the notation simple. The exact time evolution of the system will preserve the total particle number and the -component of the total spin as can be expressed by the following local constraint for the spin-dependent density: as can be verified directly using Eq. .  The first line of Eq.  constitutes the discrete-lattice analog of the continuity equation for the spin-dependent particle density. Opposed to a continuum theory, however, the divergence of the spin-dependent particle-current density is replaced by the commutator. The second line of Eq.  is an equivalent formulation of the same constraint as has originally been mentioned by Baym and Kadanoff.  Next, we consider the following local constraint for the doublon density  : In the exact theory, this constraint together with the above constraint expresses the necessity that the doublon density can be derived consistently from either or and for each spin component in Eq. .  More important, in case of a time-independent Hamiltonian, i.e., if for , Eq.  ( ) implies total-energy conservation. This is explicitly shown in the Appendix   where, for completeness, also a formal derivation of Eq.  is carried out.  While in the exact theory the equations and must hold necessarily, this is no longer guaranteed in an approximate approach. In particular, the equations are usually violated within the conventional CPT.  The important point is that via Eqs. ( ) and ( ) both, and , can be expressed in terms of the single-particle Green’s function and the self-energy and thus both equations and can be expressed in terms of the central quantities of the CPT. Furthermore, as is shown below, they can be incorporated in the Markovian time-propagation scheme based on the Hamiltonian formulation of the CPT. The latter is essential for the numerical treatment.  Our main idea is thus to enforce the local constraints and within the context of the CPT by exploiting the above-discussed freedom in the choice of the CPT starting point, i.e., by choosing an appropriate renormalization . If can be found, this automatically ensures the conservation of particle number, spin and energy.">
  </outline>
</outline>
<outline text="Hamiltonian-based formulation" _note="In the last section we have introduced the CPT in its usual form, i.e., based on the self-energy of the reference system and Dyson’s equation. A major drawback of this approach is its limitation for the maximum propagation time that can be reached in a practical numerical calculation. This is due to the fact that the CPT Green’s function and the self-energy of the reference system are nonlocal in time through their dependence on two contour times. The necessary storage for these quantities scales quadratically with the maximum propagation time, the effort for solving Dyson’s equation scales cubically. This intrinsic limitation can be overcome if a so-called Lehmann representation of the self-energy is available. This allows us to solve the Dyson equation by means of a Markovian propagation scheme which permits to reach much longer time scales. In the following, we consider this Lehmann representation of the self-energy as given. Its existence for an arbitrary, fermionic lattice system out of equilibrium has been shown in Ref.  where also a constructive numerical scheme has been presented. It can be used in case of small clusters accessible to exact-diagonalization techniques. In the following we briefly recall the main results and then discuss the application to conservation laws and the respective local constraints.">
  <outline text="Convolution-free definition of  and" _note="The nonequilibrium self-energy of any lattice-fermion model has a unique Lehmann representation: Here, is the time-local Hartree-Fock term. The second term has a hybridization-function-like structure where denotes the hopping between a physical site and an additional VIRTUAL site labeled by the index . The time-independent on-site energy of the virtual site is given by . Furthermore, is the noninteracting Green’s function of an isolated one-particle mode () with excitation energy : Here, denotes the Fermi-function, and refers to the contour variant of the Heaviside step function, i.e., for , and otherwise.  The hybridization-function-like structure is the immediate and important advantage of the Lehmann representation. It allows to write down an effective, noninteracting model specified by the Hamiltonian which reproduces the one-particle Green’s function EXACTLY when evaluated at the physical sites . We emphasize that includes all correlation effects through the hybridization strengths and on-site energies of the virtual sites. Furthermore, the previously mentioned interpretation of the -degrees of freedom as additional virtual sites becomes obvious in Eq. .  For a given arbitrary self-energy one would typically have to consider a continuum of virtual sites. Here, however, the situation is much simpler since is the CPT self-energy, i.e., the self-energy of our reference model consisting of a system of decoupled clusters. In this case the total number of physical and of necessary virtual sites equals the number of single-particle excitations with nonzero weight. As the latter grows exponentially with the size of the individual cluster, the exact mapping and the exact numerical construction of the effective Hamiltonian is limited to clusters small enough to allow for an exact numerical diagonalization. The computation of the parameters of the effective Hamiltonian ( ) is nontrivial but straightforward and numerically completely stable. Details are described in Ref. .  For clarity, we use the following convention throughout the paper: Defining , the effective Hamiltonian can be written as (cf. Fig.  ) The corresponding Green’s function is given on the physical but also on the virtual sites, so that the original, physical Green’s function is obtained if we restrict to physical sites only, i.e., .  Many-particle correlation functions, e.g., spin-spin correlations, are in general not accessible from the effective Hamiltonian. There is, however, one important exception. Namely, the two-particle Green’s functions and can be expressed as contour convolutions of the system’s self-energy with the Green’s function, cf. Eqs.  and . In the Hamiltonian-based formalism this convolution is greatly simplified and becomes a straightforward matrix multiplication. By comparing Dyson’s equation with the equation of motion that follows from Eq. , one readily finds the identity An analogous relation can be derived for .  The result can be written in a more compact form by defining a new quantity via and . This is consistent with the alternative definition given in Appendix   which also holds for . In the physical sector it implies as follows from  . With this definition for and with the relations and we get Recall at this point that quantities like or (as well as , , etc.) are functionals of and .">
  </outline>
  <outline text="Hamiltonian-based formulation of the CPT" _note="Let us now discuss how the CPT Green’s function can be obtained from an effective one-particle Hamiltonian and how to set up a Markovian time-propagation scheme. As discussed in Sec.  , we have where is the renormalized intra-cluster and the renormalized inter-cluster hopping. For each set of parameters , an effective one-particle CPT Hamiltonian can be defined by adding the inter-cluster hopping to the effective Hamiltonian of the reference system: The CPT Green’s function, as computed from , then coincides with the original definition in Eq.  if only the physical sector is considered, i.e., . This can be verified easily by integrating out the virtual, degrees of freedom from . Eq.  reflects the freedom we have in the CPT construction as the -terms cancel in the physical sector. only enters implicitly through the hybridization strengths , through the on-site energies (where ) and through the Hartree-Fock term of the reference system’s Hamiltonian .  For each set of parameters , the two-particle correlation function is approximated within the context of the CPT as where we have defined Eq. ( ) corresponds to the exact expression given by Eq.( ). is defined analogously, and thus the symmetry relation is ensured within the CPT independently of . Note that this symmetry is not sufficient to allow for an unambiguous definition of the doublon density based on and  . Instead, it requires both constraints to be respected as discussed in Sec.  . In case of an arbitrary, non-conserving set of parameters this ambiguity needs to be circumvented by defining the doublon density as an average For , however, we have The final forms of the conditional equations for are obtained by replacing and by their CPT approximations and in the expressions for and given by Eqs.  and : We note that the number of free parameters must be chosen to match the number of linear independent constraints defined by Eq. to ensure the existence of a unique solution .">
  </outline>
</outline>
<outline text="Solving the self-consistency equations" _note="Having formulated the self-consistency conditions ( ), it remains to explicitly solve these equations for . An important simplification arises from the fact that the CPT is by construction a fully causal theory, i.e., the time-local elements of the CPT Green’s function at time , for example, only depend on quantities at earlier times. The same holds for and for . This allows us to construct a strategy for the solution of Eq. ( ) in the form of a time-propagation algorithm. Let us therefore assume that is known for all time points on a discrete time grid and that only the parameters at the latest point of time are unknown.  Therewith, the actual task is to solve Eq. ( ) for [ONLY AT THE GIVEN LATEST POINT OF TIME]{} . To this end we have to analyze at time the dependence of the relevant quantities, i.e., of and , see Eqs. ( ) and ( ). First of all, the dependence of (and ) on at time is due to the CPT Hamiltonian  ) and see Eqs. ( ) and ( )\]. The -dependence of the latter is exclusively due to the time-evolution operator of the reference system. The detailed construction of is not important here, and we refer to Ref.  for a comprehensive discussion. Finally, the functional dependence of on is through an integration over all times between and . With this information at hand, we are in fact able to characterize the dependence on at time of the quantities and which enter the local constraints ( ) that serve to enforce the conservation laws.  The most important point for the following discussion is the fact that, in the limit of vanishing time step , the parameter set at the latest point of time enters basically all central quantities as a null set only: Consider, for example, . Its first-order response due to a variation of at time [VANISHES]{} (as shown below). On the one hand, this missing sensitivity implies a complication of the theory since one has to account for this mathematical property explicitly when setting up a numerical implementation. On the other hand, once one has recognized the property, it actually helps to the solve Eqs. ( ). Consider a given arbitrary causal functional . The main trick is to enhance the sensitivity of to variations of at time by taking its time derivative. Typically, if the first-order response of vanishes, is a [LINEAR]{} function of at time . Clearly, this is the key to solve an equation like for .  In the following subsections   –   the above-sketched ideas are worked out on a more technical level. Finally, the section   addresses the initial state at time .">
  <outline text="Time-local variations" _note="Assume that we have found the optimal renormalization for . We introduce a variation which affects the current (the -th) time step only: For simplicity, we require the variations to be symmetric, i.e., . This implies a restriction to symmetric solutions . Consider now an arbitrary, causal functional , i.e., a functional that at time only depends on with . For such an object, the variational operator is related to the conventional functional derivative through where the restriction is necessary because of the symmetry requirement .  We now take the combined limit such that we always have to define the time-local variation in the continuum limit with the corresponding variational quotient This variational quotient describes the linear response of when varying the parameters at the latest time step:">
  </outline>
  <outline text="Integrated quantities in" _note="With the appropriate variation for our purposes at hand, we can study the effect of the variation on the main quantities within the CPT framework. We first consider the time-evolution operator (“propagator”) of the reference system . It is instructive to study the effect of the operator first, i.e., the effect of a time-local variation with finite time step . Keeping only terms of the order one finds In lowest order we thus have . This means that the linear response vanishes identically in the limit . This property originates from the fact that is integrated over time within the propagator , and that the contribution of a single time step, , to this integral is of zero measure in the limit .  A finite time-local variation is obtained for the first time derivative of the propagator rather than for the propagator itself. Namely, the corresponding time-local variational quotient remains non-zero in the continuum limit: Multiplying this equation with , summing over and comparing with the standard equation of motion , shows that the time derivative of the propagator is of the general form where . Note that the dependence on at time is strictly [LINEAR]{} in the limit .  With this definition and with Eq. , it is obvious that the variational derivative and on the right-hand side of Eq. ( ) depend on only through an integration over time within the propagator . We will call such quantities INTEGRATED quantities in . Integrated quantities in inherit an important property from the cluster propagator , see Eq. : Their time-local variation vanishes in the limit .  Furthermore, the time derivative of any quantity that is integrated in , i.e., the time derivative of a functional of the form , can be brought into a form analogous to Eq. . This follows immediately from the chain rule in calculus as . Explicitly this result reads where and are again integrated quantities in . We furthermore conclude that a time-local variation of the time derivative of an integrated quantity in is non-zero in general.  The main idea in the following is to combine the conditional equations into a single equation such that is of the form where and are integrated quantities in . This is formally easily solved for by matrix inversion and allows to derive an efficient propagation scheme for numerical purposes.">
  </outline>
  <outline text="-dependence of  and" _note="The main building blocks of the local constraints on the spin-dependent density, Eq.  , and the doublon density, Eq. , are given by the two-particle correlation functions and . Within the CPT approximation they are defined through Eq.  . We therefore have to understand the dependence of and .  One can easily see that is an integrated quantity in . Consider, for example, the physical sector. From Eq. we have . The only -dependence of this expression indeed stems from the propagator . To obtain a non-vanishing time-local variation we thus have to consider the first derivative with respect to time. This is worked out in Appendix  : where the newly introduced tensor is cluster-diagonal, i.e., if and only if and refer to lattice sites within the same cluster. It furthermore follows that can be brought into the form specified by Eq. , where the variational derivative , as given by Eq. , and are integrated quantities in . An explicit expression for the latter is not needed for our purposes.  Let us now take a look at the CPT Green’s function. It depends on through the Hamiltonian , which in turn depends on through the hybridization strengths and the Hartree-Fock term . The Hamiltonian is therefore an integrated quantity in . As the propagator involves a second integral over time, we conclude that . In this sense, must be seen as an integrated quantity in of second order. Consequently, the time-local variation of its first derivative with respect to time vanishes: We note that the time derivative involves the product of the matrix elements of the CPT Hamiltonian, Eq. ( ), with , i.e., the product of an integrated quantity in with an integrated quantity in of second order, respectively. Obviously, the product scales like an ordinary integrated quantity in when a time-local variation is applied, i.e., in lowest order in .  Concluding, to get a non-vanishing time-local variation, one must consider the first time derivative of the two-particle Green’s functions and . We find and an analogous expression for . Only the -term contributes to the variation, cf. Eq. , while the variation of the CPT Green’s function vanishes, cf. Eq. . We also note that Eq.  may be used at this point and that   is of the form where both, the variational derivative , as given by Eq. , and the quantity , which is not needed in explicit form for our purposes, scale like integrated quantities in under time-local variations. This follows from the fact that scales like an integrated quantity in under time-local variations and the related discussion above.">
  </outline>
  <outline text="-dependence of the local constraints" _note="The local constraint on the spin-dependent density, Eq., is formulated in terms of the difference between and . Therefore its first derivative with respect to time must be considered to obtain a non-vanishing time-local variation: For the time-local variation of the local constraint on the doublon density, Eq. , on the other hand, one finds since , where we made use of the fact that is the hopping of the original system and thus independent of .  To treat both constraints in a combined formal frame, we define the functional : where is the number of lattice sites. With this, the conditional equation for the optimal renormalization reads . From the previous discussion and Eq.  it follows that is of the form where we introduced the super-index which labels the set of free parameters: , . Both and scale like integrated quantities in under time-local variations. The Jacobian matrix is defined as The matrix is quadratic if the number of free parameters is chosen such that it equals the number of conditional equations  . Assuming that is regular, one can formally solve the conditional equation for the optimal renormalization: see Eq. ( ). This completes our derivation.  Let us emphasize that the single point represents a null set with respect to the time-integrations in and . This can be exploited to derive an efficient numerical scheme to obtain step by step on the time axis as detailed in Appendix  . There we also argue why finding an explicit expression for can in fact be circumvented. An explicit expression for in terms of known quantities, on the other hand, is available via Eqs. , , and .">
  </outline>
  <outline text="The equilibrium initial state" _note="Initially, at time the system is assumed to be in a thermal state. The CPT approximation for the initial thermal state suffers from the fact that the starting point of the all-order perturbation theory in the inter-cluster hopping is not unique. This is completely analogous to the CPT description of the real-time dynamics. Unlike the real-time dynamics, however, the local constraints cannot be used to fix the renormalization parameters for the initial state, and thus a nontrivial self-consistency condition is not available, unfortunately.  This can be seen as follows: Let us assume that the hopping matrix , and consequently and , are real and symmetric. Consider at times . Via Eq.  this is given as . In Appendix   it is shown that at time the imaginary part vanishes, independently of . Hence, Eq.  implies that is real and symmetric, and therefore is purely imaginary. Consequently, is real. Finally, we conclude with Eq. that This directly proves that , and furthermore irrespective of , i.e., both constraints hold trivially.  For the concrete numerical calculations we therefore circumvent this issue and consider a noninteracting initial state. In this case the CPT is exact, independent of the choice of . The initial value is then fixed by requiring to be continuous so that .">
  </outline>
</outline>
<outline text="Numerical results" _note="The conserving CPT has been implemented numerically. First results are discussed for the two-dimensional Hubbard model on an square lattice with periodic boundary conditions. As these results shall serve as a proof of concept only, we restrict ourselves to the most simple approximation, i.e., to the smallest meaningful cluster as the building block of the reference system, namely a cluster consisting of sites. Hence, the entire system is partitioned into clusters in total, see Fig.  .  Initially, the system is prepared in its noninteracting ground state at half-filling by choosing . Note that the CPT description of this initial state is exact (and independent of the renormalization). The hopping of the original system is restricted to nearest neighbors, and we set the nearest-neighbor hopping to fix energy and time units. To drive the system out of equilibrium we consider an interaction quench where the Hubbard- is suddenly, at time , switched on to a finite value : Here, denotes the Heaviside step function. For times the interaction strength is constant. To maintain particle-hole symmetry and half-filling, the chemical potential is quenched as well, from to in the final state.  Studying the model at the particle-hole symmetric point is convenient since the conservation of the total particle number is trivially respected in this case. For a spin-independent parameter quench, as considered here, the CPT also trivially respects the conservation of the total spin. Total-energy conservation, on the other hand, is violated in a conventional CPT approach as has been explicitly demonstrated recently. For the present setup we will therefore employ the nearest-neighbor hopping within the reference system to enforce the energy-conservation law. This specifies the time-dependent renormalization parameter (see Fig. ).  We note that the computational effort to self-consistently evaluate the presented theory numerically is essentially determined by the underlying solver for the conventional nonequilibrium CPT with little overhead. Here, we use the time-local, Hamiltonian-based solver developed in Ref.  which constructs the effective Hamiltonian of each cluster by exact diagonalization. For the reference system under consideration, only two virtual sites are needed for an exact mapping. This gives us four sites per cluster so that the CPT-Hamiltonian comprises sites in total. Furthermore, regarding computational demands, our approach inherits a constant memory consumption from the CPT solver as well as the linear scaling in the maximum propagation time. In particular, we have used a time step of to propagate the system up to steps up to a maximum propagation time of . For each such time step , the scheme developed in Appendix   has been employed with , i.e., we have calculated the Taylor coefficients and .  While the required computational resources are very moderate, accessing longer time scales has turned out to be hindered by mathematical complications. As is obvious from Eq. , an inversion of the Jacobian matrix is necessary to obtain at each time step. However, with increasing this matrix exhibits singular points of non-invertibility at earlier and earlier times. In fact, one finds numerically that also the starting point is singular, namely the Jacobian matrix vanishes: . Fortunately, one also has , such that this problem is fixed by applying L’Hôpital’s rule. At time , the defining equation for becomes While this solves the problem at time , finding a systematic and convenient way to propagate beyond the singular points of the Jacobian matrix at [FINITE]{} times remains topic for future investigations.  Apart from this technical problem, the suggested scheme works as expected. Results for the time evolution of the doublon density are shown in Fig. . It is evident that the renormalization has a strong influence on the dynamics and leads to qualitatively different results when comparing the plain unoptimized CPT calculation with the novel conserving CPT. While the dynamics is characterized by ongoing oscillations when using plain CPT, there is a monotonic decay of the doublon density in case of the conserving CPT. The longest maximum propagation time is achieved for the quench . Here, the first singular point of the Jacobian shows up at . On this time scale, the doublon density seems to relax to a stationary state with little to no oscillations.  The qualitatively different time dependence of the doublon density reflects the qualitatively different behavior found for the total energy in the plain and the conserving CPT: This is shown in the inset of Fig.  . For the conserving CPT, the total energy is perfectly conserved within numerical accuracy – by construction of the approach. In the plain CPT calculation, however, the total energy shows unphysical oscillations. Here, maxima and minima of nicely correspond to maxima and minima in the plain-CPT doublon density seen in Fig.  . It must be concluded that those are artifacts of the plain CPT approach. We also note that small unphysical oscillations of the total energy [DENSITY]{} (with ) with amplitudes less than lead to much stronger oscillations in the doublon density with amplitudes of about 0.04.  The main part of Fig.   displays the results for the time evolution of the renormalization parameter . Its dependence on turns out to be rather weak on a time scale of a few inverse hoppings. Irrespective to the final interaction strength , the initial equilibrium value is found as . For and for all , the renormalization parameter rapidly increases to within a very short time . This corresponds to the rapid initial drop of the doublon density (cf. Fig. ). Results for longer times are again only available for the quench . On the time scale up to , we observe a subsequent slow relaxation of toward an average final value with small superimposed oscillations. It seems reasonable to assume that a similar behavior would also be found for the other quenches, given that the short-time dynamics is very similar for the different .  One should note that amounts , i.e., a vanishing renormalized intra-cluster hopping. Apart from the remaining oscillations of the renormalization parameter around , this means that the system “chooses” the atomic limit of the Hubbard model as the optimal starting point for the all-order perturbation theory in the inter-cluster hopping for long times. This may be interpreted as follows: First of all, the remaining oscillations are understood as being necessary to keep the total energy constant within the conserving CPT. Disregarding the oscillations, the value means that, on the level of the reference system, the doublon density becomes a conserved quantity for long times. This, however, is in fact a plausible starting point if the doublon density of the full lattice model approaches a constant in the course of time. As is seen in Fig.  , this is almost the case. The remaining time dependence of the doublon density of the lattice model is weak and would be exclusively due to the inter-cluster hopping (if exactly).  Let us compare the CPT result for the doublon density with the results of previous calculations for the one-dimensional Hubbard model using the density-matrix renormalization group (DMRG) and for the model in infinite dimensions using the dynamical mean-field theory (DMFT). In both cases, a very fast relaxation of the doublon density on a time scale of one inverse hopping has been found in fact. Typically, however, the doublon density first develops a minimum before it saturates to an almost constant value. This minimum is absent in the conserving CPT calculations (see Fig. ). Note, that for weak quenches and on the intermediate time scale discussed here and in the DMRG and DMFT studies, the doublon density does not relax to its thermal value due to kinematic constraints becoming active after the ultrashort initial relaxation step. Indeed, one expects a subsequent relaxation on a much longer time scale. Let us emphasize that while our data in Fig.   are compatible with these expectations, serious predictions using the conserving CPT are not yet possible. This would require a much more systematic study involving different and in particular larger clusters, an analysis of the dependence on the cluster shape and also a systematic discussion of the different possibilities to choose renormalization parameters for the self-consistent procedure.">
</outline>
<outline text="Conclusions" _note="Cluster-perturbation theory, as proposed originally, represents the most simple way to construct a mean-field theory which incorporates to some extent the effects of short-range correlations. We have emphasized that the starting point of the perturbational expansion in the inter-cluster hopping is by no means predetermined and that the according freedom in the choice of the intra-cluster hopping parameters can be exploited to “optimize” the mean-field theory. There are different conceivable optimization schemes. One way is to add an additional self-consistency condition as, for example, a self-consistent renormalization of the on-site energies which would be very much in the spirit of the Hubbard-I approximation. The disadvantage of such ideas is their [AD HOC]{} character. An optimization following a general variational principle is much more satisfying and physically appealing. This is the route that is followed up by self-energy-functional theory. Unfortunately, total-energy conservation is not straightforwardly implemented within the SFT context. An appealing idea is thus to use the above-mentioned freedom to [ENFORCE]{} energy conservation, and actually any conservation law dictated by the symmetries of the problem at hand. This leads to the conserving CPT proposed in the present paper.  As we have argued (see Sec.  ), this idea can exclusively be used to constrain the CPT real-time dynamics while other concepts must be invoked for the initial thermal state. On the other hand, there is an urgent need for numerical approaches, even for comparatively simple cluster mean-field concepts, which are able to address the real-time dynamics of strongly correlated lattice fermion models beyond the more simple extreme limits of one and infinite lattice dimension.  With the present paper we could give a proof of principle that a nonequilibrium conserving cluster-perturbation theory is possible and can be evaluated numerically in practice. An highly attractive feature of this approach is the linear scaling with the propagation time, while the exponential scaling with the cluster size is the typical bottleneck of any cluster mean-field theory.  The mapping of the original nonequilibrium CPT onto an effective auxiliary problem specified by a noninteracting Hamiltonian with additional virtual (“bath”) degrees of freedom is crucial for the practical implementation of the approach. One should note that the number of virtual sites is related to the number of one-particle excitations and thus grows exponentially with the original cluster size. Hence, any practical calculation is limited to a few (say, at most 10) cluster sites only. This implies that a systematic finite-size scaling analysis will be problematic if long-range correlations dominate the essential physical properties – this is the above-mentioned drawback that is shared with any available cluster-mean-field theory. We therefore expect that the field of applications of conserving CPT is limited to problems with possibly strong but short-ranged correlations.  Due to its formulation in terms of Green’s functions with time arguments on the Keldysh contour, the CPT has an inherently causal structure. With the present paper we could in particular demonstrate how to exploit this causality for an efficient time-stepping algorithm where updates of the parameter renormalization can be limited to the respective last time slice during time propagation. The essential problem that had to be solved here consists in controlling the order (in the sense of a Taylor series) at which the parameter renormalization on a single time slice enters other physical quantities, such as the basic time-evolution operator, Green’s functions, etc. This has allowed us to set up a highly accurate numerical algorithm where conservation laws are respected with machine precision.  For convenience, first numerical results have been generated for interaction quenches of the two-dimensional Hubbard model on a square lattice at half-filling, where particle-number and spin conservation are respected trivially. Energy conservation has been enforced by time-dependent renormalization of the intra-cluster hopping in the reference cluster. It is worth pointing out that even with this simple approximation (small cluster) the impact of the self-consistency condition is substantial. Comparing the conserving against plain CPT, there is a qualitative change of the time-dependence of the doublon density which is plausible and improves the theory: Artificial oscillations due to the finite cluster size are almost completely suppressed, and an ultrafast relaxation to a (prethermal) state with nearly constant doublon density is predicted as might be expected from previous computations for one- and infinite-dimensional lattices.  Let us emphasize once more that the purpose of the present paper has been to formally develop the very idea of a constrained CPT and to provide a proof of principle for its practicability. There are a couple of future tasks that suggest themselves immediately but are beyond the scope of the present paper: First of all, a more systematic study of the dependence on the cluster size and shape is needed. Note that this also includes the necessity to take into account more than a single optimization parameter as there are four local constraints to be satisfied in the present formulation of the theory  )\], corresponding to the conservation of spin and particle density as well as two constraints for the doublon density (implying energy conservation). Hence, for a cluster consisting of sites, at most parameters are needed. In addition, both the number of constraints and the optimization parameters depend on the spatial symmetries and other symmetries, e.g., particle-hole symmetry, of the original and the reference system. If necessary, more degrees of freedom and correspondingly more parameters can be generated by coupling uncorrelated “bath” sites to the physical sites in the reference system in the spirit of (cluster) dynamical mean-field theory. Systematic studies addressing the mentioned issues are necessary before a systematic and quantitative comparison with other approaches or with experiments is meaningful.  Interestingly, the conditional equations for the renormalization parameters feature singular points of non-invertibility. Technically, this currently restricts our investigations to quenches with small final interaction and short propagation times. It is not clear at the moment whether or not a physical meaning can be attributed to those singular points; also this requires further systematic studies. According to our present experience, it is well conceivable that, with a suitable regularization scheme, time propagation through a singularity of the Jacobian is possible and has no apparent impact on the time dependence of physical observables. Developing such a regularization scheme is the next task for future studies and the most important issue to make the conserving CPT a powerful numerical tool to address, e.g., real-time magnetization dynamics, even of inhomogeneous models and on long time scales.  We thank Roman Rausch for providing an exact-diagonalization solver for the Hubbard model and Felix Hofmann for valuable discussions. This work has been supported by the Deutsche Forschungsgemeinschaft through the excellence cluster “The Hamburg Centre for Ultrafast Imaging - Structure, Dynamics and Control of Matter at the Atomic Scale” and through the Sonderforschungsbereich 925 (project B5). Numerical calculations were performed on the PHYSnet computer cluster at the University of Hamburg.">
</outline>
<outline text="Local constraint on the doublon density" _note="Within this subsection we will use the shorthand notation and . To prove the local constraint on the doublon density, we consider where we used that the double occupation operator commutes with the interaction term of the Hamiltonian . Using further that we find the final form by comparing with Eqs.  and and using the relation . This implies which completes our derivation of Eq. .  To prove that Eq. indeed ensures energy conservation, let us consider a time-independent Hamiltonian with and . We consider the time-derivative of the kinetic energy first. Since the kinetic part of the Hamiltonian trivially commutes with itself, one obtains This term cancels with assuming Eq. holds thus proving energy conservation for a time-independent Hamiltonian.">
</outline>
<outline text="Mathematical structure of the effective Hamiltonian" _note="In Eq.  we have stated the effective one-particle Hamiltonian for an interacting lattice system. Its corresponding matrix elements are given by , cf.  Eq. . In Ref.  it is shown that can be constructed from the Lehmann representation of the one-particle Green’s function . It is given by The matrix can explicitly be stated within the physical sector only (i.e., ). There it takes the form where denotes the -th eigenstate with corresponding eigenenergy of the initial Hamiltonian, i.e., . denotes the grand-canonical partition function, the inverse temperature of the equilibrium initial state. The remaining matrix elements are defined uniquely, up to rotations in invariant subspaces, by requiring to be a unitary transform, see Ref.  for details. Eq.  is now easily derived from where With the definition we arrive at Eq. . It is instructive to note that the elements in the physical sector are easily evaluated as where denotes the anti-commutator. From a numerical point of view we note, that as well as its derivatives with respect to time of arbitrary order can be easily evaluated using the exact-diagonalization-based scheme presented in Ref. .  Regarding our discussion of the initial state in Sec.   it is now easy to proof that . At time the elements can be chosen as real, since the Hamiltonian is symmetric and therefore has real eigenvectors . Similarly, the physical sector is real in this case and completion to a unitary matrix allows for an orthogonal, i.e., real . It then follows that from Eq. . We note that any non-real choice can be brought into the form , where the matrix contains the phase factors and possibly rotations in invariant subspaces. However, from Eq. it follows that and therefore the matrix cancels. The same proof holds for the reference system, i.e., , assuming is real.">
</outline>
<outline text="Calculating the time-local variation of" _note="Let denote the matrix elements of the effective Hamiltonian of the reference system , cf. Eqs. and . Through Eq. , or equivalently Eq.  , a corresponding matrix is defined. We are interested in how it transforms under time-local variations. Since is an integrated quantity in , we first calculate its derivative with respect to time. Eq.  implies where and . With , the time-local variation of is given by where we further introduced and exploited . The time-local variation of , on the other hand, vanishes since it is an integrated quantity in . This follows directly from the definition of its physical sector, cf. Eq. . We define and therewith obtain Eq. .">
</outline>
<outline text="High-order time propagation scheme" _note="Finally, we like to set up an efficient numerical scheme to determine . This should be based on a time-propagation algorithm where the error is of high order in the basic time step . Let us assume that for each time step the Taylor expansion of is well defined. For each time interval and for arbitrary we then have where each -term must be considered as a tuple with components labelled by the super-index , e.g., , where refers to the -th time interval, and where runs from up to the maximum order of the polynomial . During the time propagation, the polynomial approximation must be updated after each time step. This is done by fixing the coefficients at each interfacing time such that . For times we then have . Writing and for short and applying the product rule to , the self-consistency condition is readily rewritten in terms of the Taylor coefficients:  Suppose that is known for all , i.e., suppose that the propagation has been completed over the interval . The next step is to update the coefficients. At this point we can exploit that and scale like integrated quantities in under time-local variations which implies and . Hence, at , both are independent of . We define Then, and we are now able to solve Eq.  for . The first derivatives and explicitly depend on , which is now known, but are integrated quantities in the first derivative , i.e., they are independent of . Therefore, the same idea can be applied and in fact be repeated again and again until finally is known up to the desired order. We emphasize that the presented algorithm gives a fully converged for within a single iteration.  [51]{} natexlab\#1[\#1]{}bibnamefont \#1[\#1]{}bibfnamefont \#1[\#1]{}citenamefont \#1[\#1]{}url \#1[`#1`]{}urlprefix [\#2]{}   [[\#2](#2)]{}  , , , , ****, ().  , , , , , , ****, ().  , ****, ().  , , , ****, ().  , , , , ****, ().  , in: Computational Many-Particle Physics, Vol. 739 of Lecture Notes in Physics, edited by H. Fehske, R. Schneider, and A. Weiße, pp. 277 (, , ).  , ****, ().  P. Werner, T. Oka, and A. J. Millis, Phys. Rev. B ****, ().  , ****, ().  , , , , ****, ().  , ****, ().  , ****, ().  , ****, ().  , , , , , ****, ().  , , , ****, ().  , , , ****, ().  , , , , ****, ().  , ****, ().  , ****, ().  , ****, ().  , , , ****, ().  , , , ****, ().  , , , , ****, ().  , ****, ().  , , Ed. by A. Avella and F. Mancini, Springer Series in Solid-State Sciences, Vol. 171, p. 303 (, , ).  , , , ****, ().  , , , , , ****, ().  , ****, ().  , , , ****, ().  , , , ****, ().  , , , ****, ().  , ****, ().  , cond-mat/0202046.  , , , ****, ().  , , , , ****, ().  , , , , ****, ().  , ****, ().  , ****, ().  , ****, ().  , , , ****, ().  , ****, ().  , , , , ****, ().  , ****, ().  , , , , , , , , , ****, ().  , , , ****, ().  , ****, ()  .  , (, , ).  , , , , , , vol. of (, , ).  R. Rausch and M. Potthoff, Phys. Rev. B [**95**]{}, 045152 (2017)  , ****, ().  , , , , , ****, ().">
</outline>
  </body>
</opml>