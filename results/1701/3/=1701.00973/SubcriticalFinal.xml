<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>Subcritical graph classes containing all planar graphs</title>
    <abstract>We construct minor-closed addable families of graphs that are
subcritical and contain all planar graphs. This contradicts (one
direction of) a well-known conjecture of Noy.

KEYWORDS: Subcritical graph class, planar graphs

2010 MSC: Primary: 05C30; Secondary: 05A16, 05C10, 05C80, 05C83 </abstract>
  </head>
  <body>
<outline text="Introduction" _note="Subcritical classes of (finite, simple) graphs are defined by a technical condition involving their generating functions; we recall the formal definition in the next section.  Loosely speaking, graphs from subcritical families can be thought of as “tree-like”. Indeed, it is shown in that their Benjamini–Schramm limits are similar to that of random trees. Subcritical graph classes have also been observed to exhibit tree-like behaviour of a different kind: Panagiotou, Stufler and Weller showed that the scaling limit of random graphs from subcritical classes, in the Gromov–Hausdorff sense, is Aldous’ continuum random tree (see also ).  Other properties of subcritical families that have been studied include the degree distribution , extremal parameters such as the maximum degree and the diameter , and subgraph counts . Important examples of subcritical graph classes include cacti, outerplanar graphs and series-parallel graphs.  Noy made the following well-known conjecture, which attempts a characterization of the subcritical families that are addable and minor-closed.  An addable, minor-closed class of (labelled) graphs is subcritical if and only if it has a planar forbidden minor.  A class of graphs is called [MINOR-CLOSED]{} if every minor of a graph is again in . The class is called [ADDABLE]{}, if it satisfies the following two requirements: 1) the disjoint union of any two graphs belongs to , and 2) for every , the graph obtained by adding an edge between two vertices in distinct components of is again an element of .  Recall that a minor-closed graph class has a planar forbidden minor if and only if it has bounded tree-width . Thus, in the light of the above discussion, Noy’s conjecture can be interpreted as stating that tree-likeness in the graph minor sense coincides with tree-likeness in the sense of enumerative and probabilistic combinatorics.  The aim of this paper is to provide a counterexample to one direction of Noy’s conjecture: we construct addable, minor-closed, subcritical classes of graphs that contain all planar graphs[^1]. These classes are defined as follows:    We let be the class of all graphs with the property that every [BLOCK]{} (i.e. maximal connected subgraph without a cutvertex) is either planar or can be reduced to a forest by removing at most vertices.  Verifying that is indeed addable and minor-closed is not difficult; the main result will be the fact that it is subcritical for . Heuristically, the reason is that the “tree-like” blocks become more numerous and thus asymptotically more important than the planar blocks, and that inherits the tree-likeness from them.  The number of graphs with vertices that can be reduced to a forest by removing at most vertices, from now on called [-APEX FORESTS]{}, has been obtained asymptotically by Kurauskas and McDiarmid . Combining their result with our asymptotic enumeration of the 2-connected ones, we deduce, in Section  , that the probability for a uniformly random -apex forest to be 2-connected decays exponentially in , and we determine the rate of exponential decay for each .  Let us remark that we will only consider labelled graphs in this manuscript. However, the same approach also applies to the unlabelled setting. We also emphasize that this only provides a counterexample to one direction of Noy’s conjecture. The other direction (an addable, minor-closed graph class with a forbidden planar minor is subcritical) remains plausible.  [^1]: Even more, in Section   we observe that our construction     can be generalised to contain all graphs from any fixed proper     minor-closed graph family.">
</outline>
<outline text="Subcriticality" _note="A maximal connected subgraph without a cutvertex is called a BLOCK. A class of graphs is called BLOCK-STABLE if it satisfies the following property: a graph lies in if and only if all blocks of lie in . Let denote the class of all connected graphs in and the class of all blocks in . Moreover, let , and be the exponential generating functions associated with , and respectively. The three are connected by the functional equations where is the exponential generating function for ROOTED connected graphs in . Let and be the radii of convergence of and respectively. If , the class is called SUBCRITICAL. This technical condition ensures that has a dominant singularity at of square-root type (see ), with many important consequences. As mentioned earlier, subcritical graphs are tree-like in many ways. The main result of this manuscript is:    For every , the graph class is subcritical.  The main idea is as follows: we first determine the radius of convergence of the exponential generating function associated with the blocks of . In doing so, we show that planar blocks form a negligible part of the set of possible blocks. Finally, we prove that goes to infinity as . This in turn is used to prove subcriticality.">
</outline>
<outline text="Proofs" _note="To prove that the classes of Definition   contradict Noy’s conjecture, we have to show that they are addable, minor-closed and —for — subcritical. We start with the first two properties, which are easier to prove.    For every positive integer , the graph class is both addable and minor-closed.  To prove that is addable, note first that disjoint unions of graphs in are trivially elements of again. Next consider any graph , and let be obtained from by connecting two vertices in distinct connected components of by an edge. Note that the blocks of are the blocks of and the newly added edge. Since a single edge is a planar graph and thus an allowed block, the graph still lies in . Hence the class is addable.  To show that is also minor-closed, we need to prove that it is closed under the operations of removing a vertex, removing an edge, or contracting an edge. When an edge or a vertex is removed, all blocks of the new graph are subgraphs of blocks of the old graph. Every subgraph of a planar graph is again planar. Likewise, if a graph can be reduced to a forest by removing at most vertices, so can any subgraph (by removing the same vertices or – if some of them are not part of the subgraph – a subset thereof). Thus the condition in Definition   remains valid if vertices or edges are removed.  The last operation to consider is contraction of edges; it suffices to consider the block that contains the contracted edge. If this block is planar, it remains so after the edge contraction. If the block can be reduced to a forest by removing at most vertices, then this is still true after the edge contraction: removing the same vertices (possibly one less, because two of them have been reduced to a single vertex) yields the original forest, a subgraph thereof (again a forest), or the original forest with a contracted edge (which is also a forest). In each of these cases, all newly created blocks (which are subgraphs of the old block with the contracted edge) satisfy the condition of Definition  , completing our proof.  We now proceed with the proof of the main result of this paper, Theorem  . Recall that there are labelled trees with vertices and consequently rooted labelled trees. The exponential generating function associated with rooted labelled trees is sometimes called the TREE FUNCTION: The tree function is closely related to the LAMBERT -FUNCTION, which is defined using the functional equation . This equation defines a multivalued function, and if we let denote its principal branch, we can express as the power series , see . Thus we have . Hence satisfies the functional equation .  The exponential generating function for unrooted (labelled) trees is given by Note here that represents rooted trees, while is the exponential generating function for edge-rooted trees (equivalent to unordered pairs of rooted trees). Since the number of vertices of a tree is always the number of edges plus , the difference yields exactly the exponential generating function for unrooted trees. A forest is a collection of trees, hence the exponential generating function associated with the class of all forests is . We will denote the class of all labelled unrooted trees by and the class of all labelled forests by .  In the following, we need bivariate versions of that also involve the number of leaves: let , and be those three exponential generating functions, where the exponent of equals the number of leaves. The symbolic method described in Part A of  can be used to obtain functional equations for these functions. First of all, we have (cf. ) which follows from the fact that the number of leaves of a rooted tree equals the sum of the number of leaves over all its branches (the root only counts as a leaf in this context if it is the only vertex), unless the tree consists of the root only. The last term takes this into account. The functional equation  has the explicit solution Furthermore, we have the explanation being similar to : the first term stands for rooted trees. The second term corrects for the fact that we did not let the root count as a leaf in unless it was the only vertex. The last term represents edge-rooted trees. Finally, since forests are simply collections of trees, we have In the following, we will make use of the fact that is analytic in the complex plane, except for a branch cut along the positive real axis, starting at . Its asymptotic expansion at the branch point is given by (see ) valid in an any fixed neighbourhood of the branch point with the real numbers greater than removed. This will allow us to apply the principles of singularity analysis to some of the generating functions we encounter. It will be important later that the term involving vanishes in the generating function as given in : a simple calculation shows that  Now let be the exponential generating function associated with blocks in , and let be the exponential generating function for the “second type” of blocks in , i.e., 2-connected graphs that can be reduced to a forest by removing at most vertices. This set of graphs is denoted by . In our first lemma, we bound the number of elements of , which in turn gives an estimate for the radius of convergence.    Let be the smallest positive solution to the equation . There exists a positive constant (depending on ) such that contains at most elements with vertices for all positive integers .  Every element of that is not just a single edge consists of a forest and additional vertices, ; each leaf of the forest needs to be adjacent to at least one of the additional vertices, for otherwise the minimum degree would be , making it impossible for the graph to be -connected. Let denote the number of leaves of . Given and , there are possibilities for the edges between the additional vertices, there are possible ways to connect a leaf of to the additional vertices (any possible set of edges except for the empty set) and possible ways to connect each other vertex of . Therefore, an upper bound for the number of elements of with vertices is given by (the binomial coefficient takes the possible ways to assign labels to the special vertices into account). Note that this is indeed just an upper bound rather than the exact number: not all graphs obtained in this way are -connected, and there is also some double-counting, see the discussion in the following lemma. The exponential generating function associated with this estimate is Note that has positive coefficients, so by Pringsheim’s Theorem it must have a positive real singularity on its circle of convergence. In view of ,  and , inherits its singularities from Note that is real if and only if either is real or is of the form for some real . Since , the only part of the open unit disk that is mapped to the real axis by the function is the real interval . Moreover, this function is increasing on . It follows that the function is analytic on the unit disk, except for a branch cut along the positive real axis starting at the solution of the equation .  Since this is decreasing as a function of , the term in  dominates the rest. Now combine  and  to obtain Now we can make use of . Observe also that we have the Taylor expansion around the point . Putting everything together, we find that for a constant (that can also be determined, but it is irrelevant for us). Finally, in view of , Recall that all terms with in  are asymptotically irrelevant since their smallest singularities are all greater than . The factor in  results in an additional factor in the dominant singular term of order . Hence we obtain that for suitable constants . Specifically, . This is valid in the intersection of a neighbourhood of with the slit plane that has all real numbers greater than removed. Apart from this branch cut, is an analytic function for . Hence yields as , which implies the desired result.  Next, we provide a lower bound for that is of the same order as the upper bound of Lemma  .    Let be as defined in the previous lemma. There exists a positive constant (depending on ) such that contains at least elements with vertices for all sufficiently large positive integers .  We provide a matching lower bound in a similar way as in the previous lemma. Consider the set of all graphs consisting of a tree and a complete graph and a number of additional edges, each with one end in and the other in , such that each leaf of is adjacent to at least one of the vertices in the complete graph. We show that almost all of these graphs belong to , i.e., they are -connected. Later, we derive a lower bound for the number of graphs in , which in turn yields a lower bound for the number of elements of .  Consider an element of : we show that it is -connected unless an exceptional situation occurs. Indeed, if one of the tree vertices is removed, the tree decomposes into several connected components, each of which contains at least one leaf. Since each of the leaves needs to be adjacent to at least one of the vertices of the complete graph, the resulting graph is still connected. On the other hand, if one of the vertices of the complete graph is removed, the remaining graph consists of a tree and a complete graph (both of which are connected graphs), and these two graphs are still connected by at least one edge unless all edges connecting to the complete graph lead to the same vertex. Since this is the only scenario for which is not -connected, we can expect most elements of to be -connected. We will prove this below by obtaining the exponential generating function for the non--connected elements of .  First, we can use the same reasoning that gave us  to find that the exponential generating function for the set of graphs is which has the same dominant singularity and an asymptotic expansion of the same form as , albeit with other coefficients. Hence the coefficients of satisfy an asymptotic formula of the form  (with a different multiplicative constant).  However, some more care is needed to complete the proof: firstly, we need to subtract those graphs that are not -connected because one of the vertices of the complete graph is an endpoint of all connecting edges. There must be an edge between this vertex and all leaves, and there might be further edges between this vertex and other tree vertices, but no other edges connecting the tree and the complete graph. Hence the exponential generating function for such graphs is which has a greater radius of convergence (namely ) than , hence its coefficients are negligibly small.  The second issue we need to take into consideration is the potential double-counting: for a given graph in , the vertices forming the complete graph may not be unique. We will show, however, that this only happens for a very small proportion of graphs in .  To this end, we consider the degrees of the vertices. Among all the possible combinations consisting of a tree, a complete graph and edges between the two as described above, pick one at random. The distribution of the degree of a vertex of the complete graph is almost a binomial distribution, meaning that the degree is concentrated around . Consider e.g. the probability that such a vertex has degree at most . The fact that the vertex is connected by an edge to all other vertices of the complete graph by default, and the fact that the probability to be connected to a leaf by an edge is slightly above , only decrease this probability compared to the binomial distribution. For the binomial distribution, we find the probability to be at most using the Chernoff bound for , which is exponentially small in . So the vertices that form the complete graph have a degree of at least for all but a negligible set of combinations.  On the other hand, let us estimate the number of combinations for which a tree vertex has large degree, say at least . A simple upper bound will suffice: there are ways to distribute the labels, choices for the vertex with large degree, and at most possibilities for the edges between tree and complete graph. The number of labelled trees with vertices for which a fixed vertex has degree is (by ). Hence we have the upper bound which by Stirling’s formula is also negligibly small compared to . It follows that for all but a negligible set of combinations, the vertices of the complete graph are the only vertices whose degree is at least , which means that they are unique. This completes the proof of the lower bound.    For , the exponential generating function associated with the set of all possible blocks of graphs in has radius of convergence . Moreover,  We make use of the results of Giménez and Noy on the enumeration of planar graphs. Specifically, the number of -connected labelled planar graphs with vertices is asymptotically given by for and . Since for , it follows that the planar blocks form a negligible portion of , as the number of elements in grows exponentially faster. The statement on the radius of convergence and the behaviour of the second derivative now follow immediately from the previous two lemmas.  Now we are ready to complete the proof of the main theorem.  It is well known (see or ) that a function that satisfies a functional equation of the form , where has positive coefficients, has a dominant square root singularity at , where is the positive real solution to the equation , provided such a solution exists inside the circle of convergence of .  In our situation, where we consider the exponential generating function of rooted connected graphs in , we can let in view of , so the equation reduces to . In view of Corollary  , we have . Since we also have and is continuous and increasing as a function of , it follows from the intermediate value theorem that there is indeed a unique value such that .  Consequently, has its dominant square root singularity at , and . This proves that is a subcritical family.">
</outline>
<outline text="The probability of 2-connectedness" _note="In the previous section we obtained asymptotics for the number of 2-connected -apex forests with vertices. The corresponding asymptotics for the number of all -vertex -apex forests, not necessarily 2-connected, was determined by Kurauskas and McDiarmid :    , where and .  (Unlike our Lemmas   and   that leave the constants and unknown, this result provides an exact constant .)  Comparing this with Lemmas   and   immediately yields the asymptotics of the probability for the uniform random -vertex -apex forest to be 2-connected:  The uniformly random -apex forest with vertices is 2-connected with probability satisfying where is defined as the smallest positive solution to the equation .  We remark that it is not straightforward to deduce Lemmas   and   from Theorem   using the typical number of leaves of a uniform random forest and the fact that a -apex forest can only be 2-connected if each leaf of its underlying forest is connected to at least one of the apex vertices: calculations show that the rate of decay of is not determined by the typical number of leaves of the uniform random forest with vertices (for the uniform random tree the number of leaves divided by converges in probability to , and this remains true for the uniform random forest), and is hence influenced by the ‘unlikely’ forests with much fewer leaves.">
</outline>
<outline text="Extension to all minor-closed families of graphs" _note="Looking back over the above proof, we observe that very little information about the family of planar graphs was actually used: we only used the fact that it is minor-closed (in the proof of Proposition  ), and that its exponential generating function has a non-zero radius of convergence (in the proof of Corollary  ). By a theorem of Norine, Seymour, Thomas and Wollan , every proper minor-closed family of graphs has the property that the number of labelled graphs in the family satisfies the inequality for some positive constant . Hence we can immediately extend Theorem   as follows.    Every proper minor-closed family of graphs is contained in a minor-closed, addable, subcritical family of graphs.  Analogous to the proof of Theorem  : consider the family of graphs whose blocks are either single edges, -connected graphs in , or -connected -apex forests, and take large enough so that (which is possible since as ). The resulting family will be minor-closed, addable, and subcritical.  In view of Theorem  , there is little hope to achieve a full characterisation of minor-closed subcritical graph classes in terms of their forbidden minors. However, as mentioned earlier, it is still plausible that the other direction of Noy’s conjecture holds, i.e. that every addable, minor-closed graph class with a forbidden planar minor is subcritical.">
</outline>
  </body>
</opml>