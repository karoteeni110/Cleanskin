<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>STARIMA-based Traffic Prediction with Time-varying Lags</title>
    <abstract>Based on the observation that the correlation between observed traffic
at two measurement points or traffic stations may be time-varying,
attributable to the time-varying speed which subsequently causes
variations in the time required to travel between the two points, in
this paper, we develop a modified Space-Time Autoregressive Integrated
Moving Average (STARIMA) model with time-varying lags for short-term
traffic flow prediction. Particularly, the temporal lags in the modified
STARIMA change with the time-varying speed at different time of the day
or equivalently change with the (time-varying) time required to travel
between two measurement points. Firstly, a technique is developed to
evaluate the temporal lag in the STARIMA model, where the temporal lag
is formulated as a function of the spatial lag (spatial distance) and
the average speed. Secondly, an unsupervised classification algorithm
based on ISODATA algorithm is designed to classify different time
periods of the day according to the variation of the speed. The
classification helps to determine the appropriate time lag to use in the
STARIMA model. Finally, a STARIMA-based model with time-varying lags is
developed for short-term traffic prediction. Experimental results using
real traffic data show that the developed STARIMA-based model with
time-varying lags has superior accuracy compared with its counterpart
developed using the traditional cross-correlation function and without
employing time-varying lags. </abstract>
  </head>
  <body>
<outline text="Introduction[sec:introduction]" _note="Road traffic prediction plays an important role in intelligent transport systems by providing the required real-time information for traffic management and congestion control, as well as the long-term traffic trend for transport infrastructure planning . Road traffic predictions can be broadly classified into short-term traffic predictions and long-term traffic forecasts. Short-term prediction is essential for the development of efficient traffic management and control systems, while long-term prediction is mainly useful for road design and transport infrastructure planning.  There are two major categories of techniques for road traffic prediction: those based on non-parametric models and those based on parametric models. Non-parametric model based techniques, such as k-nearest neighbors (KNN) model and Artificial Neural Networks (ANN) , are inherently robust and valid under very weak assumptions , while parametric model based techniques, such as auto-regressive integrated moving average (ARIMA) model and its variants , allows to integrate knowledge of the underlying traffic process in the form of traffic models that can then be used for traffic prediction. Both categories of techniques have been widely used and in this paper, we consider parametric model based techniques, particularly STARIMA (Space-Time Autoregressive Integrated Moving Average)-based techniques.  As for the estimation of parameters and coefficients in STARIMA model, overfitting easily occurs which makes the predictive performance poor as it overreacts to minor fluctuations in the training data . Furthermore, the same model and hence the same correlation structure is used for traffic prediction at different time of the day, which is counter-intuitive and may not be accurate. To elaborate, consider an artificial example of two traffic stations and on a highway, where traffic station is at the down stream direction of . Intuitively, the correlation between the traffic observed at and the traffic observed at will peak at a time lag corresponding to the time required to travel from to because at that time lag, the (approximately) same set of vehicles that have passed now have reached . Obviously, the time required to travel from to depends on the traffic speed, which varies with the time of the day, e.g. peak hours and off-peak hours. Accordingly, the time lag corresponding to the peak correlation between the traffic at and the traffic at should also vary with time of the day and, to be more specific, should approximately equal to the distance between and divided by the mean speed of vehicles between and . Therefore, in designing the STARIMA model for traffic prediction, the aforementioned time-varying lags should be taken into account for accurate traffic prediction.  To validate the aforementioned intuition, we analyze the cross-correlation function (CCF) of traffic flow data at two traffic stations (stations 6 and 3), denoted as , from I-80 highway (more details of data are discussed in Section  ) with the formulation :  where and are the traffic flow data collected in time slots from the two traffic stations, is the temporal order in the range of , and are respectively the standard deviation of and . A higher value of CCF indicates a stronger correlation of the traffic at both stations. As shown in Fig. , the correlation between traffic at stations 6 and 3 peaks at different time lags depending on the time of the day. During on-peak period (approximately from 6:30am - 8:30am), the correlation peaks at a time lag of (one time lag corresponds to ) while during off-peak period (approximately from 19pm - 24pm), the correlation peaks at a time lag of , where one time lag corresponds to a time of 30. We observe that at peak hours, the time lag corresponding to the maximum correlation is larger than that for off-peak hours. In the latter section, we will further show that this time lag approximately equals to the distance between the two traffic stations divided by the average speed. Therefore, our intuition explained in the previous paragraph is valid.  The above observation motivates us to design a STARIMA-based traffic prediction with time-varying lags which better matches the time-varying correlation structure between traffic of different stations and hence can potentially deliver more accurate traffic prediction. More specifically, the contributions of the paper are:  We analyze the CCF between the speed and traffic flow data between different detector stations and establish the relationship between the changes in the temporal lag (corresponding to the aforementioned maximum correlation) and the speed variations.  An unsupervised classification algorithm based on ISODATA algorithm is designed to classify different time periods of the day according to the variation of the speed. The classification helps to determine the appropriate time lag to use in the STARIMA model.  A STARIMA-based model with time-varying lags is developed for short-term traffic prediction. Experimental results using real traffic data show that the developed STARIMA-based model with time-varying lags has superior accuracy compared with its counterpart developed using the traditional cross-correlation function and without employing time-varying lags.  The the rest of the paper is organized as follows. In Section  , we briefly discuss related work. Section   introduces the STARIMA model and the ISODATA algorithm In Section  , we present the details the proposed algorithm. The experimental results are presented in Section  . Finally, Section   concludes the paper.">
</outline>
<outline text="Related Work[sec:related_work]" _note="There is previous work, which predicts traffic flow using a modified ARIMA models . In and , a multivariate ARIMA based model, ARIMAX, was applied for better traffic flow prediction. The difference is that the former paper considered the varibility of the speed from upstream to downstream, the other one considered different model specifications during different time periods of the day. Similarly, the authors in also different configurations of temporal lags in ARIMA model. More concretely, they firstly applied a hidden Markov model (HMM) model along with an expectation-maximization (EM) algorithm to evaluate the traffic state (one of {Major Accident, Minor Incident, Instability, Normal Driving}) in next time slot. After that, the ARIMA models with different configurations of temporal lags were used to predict the state of the traffic flow. All these models have improved the accuracy of the forecasting results compared with ARIMA model. However, the spatial information was less considered in these models. In this way, the STARIMA based models have aroused more and more concern.  In , the authors proposed a dynamic STARIMA model by combining the dynamic turn ratio prediction (DTRP) model and the STARIMA model. In this paper, a dynamic space weigh matrix is used to capture different impact of traffic at upstream locations on traffic at downstream locations. Similarly, the research in also applied the STARIMA model with the consideration of the dynamic space weight matrix. Our work distinguish from theirs in that in our work, the space weight matrices vary with on-peak and off-peak periods to capture the time-varying correlations of road traffic at different locations.  From the above related work, we can find that the &quot;\`‘dynamic’’ of a ARIMA or STARIMA model in existing research is often used to indicate the dynamic of the space weight matrix, the traffic state during different time periods . However, sometimes it is not enough to only consider these aspects. For example, Fig.  presents the normalized average speed and normalized flow data collected at traffic station 6 every 30 minutes in one day. Theoretically, the weight matrix in time slot 3 (or 4, the left hollow rectangle) and slot 15 (the right hollow rectangle) should be different since they are respectively in the off-peak period and peak period. However, their average speed are the same. This is caused by an inaccurate evaluation of the time range of peak or off-peak period. Furthermore, few research considered the relationship between speed and the parameters (temporal or spatial lag) in STARIMA model. Specially, a great majority of research use PACF to evaluate temporal lag which easily causes overfitting problem. Motivated by the above observations, in this paper we investigate a more efficient method to evaluate these parameters in STARIMA model with the consideration of spatial information and the variation of average speed during different time periods.">
</outline>
<outline text="Data Collection [sec:data_method]" _note="   In urban environment, the road structure is often complex. Also, the sensors (such as loop detectors or cameras) are not deployed at every road. Therefore, it is difficult to obtain comprehensive data. For simplicity, we only consider highway in this paper where there are only on-ramp/off-ramps so the traffic condition is comparatively simpler than that in the urban area. We use data collected from a segment of Interstate 80 (I-80) freeway located in Emeryville, California . Available data are collected every 30 seconds from six traffic stations numbered by 1, 3, 4, 5, 6 and 7 within 10 days. There are two traffic stations for upstream and downstream traffic respectively. The road topology is shown in Fig. . Note that there is no data at station 2 and there are too many interference caused by on or off-ramps at station 1 and 7. For simplicity, we only use the data collected at stations 3, 4, 5, and 6. The travel direction is from station 3 to 6.">
</outline>
<outline text="STARIMA Model with Dynamic Temporal Lag[sec:starima_time_lag_variation]" _note="In this section, we first present a simple way to evaluate the temporal lag in relation to speed variation. Then we propose a classification algorithm based on ISODATA by which we can respectively obtain a set of speed clusters and a set of time period clusters. Finally, we describe a modified STARIMA model with the varying temporal lag.">
  <outline text="Temporal Lag with Variation of Speed[sub:temporal_lag_variation_speed]" _note="From Fig. , the temporal lags with maximal CCF between stations 6 and 3 are different during peak and off-peak periods. This is attributable to the variation of speed. Assuming the distance between two detector stations and is , and the vehicles keep a stable average speed , then approximately is needed for vehicles to travel from to . In other words, the traffic flow collected at station is strongly correlated with that at time ago. Thus the temporal lag with the maximum correlation should be where is the length of one temporal lag. Note that depend on the spatial order in the STARIMA model and can often be measured by loop detectors . Furthermore, the advance in telecommunication and electronic technology also brings a number of new techniques that allows us to estimate the travel time, e.g. via smartphones. Indeed, the observation discussed in the Introduction section suggests another novel way to estimate travel time: we can infer travel time from the correlation of the observed traffic.  In order to validate the above discussion, we further analyze the results in Fig.  by using the f average speed information at stations 3 and 6, which is collected in the same day as the traffic flow data used in Fig. . Specifically, the average speed from station 3 to station 6 between 6:30 am and 8:30 am is 44.45 feet/second. The average speed is 67.05 feet/second between 19 pm and 24 pm. The maximal temporal lag during these two time periods is respectively 3 and 2 with 30 seconds in each temporal lag. As , given and during two time periods along with the corresponding best temporal lag and , we are able to obtain the following equation according to the theoretical analysis above:  Substituting the data into formulation , it is easy to find . This result agrees with our theoretical analysis and verifies our speculation that temporal is a function of the variation of average speed in Section  .">
  </outline>
  <outline text="The Classification of Speed Data[sub:classification_speed]" _note="An easy way to classify speed data is by dividing into peak time and off-peak periods. After that, the temporal lag can be calculated using , where is the average speed in time period {peak, Off-peak}. However an empirical classification is often prone to error and inaccuracy. Recall the analysis in Section  , the evaluation of the average speed is sensitive to the time range selected for peak or off-peak period. It is obvious that the speed is not always fast even during off-peak period from Fig.  . Therefore, in this paper an ISODATA[^1] based speed data classification algorithm is developed to deliver an accurate classification. Using this algorithm, we firstly classify the speed data collected in each time slot into different clusters. After that, the time period clusters are confirmed based on the time slots contained in different speed clusters.  **Input:** , ,,,,, **Return:** , **ISODATA**(, ,,,,)     , and            Assuming there is a set of speed data in which is the speed in time slot . The purpose here is to confirm a set of speed clusters, denoted as , where with cluster center and . Based on , we can obtain another set of time period clusters, denoted as , in which . In addition, let be a set of continuous time slots, termed as a time range and defined as follows:  where is the number of time slots contained in , is a threshold defined as the minimal number of time slots included in a time period. The speed data classification algorithm is given in Algorithm  . In line  , the ISODATA algorithm is implemented to get speed clusters. The time period clusters are obtained from line   to  . It is worth mentioning that a decision is made to decide whether belongs to by comparing its capacity and threshold (from line   to  ). If does not belong to , line   and   are implemented to allocate each to other by the operation . is defined as the absolute difference between speed recorded in time slot and the average speed calculated during time period , which is presented in .  [^1]: More details about the process of ISODATA algorithm are available     in reference .">
  </outline>
  <outline text="Model[sub:modified_starima_model]" _note="According to the speed and time period clusters obtained from Section  , we propose a modified STARIMA model, denoted as . The definitions of parameters , and in this model are the same as the original STARIMA model, except that the temporal lag will vary with the spatial order and the average speed in different time periods. More precisely, given a time period , is defined as follows:  In  , is a vector in which each element represents the temporal lag between two station and with the spatial order . is calculated by where is the distance between these two stations and is the average speed in time period which is equal to . Note that when , the &quot;\`‘0th order neighbor’’ of a station is itself such that the temporal lag is evaluated with the PACF used in ARIMA.">
  </outline>
</outline>
<outline text="Experimental Validation[sec:results]" _note="Based on the data collection introduced in Section  , we utilize the speed and traffic flow data at stations 3, 4, 5 and 6. At each station, there are 2880 data recorded in one day and the length of one time slot is 30 seconds. In order to eliminate noise in the data, we make a &quot;\`‘smooth’’ operation by calculating the mean traffic flow every data points and regarding it as one data point. The experimental results are divided into two parts. In the first part, we provide the speed and time period clusters classified by our proposed algorithm. For the speed data , we choose . In the second part, we present the forecast results of traffic flow in different time periods and stations using model. We choose to calculate the mean traffic flow using original traffic flow data within 2 minutes.">
  <outline text="The Speed and Time Period Clusters[sub:speed_time_cluster]" _note="Firstly, the configuration of input parameters of algorithm is given in Table   in which the speed data is the results after the smooth operation on the speed data collected from four stations. With this setting, the smallest length of time range is 120 minutes. The speed and time period clusters classified by Algorithm   is presented in table  .  [&amp;gt;p[1.5cm]{}&amp;gt;p[5.5cm]{}]{} Clusters &amp; Values[\ ]{} Speed &amp; [\ ]{} &amp; [\ ]{} &amp; =[ ]{} [\ ]{} &amp; =[ ]{}[\ ]{}  There are two speed clusters in , in which is the cluster center whose value is 82.15 feet/s and is 34.33 feet/s. Based on the speed clusters, one day is divided into 2 clusters with in which includes 4 time ranges and includes 3 time ranges. According to such classification, we present the temporal lag calculated by (left part of &quot;\`‘/’’ in each column) and by the CCF (the right part of &quot;\`‘/’’ in each column) during the time range (6:30-10am) and (18:30-24pm) with the spatial lag . The results are shown in Table  . It reveals an encouraging result that the temporal lags evaluated by these two methods are the same with the exception of some parts of the results in day 2. In addition, comparing the temporal lags evaluated upon different spatial lags, we can find that the temporal lags during peak and off-peak periods are the same when ( and ). This is because the temporal lag is less affected by the speed if two stations are very close.">
  </outline>
  <outline text="Results of Traffic Flow Prediction" _note="We choose the traffic flow data in day 3. After the smooth operation, we predict the traffic flow in one hour (30 time slots), and other data during each time range are used for training model (for simplicity, denoted as ). The settings are the same when using ARIMA and Chaos theory based model (abbreviated as Chaos) . The performance of the forecast is measured by the mean square error (MSE) and the mean absolute percentage error (MAPE).  We provide the MAPE/MSE of four stations using our proposed model in Table  . Combining with Fig.  , we can see that the forecast results are inspiring. Especially, the MAPE of station 4, 5 and 6 are all below 9% except (10am-15pm), which is attributable to the frequent fluctuation of traffic flow during this time range as shown Fig.  . As the minimal time range based on the configuration of is 120 minutes, it did not capture such frequent fluctuation. In addiction, the MAPE/MSE of station 3 are higher than other stations because none neighbors are considered in this paper at this station such that the . In this way, our model is actually similar with a ARIMA model.  In Table  , we compare the MAPE/MSE of one day using , Chaos and at four stations. Except station 3, all the MAPE/MSE achieved by our model are better than those of the other two models. Furthermore, in Table  , we present the MAPE/MSE of the forecast results of station 6 using these three models, in which the forecast time ranges are 9-10am and 23-24pm. It can be seen that the performance of our model is almost coincident with the true data. And Chaos comes to the second in the prediction during 23-24pm.">
  </outline>
</outline>
<outline text="Conclusions[sec:conclusion]" _note="Motivated by the observation that the correlation between traffic at different traffic stations is time-varying and the time lag corresponding to the maximum correlation approximately equals to the distance between two traffic stations divided by the speed of vehicles between them, in this paper, we developed a modified STARIMA model with time-varying lags for short-term traffic flow prediction. Experimental results using real traffic data collected on a highway showed that the developed STARIMA-based model with time-varying lags has superior accuracy compared with its counterpart developed using the traditional cross-correlation function and without employing time-varying lags. In an urban environment, the correlation between traffic tends to be much more intricate. It is part of our future work plan to develop prediction technique for urban roads that incorporates the knowledge of the underlying road topology.  [10]{}  [\#1]{} url@samestyle  [\#2]{}  [[ l@\#1 =l@\#1 \#2]{}]{}  P. Dell’Acqua, F. Bellotti, R. Berta, and A. De Gloria, &quot;Time-aware multivariate nearest neighbor regression methods for traffic flow prediction,” IEEE TRANS. INTELLIGENT TRANSPORTATION SYSTEMS, vol. 16, no. 6, pp. 3393–3402, 2015.  Y.-J. Kim, J.-s. Hong ET AL., &quot;Urban traffic flow prediction system using a multifactor pattern recognition model,” IEEE TRANS. INTELLIGENT TRANSPORTATION SYSTEMS, vol. 16, no. 5, pp. 2744–2755, 2015.  E. I. Vlahogianni, M. G. Karlaftis, and J. C. Golias, &quot;Short-term traffic forecasting: Where we are and where we’re going,” TRANSPORTATION RESEARCH PART C: EMERGING TECHNOLOGIES, vol. 43, pp. 3–19, 2014.  G. Comert and A. Bezuglov, &quot;An online change-point-based model for traffic parameter prediction,” IEEE TRANS. INTELLIGENT TRANSPORTATION SYSTEMS, vol. 14, no. 3, pp. 1360–1369, 2013.  M. Lippi, M. Bertini, and P. Frasconi, &quot;Short-term traffic flow forecasting: An experimental comparison of time-series analysis and supervised learning,” IEEE TRANS. INTELLIGENT TRANSPORTATION SYSTEMS, vol. 14, no. 2, pp. 871–882, 2013.  F. G. Habtemichael and M. Cetin, &quot;Short-term traffic flow rate forecasting based on identifying similar traffic patterns,” TRANSPORTATION RESEARCH PART C: EMERGING TECHNOLOGIES, 2015.  L. Song, &quot;Improved intelligent method for traffic flow prediction based on artificial neural networks and ant colony optimization.” JOURNAL OF CONVERGENCE INFORMATION TECHNOLOGY, vol. 7, no. 8, 2012.  B. L. Smith, B. M. Williams, and R. K. Oswald, &quot;Comparison of parametric and nonparametric models for traffic flow forecasting,” TRANSPORTATION RESEARCH PART C: EMERGING TECHNOLOGIES, vol. 10, no. 4, pp. 303–321, 2002.  X. Ge, S. Tu, T. Han, Q. Li, and G. Mao, &quot;Energy efficiency of small cell backhaul networks based on gauss–markov mobile models,” IET NETWORKS, vol. 4, no. 2, pp. 158–167, 2015.  D. Billings and J.-S. Yang, &quot;Application of the arima models to urban roadway travel time prediction-a case study,” in 2006 IEEE INT. CONF. SYSTEMS, MAN AND CYBERNETICS, vol. 3, pp. 2529–2534.  X. Min, J. Hu, Q. Chen, T. Zhang, and Y. Zhang, &quot;Short-term traffic flow forecasting of urban network based on dynamic starima model,” in 2009 IEEE INT. CONF. INTELLIGENT TRANSPORTATION SYSTEMS, pp. 1–6.  W. Min and L. Wynter, &quot;Real-time road traffic prediction with spatio-temporal correlations,” TRANSPORTATION RESEARCH PART C: EMERGING TECHNOLOGIES, vol. 19, no. 4, pp. 606–616, 2011.  B. Everitt, THE CAMBRIDGE DICTIONARY OF STATISTICS/BS EVERITT.1em plus 0.5em minus 0.4emCambridge University Press, Cambridge, UK New York:, 2002.  B. Williams, &quot;Multivariate vehicular traffic flow prediction: evaluation of arimax modeling,” JOURNAL OF THE TRANSPORTATION RESEARCH BOARD, no. 1776, pp. 194–200, 2001.  A. Stathopoulos and M. G. Karlaftis, &quot;A multivariate state space approach for urban traffic flow modeling and prediction,” TRANSPORTATION RESEARCH PART C: EMERGING TECHNOLOGIES, vol. 11, no. 2, pp. 121–135, 2003.  G. Mao and B. D. Anderson, &quot;Graph theoretic models and tools for the analysis of dynamic wireless multihop networks,” in 2009 IEEE WIRELESS COMMUNICATIONS AND NETWORKING CONFERENCE.1em plus 0.5em minus 0.4emIEEE, 2009, pp. 1–6.  R. Mao and G. Mao, &quot;Road traffic density estimation in vehicular networks,” in 2013 IEEE WIRELESS COMMUNICATIONS AND NETWORKING CONFERENCE (WCNC).1em plus 0.5em minus 0.4emIEEE, 2013, pp. 4653–4658.  A. A. Kannan, B. Fidan, and G. Mao, &quot;Robust distributed sensor network localization based on analysis of flip ambiguities,” in IEEE GLOBECOM 2008-2008 IEEE GLOBAL TELECOMMUNICATIONS CONFERENCE.1em plus 0.5em minus 0.4emIEEE, 2008, pp. 1–6.  G. Mao, B. D. Anderson, and B. Fidan, &quot;Online calibration of path loss exponent in wireless sensor networks,” in IEEE GLOBECOM 2006. 1em plus 0.5em minus 0.4emIEEE, 2006, pp. 1–6.  NGSIM, &quot;Next generation simulation,” &amp;lt;HTTP://NGSIM-COMMUNITY.ORG/&amp;gt;, 2010.  Y. Wang and N. Nihan, &quot;Freeway traffic speed estimation with single-loop outputs,” JOURNAL OF THE TRANSPORTATION RESEARCH BOARD, no. 1727, pp. 120–126, 2000.  G. H. Ball and D. J. Hall, &quot;Isodata, a novel method of data analysis and pattern classification,” DTIC Document, Tech. Rep., 1965.  W.-C. Hong, &quot;Application of seasonal svr with chaotic immune algorithm in traffic flow forecasting,” NEURAL COMPUTING AND APPLICATIONS, vol. 21, no. 3, pp. 583–593, 2012.">
</outline>
  </body>
</opml>