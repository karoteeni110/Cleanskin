<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>Poisson distribution for gaps between sums of two squares and level
spacings for toral point scatterers</title>
    <abstract>We investigate the level spacing distribution for the quantum spectrum
of the square billiard. Extending work of Connors–Keating, and
Smilansky, we formulate an analog of the Hardy–Littlewood prime -tuple
conjecture for sums of two squares, and show that it implies that the
spectral gaps, after removing degeneracies and rescaling, are Poisson
distributed. Consequently, by work of Rudnick and Ueberschär, the level
spacings of arithmetic toral point scatterers, in the weak coupling
limit, are also Poisson distributed. We also give numerical evidence for
the conjecture and its implications. </abstract>
  </head>
  <body>
<outline text="Introduction" _note="According to the Berry–Tabor conjecture , the energy levels for generic integrable systems should be Poisson distributed in the semiclassical limit. As noted by Connors and Keating , the square billiard, though integrable, is not generic: due to spectral degeneracies, the level spacing distribution tends to a -function at zero. However, if we remove the degeneracies and rescale so that the mean spacing is unity, numerics indicate Poisson spacings.  The energy levels of the square billiard, say with side length , are number theoretical in nature, and given by for . After removing degeneracies and rescaling, we are led to study the nearest neighbor spacing distribution  (as ), where denotes the th smallest element of the set (In our setting the leading order of the density of states is asymptotically equal to as  , and hence the spacing distribution of the unfolded levels has the same asymptotic distribution as the gaps in .)  This is the probability that, given , there is some integer such that where is the indicator function of .  If the positions of the levels , , were uncorrelated, this probability would be which, viewed as a Riemann sum approximation to the integral , would suggest that the nearest neighbor spacing distribution does indeed follow a Poisson law, i.e. that  If the positions of the levels , , were uncorrelated, this would indeed follow a Poisson law.  However, being sums of two squares, the levels are not uncorrelated.  For instance, four consecutive integers cannot all be in , since one of them is congruent to modulo .  Nevertheless, taking into account correlations modulo all prime powers, we still (conjecturally) expect to follow a Poisson law, consistent with numerics.  Rather than studying the spacing distribution directly, we shall proceed by investigating [UNORDERED]{} -tuples of elements in . Thus, given and with , consider the correlation function where denotes the indicator function of . If , this is the level density By a classical result of Landau , where is an explicitly given constant (see ). To formulate an analog of ( ) for we need some further notation. Given a prime , define (That the limit exists is shown in Section  , cf.  Propositions   and  .) Further, for and a set with , we define the [SINGULAR SERIES]{} for by with and as in . We note that for all , and that the product converges to a nonzero limit if for all (cf. Proposition  ). If for some , we define to be zero; it is easy to see that for all if .  We can now formulate an analog of the Hardy–Littlewood prime -tuple conjecture.    Fix , and a set with . If , then  Our main result, Theorem   below, is conditional on the hypothesis that holds on average. To be precise, let be defined by the relation Further, let be the region in defined by and, given and , let be the dilation of defined by Our hypothesis is that the error term is small when averaged over dilates of certain bounded convex subsets.  Fix an integer and a bounded convex set . Set or set . Let and be real parameters tending to infinity in such a way that . There exists a function , with as , such that for sufficiently large in terms of and , where in both summands.  Under the above hypothesis we find that the spacing distribution is indeed Poissonian. Moreover, the distribution of the number of points in intervals of size comparable to the mean spacing is consistent with that of a Poisson process. (We remark that our hypothesis can be weakened slightly — see Section  .)    Let and be real parameters tending to infinity in such a way that . Fix integers and , and fix . Assume that Hypothesis respectively, Hypothesis holds for all , and all bounded, convex sets . Then a respectively, b holds.  a We have  b We have  In , Rudnick and Ueberschär considered the spectrum of “toral point scatterers”, namely the Laplace operator, perturbed by a delta potential, on two dimensional tori. They showed that the level spacings of the perturbed eigenvalues, in the weak coupling limit, have the same distribution as the level spacings of the unperturbed eigenvalues (after removing multiplicities). An interesting consequence of Conjecture   (or ) is thus that the Berry–Tabor conjecture holds for toral point scatterers, in the weak coupling limit, for arithmetic tori of the form .  We remark that Gallagher proved the analog of Theorem   (b) for primes. Just as in his proof, a key technical result is that the singular series is of average order one, over certain geometric regions.    Fix an integer , and a bounded convex set . Set or set . As , we have where in the summand, and stands for volume in .  [**Acknowledgements.**]{} We thank Z. Rudnick for stimulating discussions on the subject matter, and D. Koukoulopoulos for his comments on an early version of the paper. T. F. was partially supported by a grant from the Göran Gustafsson Foundation for Research in Natural Sciences and Medicine. P. K. and L. R.  were partially supported by grants from the Göran Gustafsson Foundation for Research in Natural Sciences and Medicine, and the Swedish Research Council (621-2011-5498). L. R. wishes to thank and acknowledge the Mathematics department at KTH, being his home institute during the period where most of the work on this paper was done.">
</outline>
<outline text="Discussion" _note="Connors and Keating determined the singular series for shifted pairs of sums of two squares and gave a probabilistic derivation of Conjecture   for , and found that it matched numerics quite well (to within ). Smilansky then expressed the singular series for pairs as products of -adic densities, and showed that its mean value (over short intervals of shifts) is consistent with a Poisson distribution, and that the same is true for sums of two squares, on assuming a uniform version of Conjecture   for . He also determined the singular series for triples corresponding to the shifts . As already mentioned, the analog of Theorem   (b) for primes is due to Gallagher; in he showed that an appropriate form of the Hardy–Littlewood prime -tuples conjecture implies the prime analog of . (That it implies the prime analog of is mentioned in Hooley’s survey article .) To show that the singular series is one on average (i.e., the prime analog of Proposition  ), Gallagher uses combinatorial identities for Stirling numbers of the second kind. In , Kowalski developed an elegant probabilistic framework for evaluating averages of singular series. Rather than using combinatorial identities, he showed that a certain duality between -th moments of -tuples and -th moments of -tuples holds (cf. ). That the -th moment of -tuples equals one is essentially trivial; by duality he obtains the non-trivial consequence that first moments of -tuples also equals one. (Note that can be viewed as a first moment of -tuples when .)  Our approach originates with techniques developed in , and further refined in . Loosely speaking, the singular series is expanded into local factors of the form , and thus where and . Hence and the main term is given by . For large, can be shown to be small on average. For small, we use that (approximately) only depends on , together with complete cancellation when summing over the [FULL]{} set of residues modulo , i.e., . This follows, via the Chinese remainder theorem, from local cancellations , which in turn can be deduced from the following easily verifiable identity: given [ANY]{} subset , we have (cf. Lemma   (b) and its proof for more details):  However, unlike the setup in , where the local error terms are determined by , in the current setting the image of , for any fixed , is not sufficient to determine . On the other hand, the function has nice -adic regularity properties, allowing us to approximate by truncations such that only depends on , and for all . Apart from making the arguments more complicated, we also get a weaker error term: if only depended on , we would get a relative error of size , rather than . We also note that David, Koukoulopoulos and Smith , in studying statistics of elliptic curves, have developed quite general methods for finding asymptotics of weighted sums , provided that the local factors have -adic regularity properties similar to the ones above. In fact, Proposition  , though with a weaker error term, can be deduced from .  We finally remark that the corresponding question in the function field setting is better understood — Bary–Soroker and Fehm recently showed that the sums of squares analog of the -tuple conjecture holds in the large -limit for the function field setting (e.g., replacing by and by ).">
  <outline text="Evidence towards Conjecture [con:sotsktups]." _note="We begin by formulating a qualitative version of Conjecture  .    Fix , and a set with . If , then there exist infinitely many integers such that .  We remark that whether or not can be determined by a finite computation: this follows from Propositions   and  .  For recall that is -admissible if and only if for all . (See Propositions   and   et seq.) For we have by Propositions   (c) and   (c). For the finitely many dividing , we have if and only if either or, in the case , for , in the case , for . (See Propositions   (b) and   (b).)  Examples of sets for which are and : any translate of contains an integer congruent to modulo , and hence ; any translate of contains an integer congruent to or modulo , and hence .  It is possible to show that for [ANY]{} set containing at most three integers. The question of whether, for any , we have for infinitely many , was apparently raised by Littlewood: Hooley showed, using the theory of ternary quadratic forms, that Conjecture   indeed holds for . The conjecture remains open for .  For fixed and with , the upper bound can be deduced from Selberg’s sieve (see ), which is of the correct order of magnitude, according to Conjecture  . The special case is due to Rieger ; the special case is due to Cochrane and Dressler ; the general case is due to Nowak .  Lower bounds are more subtle. For , Hooley and Indlekofer showed that, for any nonzero integer , but we are not aware of any such bounds for .  We remark that Iwaniec deduced the asymptotic , as , from an analog of the Elliott–Halberstam conjecture for sums of two squares (cf. ). However, note that the leading term constant disagrees with the one due to Connors and Keating , namely . (We also obtain the constant ; see Figure   below for a numerical comparison.)">
  </outline>
  <outline text="Numerical evidence" _note="Using Propositions   (b), (c) and   (b), (c), we can give explicitly, as in the following examples. Let us first record that the constant in is the Landau–Ramanujan constant, given by It is straightforward to verify that If holds with then, by and , The agreement with numerics is quite good (to within ).  As the simplest example with , we verify that so Conjecture   implies that as . Here, the agreement between numerics and model is only to within .">
  </outline>
</outline>
<outline text="Motivating the probabilistic model" _note="It is elementary to show (see Section  ) that the first intersection being over all primes , and denoting that for some . It is also elementary to show that, for all , the asymptotic density exists, and is equal to which exists, and is nonzero if , by Propositions   (a) and   (a). Thus, is the probability that for all , and, regarding the probabilities of being contained in and as more or less independent for , we therefore expect that provided that the product converges to a nonzero number.    Fix , and a set with . The [SINGULAR SERIES]{} for is given by with and as in .  Proposition   (c) shows that, for sufficiently large primes , , and so the product in converges to a nonzero number unless for some . Proposition   shows that if and only if is -admissible.    Fix , and a set with . We say that is [-ADMISSIBLE]{} if, and only if, for all primes , there exists such that , where is as in .  In view of , for -admissible , is equivalent to and so we have the following qualitative version of Conjecture  .    Fix , and a set with . If is -admissible, then there exist infinitely many integers for which .  It is plain that, if is not -admissible, then there are no integers for which .">
</outline>
<outline text="Notation" _note="We define the set of natural numbers as . The letter stands for a prime, for an integer. We let stand for a generic element of , possibly a different element each time. Thus, for instance, denotes that for some . We view as a fixed natural number, and as a nonempty, finite set of integers, with unless otherwise indicated. We let . For , denotes the number of distinct prime divisors of , the -adic valuation of . (We also define .) That may also be denoted by . The radical of is , not to be confused with the squarefree part of , viz.  . By the least residue of an integer modulo we mean the integer such that and . When written in an exponent, is to be interpreted as the least residue of modulo : for instance, if is even.  We view as a real parameter tending to infinity. Expressions of the form denote that as . We also view as real parameter tending to infinity, typically in such a way that . We may assume that and are sufficiently large in terms of any fixed quantity. Expressions of the form , and all denote that , where is some positive constant, throughout the domain of the quantity . The constant is to be regarded as independent of any parameter unless indicated otherwise by subscripts, as in ( depends on only), ( depends on and only), etc. By we mean a quantity that tends to zero as .">
</outline>
<outline text="Deducing Theorem [thm:main] from Proposition [prop:sssa]" _note="Given such that , and , let where for we let . In the case where and , The following proof shows that Theorem   (a) and (b) hold under slightly weaker hypotheses than the ones stated: for (a), it is enough to assume that Hypothesis , where and , holds for all , and all satisfying ; for (b), it is enough to assume that Hypothesis holds for all .  As this argument has appeared many times in the literature, we merely give an outline of it and provide references. (a) To ease notation, we let , , , and Let be an integer, arbitrarily large but fixed. An inclusion-exclusion argument (see , or ) shows that the sums over , here and below, being over all for which . We make the substitution , with and in place of and ; we apply Hypothesis () for all and satisfying and ; we use Proposition  , and our assumption that , i.e. , as . Thus, we deduce from that and Since , the sums on the left and right of and are truncations of the Taylor series for . We have chosen arbitrarily large, so we may conclude that holds, provided Hypothesis () does whenever and . (b) We use an argument of Gallagher , who proved an analogous result for primes. Let be an integer, arbitrarily large but fixed. We have where denotes the number of maps from onto . Thus, with in the last summand. To sum over is to sum over (see ). If Hypothesis () holds then for some function with (), we have Applying Proposition   (noting that ), and our assumption that , i.e. , as , we see that if Hypothesis () holds for , then Gallagher’s calculation in shows that is the th moment of the Poisson distribution with parameter , and that the corresponding moment generating function is entire. Since a Poisson distribution is determined by its moments, it follows (see ) that for any given , holds as , provided Hypothesis () holds for all .">
</outline>
<outline text="Preliminaries" _note="A positive integer is a sum of two squares if and only if where denote nonnegative integers. (See .) In view of this and the next proposition, whose proof, being routine and elementary, is omitted, we have , where Further, as for primes , we may write .    Let . We have if and only if either or for some and . For , we have if and only if either or for some and . For , we have .  Let us introduce some notation in order to state further results. Given a nonempty, finite set , let Note that if , where , then two elements of occupy the same congruence class modulo , so . In other words, if then .  Let Note that contains at most one element, for if then , which by Proposition   holds only if . Similarly, if or , then . By Proposition  , for consists precisely of those elements of for which for every with . (Recall that denotes the -adic valuation of .) For instance, if then .  Given , let By Proposition  , this is the (possibly empty) set of least residues modulo such that, for each , there is some and such that . Finally, for , let This is the (possibly empty) set of least residues modulo such that, for each , there exists for which . Note that, for and odd , the difference between and is that contains only integers for which , whereas contains for which . As may be expected in view of Proposition  , we will need to treat as a special case throughout.  Recall from that , where We have introduced because it is more convenient than to work with. It is not difficult to see that, for , once is sufficiently large. (One may verify Proposition   by showing that if and only if for some and odd , and, for , that if and only if for some and .) Thus, the limit exists if and only if exists, in which case the two are equal.  In the next two propositions, and throughout, we allow for the possibility that . In case , we define to be zero (and ).    Let be a set of distinct integers. a The limits see and exist, and are equal: Moreover, for all , we have b For any , we have the right-hand side being constant for in this range. c If in which case , then . As a special case, we record here that .  In essence, we use a Hensel-type argument: for , the condition that can be lifted to , unless for some .  \(a) As already noted, to show that and the right-hand side of exist and are equal, it suffices to show that the right-hand side exists. Let and let , so , where and either or . Suppose that, for each , there exists and such that . Then, for each , and , where . Recalling Proposition   and definition , we see that the following statements are equivalent: (i) ; (ii) both and are in ; (iii) .  We have shown that we have a partition where is the set of elements of for which for some . Any element of is a least residue of for some , of which there are at most . We see that Consequently, for any with , we have It follows that the limit on the right-hand side of exists, and that holds for all .  \(b) Assume that . Suppose that, for some , there exists such that . We have if and only if , equivalently, . For we may write with and . Thus, is in if and only if , equivalently, . By definition of , this holds for each if and only if . We have shown that and for some if and only if is nonempty, is the (necessarily unique) element of , and . Thus, and . Also, . Hence   \(c) Suppose . If , i.e. if , then the elements of are precisely the least residues of and modulo . Also, . If , i.e. if , then either or . Without loss of generality, suppose . Then the sole element of is the least residue of modulo . Also, . Therefore, by (b), .  For the next proposition, recall that , when written in an exponent, denotes the least residue of modulo . For instance, if is even.    Let be a set of distinct integers, and let be a prime with . a The limits see and exist, and are equal: Moreover, for all , we have  b For any , we have the right-hand side being constant for in this range.  c We have with [**equality**]{} attained if in which case . As a special case, we record here that .  \(a) As noted above the statement of Proposition  , to show that and the right-hand side of exist and are equal, it suffices to show that the right-hand side exists. Let and let . Thus, , where and . Suppose that, for each , there exists and such that . Then, for each and each , , we have , where . Recalling Proposition   and definition , we see that the following are equivalent: (i) ; (ii) for ; (iii) .  We have shown that we have a partition where is the set of elements of for which for some . Plainly, is empty if is odd. (If then, by Proposition  , is even and hence not equal to any odd .) Also, any element of is a least residue of , for some and , of which there are at most . We see that and that with [EQUALITY]{} on the left if is [ODD]{}. Consequently, for any with , we have Since this last sum is equal to if is even, and to if is odd, we have It follows that the limit on the right-hand side of exists, and that holds for all .  \(b) Let , and assume now that . Suppose that, for some , we have for some . We have if and only if is even. Let . We may write with and . Thus, is in if and only if is even, equivalently, . By definition of , this holds for each if and only if . In that case, for with , we have and for ; if and only if , and . For , .  Thus, if , then is even and ; and if , then the for which is uniquely determined by and must lie in . If is even, then, writing , with , we see that Thus, if is odd, and if is even. Consequently, if is odd then while if is even then  \(c) Note that , so where is the number of distinct congruence classes in . Thus, if and only if . First, consider the case , i.e. . As , is trivial for , so let us assume that . The relation shows that for , and hence The right-hand side of is equal to when , as we are currently assuming. Next, consider the case , i.e. . In this case, we have and, by , which is equal to the right-hand side of (since ).  Notice that, for all , we have , by definition. By the following proposition, the nonvanishing of its singular series is equivalent to for all .  Consider . Suppose for some . By Proposition  , for each we have for some and . Let , and let be the least residue of modulo . Say . Then, for each , , and . Thus, by Proposition  , and . Hence . Since , by Proposition   (b).  Conversely, suppose . Then by Proposition   (b), either or , where . If then there is some , , such that and . If , we have such that for each . In the first case, take ; in the second case take . In either case, we have some such that .  Similarly, for some if and only if .    Let be a set of distinct integers. We have and the product converges. Consequently, [ ]{}  If then and by Proposition   (c), so only the primes have any bearing on the product in . Let , and suppose . By Proposition   (c), and Thus, , and consequently the product in converges.  More precisely, from we have, on the one hand, with equality attained if , which gives the upper bound in , and also the lower bound for . On the other hand we have For we see that the product in is at least , which is equal to (with being the Landau–Ramanujan constant; see ), and is greater than . For we apply the basic inequality () to the above, obtaining (since ). Noting that , and that , then exponentiating, we see that product in is greater than . The inequalities in follow upon recalling that for (see Proposition   (c)), and again that if (see Proposition   (c)).">
</outline>
<outline text="Proof of Proposition [prop:sssa]" _note="We will make use of the following elementary bounds. Recall that, for , , , and .    Let Fix any number . For and integers , we have and  Let and let . We claim that the following four bounds hold: and Let us deduce and . The left-hand side of is at most By and , the first double sum is By , and since , Combining gives . The left-hand side of is at most applying and gives .  We now prove our claim. For , we first consider the case . Note that because and Mertens’ theorem. Now, the inner sum being for and for . Thus, If then this last sum is ; otherwise, repeating the argument as many times as necessary gives It follows that, for any integer , For any integer , we trivially have , and hence Since and , this gives . The bound follows from and .  For , we use the following ancillary bound. We have uniformly for integers squarefree integers . To establish , we use an estimate involving smooth numbers: for , let denote the number of -smooth positive integers . The following can be found in : for , where (). Noting that we see that If then , and we are done. Let us assume, then, that . Let denote the prime divisors of , and let denote the smallest primes. Note that , i.e. note that . Since , we have by one of Chebyshev’s bounds for primes, so if , then is -smooth, where . Therefore, where the last bound follows, upon exponentiating, from . Combining and gives .  The left-hand side of is at most By and (note that when ), we have by (note that when ), and since we have Combining gives .  For , we note that since and , An argument similar to the one leading up to shows that, uniformly for , we have , and by . Combining gives .  To prove Proposition  , we express as a series. To this end, let us introduce some notation and establish some basic inequalities. Let a nonempty, finite set be given, and let . Recall that is defined (and nonempty when ) for , and for , is defined (and nonempty when ) for . Let us set and for completeness. For and , we may then define Note that by definition.    Let be a nonempty, finite set of integers, and let .  a For and [**even**]{} , we have .  b For , we have  c For and , we have  d For , we have For and , we have  \(a) Let and let . As can be seen from Proposition  , and part (c), we have For even we therefore have and as we noted following and , .  \(b) Consider (the case is similar). Let . Define and as the numbers given by the relations Note that by Proposition  , and part (c), and , with if . Also, (because ). Since , we have In the special case we can take . We therefore have   Writing , we have If then , and if then, as already noted, , i.e. , so in any case. Since, as already noted, , we have . Thus, For , the left-hand side is equal to (see ), so this gives .  \(c) Consider (the case is similar). Let . By (a) and (b), the result holds for and even, so we may assume that is odd. In that case, using in the definition of , we see that since, for any , and . We deduce, from and , that , which is in the case .  Now consider the case . Note that, by Proposition  , and part (c), we have, for any , In view of this and (the special case) , we have, for odd , Since , we have similarly, Combining gives , i.e. , for odd .  \(d) Consider (the case is similar). Let . We have because for even (by (a)), and the middle sum telescopes. Now, Proposition   (c) gives , and by definition of (see ), . With these substitutions, and , we verify that Now, , , , and as noted in (b), Proposition  , and part (c) show that . Combining gives .  For such that implies , we extend by defining For such , Lemma   (b) and (c) give provided is sufficiently large in terms of . Since by definition, and by Lemma   (a), if either or is even (and nonzero) for some . Letting , where is as in , we define Thus, and unless . By definition and Lemma   (d), the last sum being absolutely convergent in view of Lemma   and .  For the purposes of stating and proving the next lemma, we define [ ]{}  for , , and ; we then set for composed of primes . Thus, when .    Set , or set . Let be such that implies , and let be complete residue systems modulo . We have where in the summand. Note that we may have here.  Let , . Suppose and satisfy , and hence as well, for . For , it is clear from that for , and for as well. Thus, . Similarly, we have (see ). Therefore, by the Chinese remainder theorem, where in both summands, and . It therefore suffices to show that for all and .  Consider the case . For and , we have as can be seen by applying the definition of and changing the order of summation. For , each sum over on the right-hand side enumerates a translation of , so the entire sum (i.e. the left-hand side) is equal to . Whence  Since we similarly have Subtracting gives for . In a similar fashion, we obtain in the case . An analogous argument gives the same results for .  Applying the definition of and changing the order of summation yields  In the proof of Proposition  , we also make use of basic lattice point counting arguments, as in the final two lemmas below.    Let be as in . Set , or set . Fix an integer , and a number that depends on only. Also, fix . For , we have where in the summand.  Let . Let us first show that, for any squarefree integer , Let be pairwise distinct integers and suppose that divides . Then, since is squarefree, there exist pairwise coprime positive integers such that and , . Therefore, where on the right-hand side, the outermost sum is over all decompositions of as a product of positive integers, and .  Consider the decomposition . Let us define for . Notice that . By the Chinese remainder theorem, the condition on in the innermost sum above is equivalent to being in some congruence class modulo , uniquely determined by . The sum is therefore equal to . Iterating this argument times we see that the inner sum over is equal to The bound follows by combining and noting that, since is squarefree, the number of ways of writing as a product of positive integers is , and that .  For , with pairwise distinct, nonzero integers, and any , we trivially have . If as well, then implies . From this and , it follows that where in the summand on the left. Now, for we have , and . Applying these bounds to the left-hand side of , we see that it is where , here and below, denotes a sufficiently large number depending on , which may be a different number at each occurrence.  By definition of , for every , we have or for some , where is as in . Therefore, as a direct consequence of Lemma  , we have More specifically, for every , we have or for some uniquely determined , where is squarefree and . Furthermore, is not exactly divisible by , and so we have in the case , while in the case . In either case, we have the following: ; or ; and . Thus, if , then , where and . Consequently,  Now, as can be seen by writing and changing order of summation; also (See .) Next, note that since , Combining all of this gives Finally, we obtain by combining with and .    Fix an integer and a bounded convex set . For we have  This is a special case of .  Fix an integer and a bounded convex set , where (see ). Set or set . Let . To ease notation throughout, let , , and . Note that for . Also, let stand for a sufficiently large number depending on , which may be a different number at each occurrence.  In view of we see, upon partitioning the sum over and changing order of summation, that with as defined in . By Lemma  , we have By and Lemma  , we have  Consider the middle sum on the right-hand side of . Let be any element of with , and partition into cubes with running over . Each is a point in a unique cube of this form: we call a [-INTERIOR]{} point if this cube is entirely contained in , and a [-BOUNDARY]{} point if this cube has a nonempty intersection with the boundary of . We partition into -interior points and -boundary points. As runs over all -interior points of , () runs over a pairwise disjoint union of complete residue systems modulo , none of which contain . By Lemma   (we have for each ), it follows that  By , and the aforementioned trivial bound for , For each with , the proof of Lemma   (see ) shows that there are cubes that have a nonempty intersection with the boundary of . For each such boundary cube , the corresponding -boundary points are all in , which is a product of complete residue systems modulo , and, given that (and hence ), the condition is equivalent to when , .  If follows that, for with , and for , we have by . Whence since is at most . By , this last sum is . Combining, we obtain Combining with , , and gives .">
</outline>
<outline text="Some elementary verifications" _note="\(b) To ease notation, we let , , , , and Given , let Let be an integer, arbitrarily large but fixed. We claim that for any with , the inner sums (here and below) are over all such that . Now, where . Given with we have, with as in , Combining , and , then changing order of summation, we obtain   The substitution , with and in place of and , yields By applying Hypothesis () for all and satisfying and , Proposition  , and our assumption that as , it is straightforward to deduce from that where is some function, not necessarily the same as in , such that as . Consequently, and Since , the sums on the left and right of and are truncations of the Taylor series for . We have chosen arbitrarily large, so we may conclude that holds, provided Hypothesis () does whenever and .  It remains only to prove our claim . Let with be given. First of all note that, for any , For , let be the number of elements of in-between and , i.e.  for , where . From it is not difficult to see that, for any , where, as usual, for and for . Note that, given , these are [CONSECUTIVE]{} elements of , i.e.  , , for some , if and only if .  Next, for any integer and any nonnegative integers , we have To see this, note that each summand on the left-hand side is the number of ways of choosing objects from a set of size , in such a way that objects are chosen from a subset of size , and where is a partition. Summing over all partitions of into positive integers, we end up with the total number of ways to choose objects from , viz. the right-hand side. Also, the left-hand side being the binomial expansion of in the second case. Furthermore, for any nonnegative integers we have as can be verified by using the recurrence relation .  Combining , and we find, after changing order of summation, that where in the summand on the left-hand side, “consecutive” indicates summation restricted to those for which , , for some . Combining , and we similarly find that These are the claimed inequalities in , since  \(a) Trivially, for all . Let and . We have , and we claim that for all . By Brahmagupta’s identity, it follows that for all . We trivially have for . For , if then and either or   Next, suppose . Then for some and . We claim that if then . This holds trivially for . For , if then and, letting and , we see that .  \(b) Trivially, for all . Let and . We have , and we claim that for all . In view of Brahmagupta’s identity, it follows that for all . For note that since, by Euclid’s lemma, the sets both contain congruence classes, their intersection must be nonempty. Hence for some and . For , if then for some integer and, without loss of generality, (because ). In that case we have for some integer , and so .  Next, suppose . Then for some and . We claim that if then is even. Suppose for a contradiction that but is odd. Then and so, since is even (as ), . In view of Fermat’s little theorem we must have . Letting and , we see that . This gives a contradiction for , and for implies that .  \(c) We have for all by Fermat’s theorem on sums of two squares. If then by the argument in the first paragraph of (b).    Let . The set is -admissible.  If then is not a complete set of residues modulo , and by Proposition  , we have whenever for . For , note that the least residues modulo for which are and , and consider the set This consists of representatives of at most 21 distinct congruence classes modulo . Thus, there exist integers such that, for , we have meaning that or . By Proposition  , for such we have .  Finally, consider . By Proposition  , if and only if or with and . Equivalently, if and only if either or there is some such that , where and . Note that for , we have if and only if .  If there is some such that , then there is nothing more to prove, so assume this is not the case. This means that for each there is some such that with and . Without loss of generality, suppose . Then , so it must be that . Then , so it must be that . Then . We have: , , and where and . Suppose further, without loss of generality, that .  Consider the case (say). We have , and as , we must have . Thus, for any satisfying , we have and It follows that .  Now consider the case . We have . Since , we must have (say). Then , so in fact . In summary: , , and , where . If take satisfying ; if take satisfying ; if take satisfying . In each case we have .    Let be a set of integers, and assume that . Let . For we have  Let . We partition the sum in as follows: (For a given , if and , then , implying , so there is certainly no overlap between the last two sums.) By Proposition  , (for ) if and only if there exists and such that . Using this, we verify that on the right-hand side of , the condition on in the first sum holds if and only if for some in the (possibly empty) set Now, but the left-hand side here is also equal to Hence  In the second sum on the right-hand side of , we claim that the condition on holds if and only if the set is nonempty and for the (necessarily unique) in . Thus, To verify the claim, suppose that for some we have . By Proposition  , this is in if and only if . Now let , so that there exists and such that . Thus, is in if and only if , equivalently, . By definition of , this holds for each if and only if .  By the same argument, the condition on in the third sum on the right-hand side of holds if and only if for some , , and in the (possibly empty) set . Thus, Assume , and let be the integer such that . For any we have Since and since , we see that This also holds trivially if , so in any case we have  Combining with , and gives (This estimate also holds with in place of in the -term.) By Proposition   (b), , giving the main term in . For the -term, note that    Let be a set of integers, and assume that . Let , and let . For we have In the -term, may be replaced by if . Also, if then, in the -term, and may be replaced by and respectively.  By Proposition  , (for ) if and only if . Let . We partition the sum in as follows:  On the right-hand side of , the condition on in the first sum holds if and only if for some in the (possibly empty) set Now, but the left-hand side here is also equal to Hence  Consider the second sum on the right-hand side of . For a given , there is at most one in such that . Therefore, the condition on in the second sum holds if and only if and for some in the (possibly empty) set . Thus,  Assume , and let be the integer such that . For any we have Since and since , we see that This also holds trivially if , so in any case we have  Combining with and gives  We argue along the lines of the proof of Proposition  , ending up with which also holds with in place of in the -term. Proposition   (b) then gives the main term in . For the -term, note that and . If then the term with may be omitted.  To deal with the special case where , i.e.  , we note that and . Since we may take in place of in the -term above, where (see Proposition   (c)).    Let be a nonzero integer. We have and for we have Consequently, if , where , and for , and is composed only of primes congruent to modulo , then where is the Landau–Ramanujan constant see .  Let . Let , so that , say. If then , and if then , so in any case . First consider the case where , i.e.  . We have Since or , we verify that or respectively. Thus, and  Consider the case where , i.e.  . We have As or , we verify that , , or respectively. Thus, and  Next, consider the case where . Recall from Proposition   that in general, where . By definition, We claim that if and , then either or . For if with , then and or ( or ). Likewise, if and , then either or . Similarly, if and then , and likewise with and interchanged. If or , then if and only if .  In view of all of this, , and so Since , it follows that and in turn that  Let and let . If then , so and if and only if and . Therefore, If is odd, this accounts for all of . Also, . In that case we have If is even then there may exist such that . This holds if and only if . Writing (so that ), we have if and only if , where and .  Therefore, if is even then Also, . In that case we have as before.  Writing as in the statement of the proposition, we see that This last product is equal to (see ). The left-hand side is without the factor of .    Let be a set of distinct integers. For we have where is an absolute positive constant. In fact, the upper bound in holds for . For we have where and are absolute positive constants.  If then , so the estimates and are trivial in this case. Let us assume for the rest of the proof that .  If , then and (see Proposition   (c)), so only the primes have any bearing on the product in . Let . If then and, by Proposition   (c), Therefore, so we see that the upper bound in holds for any . Whether or not divides we have, by , For we therefore have (The last bound follows from the bound , , via partial summation.) Upon exponentiating, we obtain the lower bound in .  Next, for we have and , so The upper bound in follows upon exponentiating, after applying the bound , . For , we have, by , For we therefore have, similarly to , giving the lower bound in .  [33]{}  , 356(1686):375–394, 1977.  3rd edn. John Wiley &amp; Sons, New York, 1995.  49(4):301–304, 1987.  30(6):1817–1830, 1997.  , pp. 1–68, 2016.  23(1):4–9, 1976.  pp. 267–323 in [ALGORITHMIC NUMBER THEORY: LATTICES, NUMBER FIELDS, CURVES AND CRYPTOGRAPHY.]{} Eds. J. P. Buhler and P. Stevenhagen. Math. Sci. Res. Inst. Publ. Vol. 44. Cambridge University Press, Cambridge, 2008.  218(6):2013–2042, 2008.  Clarendon Press, Oxford, 1938.  90(5):355–364, 1965.  pp. 129–140 in [PROCEEDINGS OF THE SYMPOSIUM IN PURE MATHEMATICS OF THE AMERICAN MATHEMATICAL SOCIETY, HELD AT ST. LOUIS UNIVERSITY, ST. LOUIS, MO, MARCH 27–30, 1972.]{} Ed. H. G. Diamond. Proceedings of Symposia in Pure Mathematics, Vol. XXIV. Amer. Math. Soc., Providence, RI, 1973.  5(3):215–217, 1973.  267:207–218, 1974.  26(2):207–212, 1974.  29(1):69–95, 1976.  American Mathematical Society Colloquium Publications, Vol. 45. American Mathematical Society, Providence, RI, 1999.  148(2):153–187, 2011.  100(2):211–242, 1999.  , 120(A):205–224, 2000.  5(3):489–513, 2009.  13:305–312, 1908.  2nd edn.  Graduate Texts in Mathematics, Vol. 110. Springer–Verlag, New York, 1994.  77(91):71–78, 2005.  68:208–220, 1965.  15(1):1–27, 2014.  pp. 232–241 in [NUMBER THEORY DAY PROC. CONF., ROCKEFELLER UNIV., NEW YORK, 1976.]{} Lecture Notes In Mathematics, Vol. 626. Springer, Berlin, 1977.  9(7):1687–1711, 2013.">
</outline>
<outline text="Jetsam" _note="Sums of two squares are historically, perhaps, the most studied integers after the primes. (See Volume II, Chapter VI of Dickson’s [HISTORY OF THE THEORY OF NUMBERS]{} .) The special case of Brahmagupta’s identity, is implicit in Diophantus’ [ARITHMETICA]{}, and was also derived by Fibonacci (in his [LIBER QUADRATORUM]{}), Bachet, and doubtless many others. Fermat’s theorem on sums of two squares, which was anticipated by Girard and first completely proved by Euler, states that all primes are sums of two squares. Because sums of two squares are not congruent to modulo , we are led to the well-known characterization of nonzero sums of two squares as the integers whose canonical factorization is of the form  This is a starting point for a proof of Landau’s result . A refinement of Landau’s proof (see or )) shows that there exists a sequence of (explicitly given) numbers such that, for all , we have Unfortunately, are difficult to evaluate numerically. As stated by Shanks , “an unsolved problem of interest is to find   that could be computed without undue difficulty by a [CONVERGENT]{} process, and which would be accurate to for   ”. Apropos of this, a rare “mistake” of Ramanujan is often recounted (see , , or for instance).  Unaware of Landau’s work, Ramanujan claimed, in his very first correspondence with Hardy dated 1913 (see ), that where the “small error” is of order . After partial integration, Ramanujan’s claim would imply that in . However, it turns out that , as was shown by Shanks (by correcting earlier work of Hardy’s student Stanley ). Even so, Ramanujan’s incorrect estimate for is, as pointed out by Shanks , numerically a better approximation than (because is close to ). We mention this lest the numerical evidence in support of Conjectures   and   be not all that striking. Also, we are circumspect in making more exact conjectures as to the nature of the error term implicit in .  In general, sequences like the sequence of sums of two squares, which are “survivors” of a sieving process of positive dimension, are expected to have many properties in common with the sequence of primes. “Folklore” conjectures entail analogs of the Hardy–Littlewood prime -tuples conjecture for such sequences. Given the history outlined above, there is particular interest in the specific case of sums of two squares, yet it seems difficult to find an explicit formulation of a -tuples conjecture for sums of two squares in the literature.    For we have  Let , and let be the integer such that . By Proposition  , the positive integers in are precisely those of the form , where and . Thus, Since and , the result follows.    Let . For we have  First, suppose . By Proposition  , , so Now let , and let be the integer such that . By Proposition  , the positive integers in are precisely those for which for some . Thus, Since and since , we see that The result follows by combining the estimates for and .    Let be a set of integers with . If then  Let and suppose . Since , we have . Combining with and of Proposition  , we obtain from which follows.  Given a number and a set of primes , let If is the set of all primes less than or equal to some number , then is the number of -smooth numbers less than or equal to , denoted .    Let be any nonempty, finite subset of the primes that are not congruent to modulo . For , we have  We begin with two observations, which we will use in the course of the proof. First, let and be integers, and set . Let be any prime and suppose , so that . Recall from Proposition   that in the case where , we have while in the case where , we have Second, for (and any prime ) we have  we also have  Suppose , where and are distinct primes. Suppose further that , while either or (to be specified). If is any integer coprime with then, by our first observation,  Now let , and for let We have To estimate this last sum we apply the sieve of Eratosthenes–Legendre:  Combining and recalling that for , we obtain By repeating ( times) an argument that uses , we verify that  Given , let be the integer such that Below, the second equality follows from : Repeating this argument more times, we obtain  If then repeating the argument one more time leads to If , then by a similar argument that uses , we obtain  Assume now that . Let be the integer such that . By we have  Putting this into , we again obtain . In any case, putting into , we finally obtain As , we can disregard this sum in the above -term. We complete the proof by noting that is in one-to-one correspondence with the integers whose prime divisors all lie in , and so .    For we have  It suffices to establish the estimate for integral , so we assume for convenience that is an integer with . By Lemma  , we have For any prime and integers and , depends only on , i.e. . Using this, our assumption that is an integer, and partial summation, we verify that (In fact this holds for any integer and any set of primes .)  Let be any number with , and let be any set of primes. In what follows, to ease notation we we set We have where the last equality is obtained by partial summation. Note that if is an integer, then in the third equality we can replace by , eliminating the two subsequent -terms.  Applying Proposition   to the integrand, we see that  [ ]{}  As is far greater than , the bound will suffice for this product. By the prime number theorem for arithmetic progressions, we have so it follows that .  Since , and since the bound holds uniformly for (see ), we have  For a constant we have  Combining the last two bounds, we see that  Indeed, and .  Combining , and gives the result.">
</outline>
<outline text="Proposition [prop:sssa] with a weaker error term, and a proof" _note="  Fix an integer and a bounded convex set . Set or set . For we have where in the summand and stands for volume in .  The proof of Proposition   involves a basic lattice point counting argument. Lemma   is a special case of .    Fix an integer and a bounded convex set . For we have  To prove Proposition  , we express as a series. To this end, for a nonempty, finite set with , let for integers in the set Note that and by convention. For we have, since and , that . Since implies , i.e.  , we have for such , where denotes, here and throughout Section  , a sufficiently large (not necessarily optimal) number depending on — possibly a different number each time. Inequality also holds for , for in that case Proposition   (c) gives , and hence Note that trivially holds for . Thus, for all . Finally, notice (recall Definition  ) that The sum converges absolutely in view of and the following elementary bound, which we will also use in the proof of Proposition  . Recall that for , and .    Fix any number satisfying . For we have, uniformly for nonzero integers , the bound where denotes summation restricted to squarefree integers.  Let . We first consider the case . Note that because and by one of Mertens’ theorems. Now, the inner sum being for and for . Thus, If then this last sum is ; otherwise, repeating the argument as many times as necessary gives It is straightforward to deduce from this that for any nonzero integer , Letting be any nonzero integer, we trivially have , hence    Fix an integer , and a squarefree integer . For we have  Let be pairwise distinct integers and suppose divides . Then, since is squarefree, there exist pairwise coprime positive integers such that and , . Therefore, where on the right-hand side, the outermost sum is over all decompositions of as a product of positive integers, and .  Consider the decomposition . Let us define for . Notice that . By the Chinese remainder theorem, the condition on in the innermost sum above is equivalent to being in some congruence class modulo , uniquely determined by . The sum is therefore equal to . Iterating this argument times we see that the inner sum over is equal to The result follows by combining and noting that, since is squarefree, the number of ways of writing as a product of positive integers is , and that .  Before the final lemma, let us introduce one more piece of notation. For , and are nonempty. For integers , let and for , define Note that in the exponent we have the parameter , not . As one might expect, is a good approximation to when is large, and we can take advantage of quite strong cancellation in summing rather than .    a Set or set . Let be a sequence of positive integers with . Let be an integer, none of whose prime divisors are congruent to modulo , and let be complete residue systems modulo .  a We have where in the summand. Note that we may have here.  b Let be a set of integers that are not necessarily distinct. For and , we have and where is a sufficiently large quantity depending on . The bounds and also hold for , provided .  \(a) Let and satisfy for . If , it is clear from that , and hence . Similarly, we have (from ) that . Thus, by the Chinese remainder theorem, where in both summands, and . For we have as can be seen by applying the definition of and changing the order of summation. For , each sum over on the right-hand side enumerates a translation of , so the entire sum (i.e. the left-hand side) is equal to .  Since it follows that In a similar fashion we obtain  Similarly, which is equal to , and since it follows that as well.  An analogous argument gives the same results for ().  Applying the definition of and changing the order of summation yields Since , it follows that  \(b) Let and . Define and as the numbers given by the relations Note that by Proposition  , and part (c), and , with if . Also, (because ). Since and , we have In the special case we can take . We therefore have   Thus, writing , say, we have (Recall that we use to denote a sufficiently large number depending on .) If then , and if then, as already noted, , i.e. , so in any case. Since, as already noted, , we have , so we may write . Hence giving .  As can be seen from Proposition  , and part (c), we in fact have Letting so that , we see that [ ]{}  Now, , , (see above), and the term in brackets is at most , but of course if then it is at most . Hence .  The case for and with ( is similar.  To do...  Fix an integer and a bounded convex set , where (see ). Set or set . Let . To ease notation throughout, let , , and . Note that for . Now set . The estimate is trivial if , so we may assume that , and also that .  In view of we see, upon partitioning the sum over and changing order of summation, that Since we have, by Lemma  , that We show that the second and third sums make a negligible contribution to the right-hand side of .  Recall that conveniently stands for a sufficiently large (not necessarily optimal) number depending on (or more precisely, in this proof, on ), possibly a different number in any two occurrences. By and the trivial bound , we have If then , and if then , even in the case where is empty, so Lemma   yields, for squarefree , (If and then all prime divisors of are ; if then ; if is squarefree then .) Recalling that denotes summation restricted to squarefree integers, we have as can be seen by writing and changing order of summation, and (see ). Combining and applying Lemma   (with ), we see that [ ]{}  (Recall that by definition contains only squarefree integers.)  For the sum in over , let be the sequence of integers satisfying for all . We claim that for with , we have for a suitable absolute constant . To see this, let , so that and . For , we have . For (i.e. ), and , hence . For (i.e. ), and , hence . Thus, if is squarefree and , then . If then . For squarefree we have . By the elementary bound we have for , where is a suitable absolute constant. Hence  Let us set to ease notation in what follows. Writing and developing the product, the sum in over becomes  We have hence  By Lemma   (b), , for squarefree and , we see, upon noting that , that . Similarly, applying Lemma   (b), , we obtain, for squarefree and , the bound . Furthermore, by the lower bound in , we have . Combining, we see that [ ]{}  (For the last inequality note that in the innermost sum, , , , then use the trivial bound .) We invoke Lemma   again, this time noting that if and , then ; also, (recall that is squarefree and the convention might denote different constants.) We find that [ ]{} so combining yields  Consider an arbitrary with . We set , and partition into cubes with running over . Each is a point in a unique cube of this form: we call a [-INTERIOR]{} point if this cube is entirely contained in , and a [-BOUNDARY]{} point if this cube has a nonempty intersection with the boundary of . We partition into -interior points and -boundary points. As runs over all -interior points of , () runs over a pairwise disjoint union of complete residue systems modulo . By Lemma   (a), it follows that  For each , we have, by , that . Since , this means that . From the proof of Lemma   (see ), one can see that there are cubes that have a nonempty intersection with the boundary of , and there are at most points of in each such cube. Hence, in all, there are -boundary points . In view of this and Lemma   (b), , we see that (Here we have again used the elementary bound .)  Combining , and , we obtain Putting , and into , and recalling that , we obtain .">
</outline>
  </body>
</opml>