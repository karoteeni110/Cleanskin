<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>Second-order numerical methods for multi-term fractional differential
equations: Smooth and non-smooth solutions [^1]

[^1]: This work was supported by the MURI/ARO on “Fractional PDEs for
    Conservation Laws and Beyond: Theory, Numerics and Applications
    (W911NF-15-1-0562)”, and also by NSF (DMS 1216437). The second
    author of this work was also partially supported by a start-up fund
    from WPI.</title>
    <abstract>Starting with the asymptotic expansion of the error equation of the
shifted Grünwald–Letnikov formula, we derive a new modified weighted
shifted Grünwald–Letnikov (WSGL) formula by introducing appropriate
correction terms. We then apply one special case of the modified WSGL
formula to solve multi-term fractional ordinary and partial differential
equations, and we prove the linear stability and second-order
convergence for both smooth and non-smooth solutions. We show
theoretically and numerically that numerical solutions up to certain
accuracy can be obtained with only a few correction terms. Moreover, the
correction terms can be tuned according to the fractional derivative
orders without explicitly knowing the analytical solutions. Numerical
simulations verify the theoretical results and demonstrate that the new
formula leads to better performance compared to other known numerical
approximations with similar resolution. </abstract>
  </head>
  <body>
<outline text="Introduction" _note="The aim of this work is to provide an effective numerical method to solve multi-term fractional differential equations (FDEs), where more than one fractional differential operator is involved, with high-order accuracy for both smooth and non-smooth solutions.  Multi-term FDEs are motivated by their flexibility to describe complex multi-rate physical processes, see e.g. . Moreover, it is not straightforward to extend the known numerical methods for single-term FDEs to solve multi-term FDEs. Specifically, we find that: (i) Some numerical methods for single-term FDEs can be extended to multi-term FDEs, but their numerical stability and convergence analysis are not easy to prove; (ii) Very low accurate numerical solutions may be obtained by extending the majority of the known numerical methods for single-term FDEs to multi-term FDEs due to their often unreasonable requirement on the high regularity of the solutions.  Existing numerical methods for FDEs can be broadly divided into two classes.  [FDES WITH SMOOTH SOLUTIONS]{}: The majority of numerical methods have been developed for single-term FDEs with smooth solutions, in which the fractional derivative operators in these equations are discretized by the (shifted) Grünwald–Letnikov (GL) formula , the L1 method and its modification , the weighted shifted Grünwald–Letnikov (WSGL) formulas , the (weighted) fractional central difference methods , the fractional linear multi-step methods , the spectral approximations , and so on . Some of these methods have been extended to solve multi-term FDEs with smooth solutions, such as the L1 method in time with spatial discretization by the finite difference method (see e.g. ) and finite element method (see e.g. ), the predictor-corrector method in time with finite difference methods in space , [and some others , just to name a few.]{}  [FDES WITH NON-SMOOTH SOLUTIONS]{}: Generally speaking, the analytical solutions to FDEs are not smooth in real applications. For example, even for smooth inputs, the solutions to FDEs usually have a weak singularity at the boundary, see e.g. . Therefore, the aforementioned numerical methods will produce numerical solutions of low accuracy when applied to solve these FDEs. In order to derive numerical schemes of uniformly high-order convergence for FDEs with non-smooth solutions, several approaches have been proposed:  -   Use nonuniform/refined grids in the discretization of the fractional     operators, see e.g. ). With a geometrically graded mesh, one can     adaptively resolve a weak singularity at the endpoint.  -   Separate the solution of the considered FDE into two parts of and ,     satisfying (see e.g. ). Then, a numerical scheme is designed such     that high accuracy is obtained for both and .  -   Use a non-polynomial (or singular) basis function to capture the     singularity of the solutions to FDEs (see e.g. ), such that a     high-order scheme is effective.  We also note that many numerical methods for FDEs may impose some unreasonable restrictions on the solutions. For example, the L1 method (see e.g. ) and the interpolation method (e.g. ) require that the solution of the considered FDE is sufficiently smooth such that the expected accuracy can be realized, but as we already stated solutions of FDEs are usually not smooth, see e.g. . The second-order WSGL formula (see, e.g. ) requires that the solution and its first (and/or second) derivative have vanishing values at the boundary; see also the corresponding works in . Consequently, the convergence rate of these methods can be low even if the solutions are sufficiently smooth. In particular, we show numerically that the second-order WSGL formula in does not exhibit global second-order accuracy for smooth solutions; see numerical results in Table  . The theoretical explanation can be found in Section 2.  To remove these restrictions, we will adopt the approach (b2) to solve multi-term FODEs and multi-term time-fractional anomalous diffusion equations with smooth and non-smooth solutions. We note that the analytical solutions of FODEs and time-fractional differential equations usually have the form where is a uniformly continuous function over the interval , and and is a positive integer, see e.g. . Moreover, , , are explicitly known, see e.g. . The WSGL formula in is indeed of second-order convergence for when ( is the fractional order) while it converges slowly for . This observation motivated us to apply the the idea of in (b2) to obtain desired high accuracy schemes. Specifically, we introduce some corrections terms into the WSGL formula so that the resulting modified WSGL formula is exact or highly accurate for while the second-order convergence for is maintained.  In order to obtain the desired numerical schemes, we first obtain the asymptotic expansions of the error equation of the shifted GL formula. With these asymptotic expansions, we derive a family of second-order WSGL formulas, including the second-order WSGL formula from . We then illustrate that this family of second-order formulas does not exhibit global second-order accuracy unless some restrictive conditions of vanishing boundary values of the first-order and/or second-order derivative operators are imposed. Subsequently, following Lubich’s approach, we recover the global second-order accuracy of the WSGL formula by adding proper correction terms to remove those restrictions.  According to , the correction terms are found using the so-called starting weights and values to make the resulting formula exact for low regularity terms in (see ). We need to solve a linear system to obtain the starting weights, whose coefficient matrix is an ill-conditioned exponential Vandermonde matrix. It has been pointed out in that the accuracy in solving the corresponding weights “may have serious adverse effects for the entire scheme” when is large. However, it is shown in that the accuracy of Lubich’s correction approach depends on the residual of the linear system for obtaining the starting weights, which was discussed in detail in . According to , the correction terms are found using the so-called starting weights to make the resulting formula exact for low regularity terms , in when and is the desired convergence order. Thus finding the correction terms requires to solve an ill-conditioned exponential Vandermonde matrix. It is remarked in that the accuracy in solving the corresponding weights “may have serious adverse effects for the entire scheme&quot; when is large and are very small. In , it is shown that that the starting weights can be also found to make the resulting formula accurate enough instead of being exact for low regularity terms. However, the exponential Vandermonde matrix is so ill-conditioned when is large and ’s are small. This leads to a conclusion in that the accuracy of Lubich’s correction approach depends on the residual of the linear system for starting weights, despite of its high-order convergence in theory.  Fortunately, the number of correction terms can be small and still obtain reasonable accuracy. In this paper, we show that several correction terms (less than ten) significantly improve accuracy, regardless of the regularity of the analytical solution. Since we are using a few corrections terms, the condition number of the exponential Vandermonde matrices is not too large and thus the linear system to derive the starting weights can be solved accurately with double precision. Moreover, even if the regularity indices (see ) are unknown and the “correction terms” do not match the singularity of the analytical solutions to considered FDEs, we can still obtain satisfactory accuracy, see Example   and numerical results in Section  . In particular, we present in Lemma   a detailed error estimate of the WSGL formula with correction terms, which explains why a few correction terms may lead to satisfactory accuracy.  We organize the paper as follows. In Section  , we obtain the asymptotic error equation of the shifted GL formula that leads to the second-order WSGL formula under mild conditions. We then show that the WSGL formula with correction terms can lead to better accuracy. In Section  , we apply one special case of the second-order WSGL formula with correction terms to multi-term FODEs and present the stability and convergence theory. We further extend the second-order WSGL formula with correction terms in Section   to the time discretization of the multi-term time-fractional diffusion-wave equation together with the spectral element method for spatial discretization. Numerical results for smooth and non-smooth solutions are included in Section  . All the proofs of our lemmas and theorems are presented in Section   before the conclusion in the last section. In the Appendix we include some computational details, additional proofs, and also more numerical results.">
</outline>
<outline text="Finite difference approximations for fractional derivatives" _note="In this section, we examine the asymptotic behavior of the error equation of the shifted GL formula, which leads to the error estimate of the WSGL formula . Following Lubich’s approach , we then introduce correction terms to recover the global second-order accuracy of the WSGL formula and obtain an error bound.  We first introduce definitions of fractional integrals and derivatives. The th-order Caputo derivative operator is defined where , is a positive integer. The fractional integral is given by The Riemann–Liouville fractional derivative operator is defined by where and is a positive integer. For and a uniformly continuous function , we have the following relation  Let be a time stepsize and be a positive integer with and ). The shifted GL formula (with shifts) reads (see e.g. ): where . We have the following error estimate for the formula , the proof of which can be found in Section  .    Let and be a real number. Then where is defined by , , is an integer, and is bounded by  Here and throughout the paper, the constant is independent of and .  From Lemma  , we can eliminate the term in by a linear combination of and , . Let Then we obtain the second-order WSGL formula in ,  Eq. is proved in to be of second-order convergence when , and its Fourier transform belongs to . However, these conditions are too restrictive since for with when . For example, when , the remainder term in is of the order of , which is not of second-order convergence globally as the accuracy is when . Consequently, when is applied to solve FDEs with even smooth solutions, we cannot expect a global second-order convergence unless [the solutions have vanishing first-order derivatives]{}. In particular, there is almost no accuracy at when . In practice, this large error near may lead to large accumulation of discretization errors and thus much larger error at the desired final time ; see accuracy tests of the formula in Fig.   of this section and numerical experiments in Section  .  To improve the accuracy near , we follow Lubich’s approach by adding correction terms to such that the resulting formula is indeed of second-order accuracy when is of the form . avoid the propagation of possible large errors caused near . we need a quadrature rule that is exact or at least of order two for , where depends on the problems to be solved. Specifically, we modify such that In , the starting weights are known at each time step as they can be determined by setting in for . Denote . Then the starting weights can be solved from the following linear system of equations, see e.g. ,  The linear system has an exponential Vandermonde type matrix that is ill-conditioned when is large . The large condition number of the matrix may lead to big roundoff errors of when computation is performed with double precision. For , we present the condition number of the system in Table  . Hereafter we choose in [^1] where the quadrature weights where ’s are defined by, see , In fact, satisfies , see .  From Table  , we observe that the condition number increases with and decreases with . However, for and ’s presented in Table  , we can still have some reasonable accuracy for the starting weights. In fact, the accuracy of is determined somehow by the residual of . This observation has been made in . We present the residual of the system in Table  , where the residual is computed by When and , the condition number is and the residual is , see Table  . In this case we can still obtain relatively high accuracy, see Figure  (a) in Example  .  In our numerical simulations of this work, we choose less than eight correction terms. It works surprisingly well with high accuracy even when is small. For example, in Figure  (a), we used six correction terms for , the accuracy for all is at the level of , which is two orders of magnitude lower than . Hence, we are motivated to consider the asymptotic behavior of in when , addressing the practical effect of correction terms.    Let and be a real number. Let be defined in , , . Then we have where and are positive constants bounded and independent of and .  Numerical results indicate that []{} in can be bounded by See the supplementary material.  From Lemmas   and  , we have a uniformly second-order approximation of when satisfies and , i.e., . In practice, especially with double precision computation, we take only small and thus may not hold. In this case, we may not have the global second-order accuracy, but we still observe accuracy improvement at and small errors far from due to the small coefficient in .  Next, we check the accuracy of the discrete operator in .    Use the formula with to numerically approximate . We consider two cases: **Case I:** , where we take , . **Case II:** , where we take .  [(a) .]{}  [ [(b)]{} .]{}  [(a) .]{}  [(b) .]{}  The purpose of this example is to show that a small number of correction terms is sufficient to yield relatively high accuracy whether has high regularity or not.  We first consider Case I. When [ IS SMALL]{}, the regularity of is low. In such a case, we add only several correction terms but obtain satisfactory accuracy, see Fig.   (a). The accuracy can be explained by the estimate in Lemma  , especially the factor in the error estimate. Despite the accuracy from , the factor is very small when is small and is large, see Table  . The small factor explains the high accuracy in Figs.   (a). When [ IS RELATIVELY LARGE]{}, we need only several terms to achieve second-order accuracy according to and Lemma  . In this case, the term is more pronounced than , see Table  . This effect is shown in Fig.   (b), where we observe that increasing the number of correction terms does not increase accuracy significantly except for , due to high regularity of .  For Case II, we choose so that we match more terms of the singularity in ; the pointwise errors are shown in Fig.  . We obtain better accuracy as the number of correction terms increases up to when we capture all the singularity of that leads to accuracy at the machine precision level.  the pointwise errors are two orders of magnitude smaller than , which suggests a small factor in the error estimate. This small factor estimated in Lemma as .  In conclusion, we find that only a few number of corrections are needed to obtain high accuracy even when has low regularity at . We also find that we do not have to match the singular terms in when choosing correction terms. In Section  , we will present numerical examples with some empirical guidelines to introduce correction terms where we do not know explicitly the singular terms in .  [^1]: We choose hereafter in this paper in .">
</outline>
<outline text="Application to multi-term FODEs" _note="In this section, we apply the formula to the discretization of multi-term FODEs of the form where , and . The existence, uniqueness, and regularity of solutions to are investigated in . If is smooth for or , are rational numbers (see e.g. ), then the solution to has the form  Using , we apply to that leads to where , is defined by , and are suitable positive integers. By , the truncation error in satisfies . Let be the approximate solution of . Then we derive the following fully discrete scheme for where and is from . Denote .  We need numerical values to proceed with the scheme. Here we solve the nonlinear system of using with , and we apply the Picard fixed-point iteration method. Other high-order methods for can be applied here too.  Next, we present the stability and convergence for , the proofs of which are given in Section  .    If , then the method is unconditionally stable.    Let be the solution to and be the solution to satisfying , where are constants and . Suppose that satisfies the Lipschitz condition in its second argument, are suitable positive constants satisfying . Then there exists a positive constant independent of and such that    Let . If in Theorem  , then we have for ,  Two special cases of Theorem   are presented below. If there is no correction terms, i.e., , then we have If and , then we have">
</outline>
<outline text="Application to time-fractional diffusion-wave equation" _note="In this section, we consider the following time-fractional diffusion-wave equation, see e.g. : where , . We apply the quadrature formula in time and spectral element method in space for the discretization of Eq. . We also present the rigorous stability and convergence analysis of the present numerical scheme, the proofs of which can be found in the supplementary material.  The key assumption here is that the analytical solution to satisfies the following form where . Indeed, when is smooth in time and is rational, the analytical solution of has the form as , see e.g. .">
  <outline text="Time discretization" _note="Denote , where satisfies . Then satisfies Hence, we derive from The main task in the following is to construct a second-order approximation for each differential operator in –, i.e., the first-order time derivative operator and the time-fractional derivative operator . For simplicity, we denote and From , we have , which yields Let . Then from and , we have where and the starting weights are chosen such that is exact for , which leads to Note that . We have from We can similarly obtain where and are chosen such that is exact for , which yields From , we can also choose such that where , .  Combining and , we have the following time discretization for From , the time discretization of Eq. is">
  </outline>
  <outline text="The fully discrete spectral element method" _note="Let us introduce some notations before presenting our fully discrete schemes. Let and be a positive integer. Let be a partition of the interval . Denote , is a positive integer, and  Denote as the polynomial space defined on the domain with degree no greater than . The approximation spaces are defined as follows:  The inner product and norm are defined by:  From –, we present the Legendre Galerkin spectral element method (LGSEM) for –: For and , we find , such that in which , is defined by , are suitable positive integers, satisfy , satisfy , and is the Legendre–Gauss–Lobatto interpolation operator defined by where are the Legendre–Gauss–Lobatto points on .  To get and for , we can let in – and solve the resulting system. We can also use other high-order methods in time to obtain and for .">
  </outline>
  <outline text="Stability and convergence" _note="This subsection presents the stability and convergence of the scheme –. We give the following stability result.    Suppose that and are solutions to –. If and , then there exists a positive constant independent of and such that  For the nonnegative integer , is the Sobolev space equipped with the norm and semi-norm defined by Next, we present the convergence analysis.    Suppose that and are positive integers with and is the solution to satisfying [, , for each ,]{} , and are the solutions to the scheme –, respectively, with . For fixed , , and . If , then for small enough , there exists a positive constant independent of and , such that  -10pt    If the analytical solution to is sufficiently smooth in time, then the convergence rate of – in time is by choosing and . For smooth solutions with , we also have: (i) if in –, then the convergence rate in time is ; (ii) if in –, then the convergence rate in time is for , for , or for at .  The methodology here can be readily extended to two-term time-fractional subdiffusion equation and more generalized multi-term time-fractional subdiffusion equations, see e.g. .">
  </outline>
</outline>
<outline text="Numerical examples" _note="In this section, we present some numerical simulations to verify our theoretical analysis presented in the previous sections.    Consider the following two-term FODE subject to the initial condition , and .  The analytical solution of is where is the Mittag–Leffler function defined by  To solve , we apply the method with and in computation. The maximum absolute error is measured by  First, we observe from Tables  –  that higher accuracy is obtained with correction terms () than that without correction terms (). For , compared with , we have gained one order of magnitude in the maximum error when and two orders of magnitude when , see Table  . For , we observe similar improvement in accuracy, see Table  . For the error at final time , we also have similar effects for and have even more significant improvement in accuracy, see Tables   and  . The convergence order for in the maximum sense is consistent with the theoretical prediction in Theorem  , which is , while a lower convergence rate is observed for .  From Tables   and  , we observe that much better accuracy is obtained far from . This phenomenon occurs in many time stepping methods for FDEs in literature, which can be also explained from the average error estimate , see Eq. . Clearly, the average error has smaller upper bound than the maximum error estimate , which implies much better numerical solutions far from , see the average errors in Table  .  Second, we find that a small number of corrections terms suffices to have high accuracy in both maximum error and the error at final time. According to Theorem  , we can get the global second-order accuracy when , i.e., for . Indeed, we observed second-order accuracy for and in Table  , and the accuracy is also much smaller than . When is small, i.e., , we need at least 19 correction terms to get the global second-order accuracy theoretically. Yet we obtain highly accurate numerical solutions using a small number of correction terms, see the case in Tables   and  , and the accuracy is smaller than in Table   for . Though accuracy is improved when the number of correction terms increases, we did not use more than terms since the starting weights in may suffer from round-off error when when computed with double precision. Though we did not observe a sharp second-order convergence in the presented tables, second-order accuracy can be observed if we use more than 19 correction terms with quadruple-precision in the computation (results not presented here).  Lastly, we show the case that is not taken as . In Tables  – , we present the maximum error and the error at of the method for and in . We do not exactly match the singularity of the solution but we still obtain satisfactory accuracy as the number of “correction terms” increases up to . The numerical results confirm the estimate , see also explanations in Example   in the previous section. We further illustrate this effect in our next example solving a nonlinear FODE where we don’t know the singularity of the solution.  In summary, we find that a smaller number of correction terms can lead to significant improvement in accuracy. When the regularity of the solution is relatively high (the fractional order is large here), we need only a few correction terms to achieve a global second-order convergence. When the regularity of the solutions is low (the fractional order is small here), we need also a few correction terms as the correction terms bring a small factor (see Lemma  ) that leads to high accuracy. Moreover, the correction terms can be chosen such that the approximation can be not exact for the singular terms of exact solutions.    Consider the following two-term nonlinear FODE subject to the initial condition , and .  Here we consider three cases: Case I: , ; Case II: , ; Case III: , .  In this example, we compare our method with the two well-known methods. Specifically, we first apply the L1 method to discretize the Caputo derivative in to derive the corresponding numerical scheme, which is called the L1 method, see . We also transform into its integral form as , and then we apply the trapezoidal rule to the fractional integrals to obtain the corresponding numerical scheme, which is called the trapezoidal rule method, see . Since we do not have the exact solution, we obtain a reference solution using the trapezoidal rule method with time step size . We also apply the L1 method with the step size to get a reference solution and obtain almost the same results (not presented here). In all computations, we use time step size unless otherwise stated.  Obviously we do not know the regularity of of Eq. but we can estimate the regularity from linear equations related to Eq. . Here we first investigate the regularity of the following equation The solution can be represented by a generalized Mittag–Leffler function and is of the form if . Meanwhile, we choose the correction terms that make in as small as possible if contains when is relatively small. Empirically, we choose that guarantees the decrease of with for . Consequently, for all cases, we choose as .  We show in Fig.   numerical solutions and pointwise errors of both our method with/without correction terms and the L1 method for Cases I and II. Adding correction terms greatly improves accuracy, although these “correction terms” may not match the singularity of the analytical solutions.  We further test choices of in Case III where fractional orders are small that usually lead to low regularity of . In addition to the choice of , we also choose in the computation. All these choices of yield smaller as increases when and . In this case, we choose in the computation that leads to . The pointwise errors are shown in Fig.  . We observe that numerical solutions with higher accuracy are obtained by properly choosing correction terms, which confirms Lemma  .  In conclusion, we again observed that a smaller number of correction terms leads to more accurate numerical solutions than those from formulas without correction terms. We also discussed how to choose based on some preliminary singularity analysis and error estimates in Lemma  .  [(a1) Case I.]{}  [(a2) Case I.]{}  [(b1) Case II.]{}  [(b2) Case II.]{}  [(a) .]{}  [(b) .]{}  [(c) .]{}  [(d) .]{}    Consider the following fractional diffusion-wave equation where and .  In this example, we consider two cases:  Case I (Smooth solutions): Choose a suitable source term such that the exact solution to is  Case II (Smooth inputs): The source term is , the initial conditions in are replaced by , and .  We use the LGSEM – to solve , where the domain is divided into three subdomains, i.e., , and .  In Table  , we present the errors at for Case I (smooth solution with in ). We choose and in the computation and observe that second-order accuracy is observed for and , which is in line with or even better than the theoretical analysis, see also Remark  . for , we do not obtain second-order accuracy, especially when is close to 1; see also the related numerical results in , [where second-order accuracy was lost without correction terms]{}.  For Case II, we do not have the explicit analytical solutions. It is known, see e.g. and , that the analytical solution of satisfies , where when . For simplicity, we choose in the computation. The benchmark solutions are obtained with smaller time step size . In Table  , we present the errors at and observe second-order accuracy. Moreover, we find that more accurate numerical solutions are obtained when increases, which is in line with our theoretical predictions.">
</outline>
<outline text="Proofs">
  <outline text="Proof of Lemma [lem:quad-accuracy]" _note="A special case of Lemma   with and being an integer can be found in . We present the proof here for completeness and for all .  For and , we have  By analyzing the proof of Lemma 3.5 in again, we can obtain which yields for . Now we prove for . From , we have By the fact that , we have From and , we reach , which completes the proof.">
  </outline>
  <outline text="Proof of Lemma [lem:quad-2]" _note="To prove Lemma  , we need the following lemma.    Let be a positive integer and be defined by . Suppose that are a sequence of strictly increasing positive numbers. Then we have  Letting and in , we derive Combining and yields a linear system which leads to . The proof is completed.  Proof of Lemma  .  We have from and , and satisfies (see Lemma  ) where is independent of , and , is independent of and , and . From Eqs. (3.1) and (3.13) in , we can readily obtain both and are analytical functions with respect to . Hence, and are bounded for a given . Next, we derive a bound for . Since , it implies , . It is known that is infinitely smooth with respect to and , there exists an , such that From the boundedness of , , and the following relation we have , which leads to  With the same reasoning, we can derive that also satisfies where is a positive integer and is independent of . From the estimates of and , we obtain the desired result. The proof is completed.">
  </outline>
  <outline text="Proofs of Theorems [thm3-2]–[theorem3-3]" _note="We first introduce a lemma.    Suppose that , , is real, and . If and , then there exists a positive constant independent of , such that .  From , we have and , which leads to . Since , there exist a positive constant independent of such that . With the mathematical induction method and , we complete the proof. Assume that there exists a positive constant independent of such that , . Next, we prove . From and the assumption, we have where we have used , , and for . The proof is completed.  From Lemma   and Lemma 3.3 in , one can derive the following corollary.    Assume that , , and is real. If and , then .">
    <outline text="Proof of Theorem [thm3-2]" _note="Following the similar idea in (see also ), we derive that the method is stable if , where is defined by , in which . Since for all and , the region contains the whole negative real line, i.e., the scheme is stable for any . This completes the proof.">
    </outline>
    <outline text="Proof of Theorem [thm3-1]" _note="Let . Then we derive the error equation of as where is defined in . By Lemma 3.4 in , Eq. can be written in the following form where , and and are, respectively, the coefficients of the Taylor expansions of the functions and  Assume that satisfies the uniform Lipschitz condition, i.e., there exists a positive constant such that . Hence, for small enough , we have where  It is known that with . It then follows from Corollary   that and . We can similarly obtain and . Hence, . Similar to the proof in , we derive . If satisfies the local Lipschitz condition with respect to , then we can also derive by the mathematical induction method, which is omitted here, see . This ends the proof.">
    </outline>
    <outline text="Proof of Theorem [theorem3-3]" _note="We first introduce a lemma.    Suppose that . Then we have where are real numbers and is defined by .  From , we have where is defined in .  Multiplying on both sides of and summing up from to , one has Applying Lemma   and the Cauchy–Schwarz inequality, we have where is a positive constant. If we choose , then we have Let . From , , and , we have Let . Then we have from the above equation which leads to . The proof is completed.">
    </outline>
  </outline>
</outline>
<outline text="Summary" _note="In this work, we obtained the asymptotic expansion of the error equation of the WSGL formula proposed in . The WSGL formula is second-order accurate far from but is not second-order accurate near . Hence second-order numerical scheme is not expected when the formula is applied to time-fractional differential equations. We then followed Lubich’s approach by adding the correction terms to the WSGL formula and obtained a modified formula with global second-order accuracy both around and far from . We applied our modified formula to solve two-term FODEs and two-term time-fractional anomalous diffusion equations and proved the stability and second-order convergence in time.  We found that only a small number of correction terms is needed to improve convergence order and accuracy regardless of regularity of the analytical solutions. We showed both theoretically and numerically that a few correction terms are sufficient to obtain relatively high accuracy at and thus improve the convergence order and accuracy far from . With a few correction terms, we avoid solving the linear system with an exponential Vandermonde matrix of large size to obtain starting weights. We observed that with no more than terms, the linear system can be accurately solved with double precision without harming the accuracy of the second-order formula. Moreover, the correction terms do not have to exactly match the singularity indexes of solutions to FDEs. Even when we do not know the precise singularity indices of solutions to FDEs, we provided some empirical guidelines to choose correction terms.  Although, we only focus on the WSGL formulas, the methodology proposed here can be also applied to recover globally high accuracy for some other high-order formulas, see e.g. , where the high-order accuracy requires vanishing initial/boundary values of the corresponding function, even vanishing values of higher-order derivatives at boundaries.  [10]{}  , [A [M]{}ATLAB TOOLBOX FOR POSITIVE FRACTIONAL TIME DERIVATIVE MODELING OF ARBITRARILY FREQUENCY-DEPENDENT VISCOSITY]{}, J. Vib. Control, 20 (2014), pp. 1009–1016.  , [SPECTRAL METHODS]{}, Scientific Computation, Springer-Verlag, Berlin, 2006. Fundamentals in single domains.  , [A HYBRID COLLOCATION METHOD FOR [V]{}OLTERRA INTEGRAL EQUATIONS WITH WEAKLY SINGULAR KERNELS]{}, SIAM J. Numer. Anal., 41 (2003), pp. 364–381 (electronic).  , [CRANK-[N]{}ICOLSON METHOD FOR THE FRACTIONAL DIFFUSION EQUATION WITH THE [R]{}IESZ FRACTIONAL DERIVATIVE]{}, J. Comput. Phys., 231 (2012), pp. 1743–1750.  , [A [F]{}OURIER METHOD FOR THE FRACTIONAL DIFFUSION EQUATION DESCRIBING SUB-DIFFUSION]{}, J. Comput. Phys., 227 (2007), pp. 886–897.  , [FOURTH ORDER ACCURATE SCHEME FOR THE SPACE FRACTIONAL DIFFUSION EQUATIONS]{}, SIAM J. Numer. Anal., 52 (2014), pp. 1418–1438.  , [GENERALIZED [J]{}ACOBI FUNCTIONS AND THEIR APPLICATIONS TO FRACTIONAL DIFFERENTIAL EQUATIONS]{}, Math. Comp., 2015, http://dx.doi.org/10.1090/mcom3035.  , [CONVOLUTION QUADRATURE TIME DISCRETIZATION OF FRACTIONAL DIFFUSION-WAVE EQUATIONS]{}, Math. Comp., 75 (2006), pp. 673–696 (electronic).  , [THE ANALYSIS OF FRACTIONAL DIFFERENTIAL EQUATIONS]{}, Springer-Verlag, Berlin, 2010.  , [PITFALLS IN FAST NUMERICAL SOLVERS FOR FRACTIONAL DIFFERENTIAL EQUATIONS]{}, J. Comput. Appl. Math., 186 (2006), pp. 482–503.  , [DETAILED ERROR ANALYSIS FOR A FRACTIONAL [A]{}DAMS METHOD]{}, Numer. Algorithms, 36 (2004), pp. 31–52.  , [HIGH-ORDER ALGORITHMS FOR [R]{}IESZ DERIVATIVE AND THEIR APPLICATIONS [(I)]{}]{}, Abstr. Appl. Anal., (2014), pp. Art. ID 653797, 17.  height 2pt depth -1.6pt width 23pt, [HIGH-ORDER ALGORITHMS FOR [R]{}IESZ DERIVATIVE AND THEIR APPLICATIONS ([II]{})]{}, J. Comput. Phys., 293 (2015), pp. 218–237.  , [NUMERICAL SOLUTION OF FRACTIONAL DIFFERENTIAL EQUATIONS WITH A COLLOCATION METHOD BASED ON [M]{}ÜNTZ POLYNOMIALS]{}, Comput. Math. Appl., 62 (2011), pp. 918–929.  , [SYSTEMS-BASED DECOMPOSITION SCHEMES FOR THE APPROXIMATE SOLUTION OF MULTI-TERM FRACTIONAL DIFFERENTIAL EQUATIONS]{}, J. Comput. Appl. Math., 229 (2009), pp. 282–391.  , [NONPOLYNOMIAL COLLOCATION APPROXIMATION OF SOLUTIONS TO FRACTIONAL DIFFERENTIAL EQUATIONS]{}, Fract. Calc. Appl. Anal., 16 (2013), pp. 874–891.  , [STABILITY AND CONVERGENCE OF FINITE DIFFERENCE SCHEMES FOR A CLASS OF TIME-FRACTIONAL SUB-DIFFUSION EQUATIONS BASED ON CERTAIN SUPERCONVERGENCE]{}, J. Comput. Phys., 280 (2015), pp. 510–528.  , [ANALYTICAL SOLUTIONS FOR THE MULTI-TERM TIME-FRACTIONAL DIFFUSION-WAVE/DIFFUSION EQUATIONS IN A FINITE DOMAIN]{}, Comput. Math. Appl., 64 (2012), pp. 3377–3388.  height 2pt depth -1.6pt width 23pt, [ANALYTICAL SOLUTIONS FOR THE MULTI-TERM TIME-SPACE [C]{}APUTO-[R]{}IESZ FRACTIONAL ADVECTION-DIFFUSION EQUATIONS ON A FINITE DOMAIN]{}, J. Math. Anal. Appl., 389 (2012), pp. 1117–1127.  , [THE [G]{}ALERKIN FINITE ELEMENT METHOD FOR A MULTI-TERM TIME-FRACTIONAL DIFFUSION EQUATION]{}, J. Comput. Phys., 281 (2015), pp. 825–843.  , [A FINITE ELEMENT METHOD WITH SINGULARITY RECONSTRUCTION FOR FRACTIONAL BOUNDARY VALUE PROBLEMS]{}, ESAIM: M2AN, 49 (2015), pp. 1261–1283.  , [THE FINITE DIFFERENCE METHODS FOR FRACTIONAL ORDINARY DIFFERENTIAL EQUATIONS]{}, Numer. Funct. Anal. Optim., 34 (2013), pp. 149–179.  , [INITIAL-BOUNDARY VALUE PROBLEMS FOR MULTI-TERM TIME-FRACTIONAL DIFFUSION EQUATIONS WITH POSITIVE CONSTANT COEFFCIENTS]{}, arXiv:1312.2112v2, (2014).  , [FINITE DIFFERENCE/SPECTRAL APPROXIMATIONS FOR THE TIME-FRACTIONAL DIFFUSION EQUATION]{}, J. Comput. Phys., 225 (2007), pp. 1533–1552.  , [ NUMERICAL METHODS FOR SOLVING THE MULTI-TERM TIME-FRACTIONAL WAVE-DIFFUSION EQUATION]{}, Fract. Calc. Appl. Anal., 16 (2013), pp. 9–25.  , [DISCRETIZED FRACTIONAL CALCULUS]{}, SIAM J. Math. Anal., 17 (1986), pp. 704–719.  height 2pt depth -1.6pt width 23pt, [A STABILITY ANALYSIS OF CONVOLUTION QUADRATURES FOR [A]{}BEL-[V]{}OLTERRA INTEGRAL EQUATIONS]{}, IMA J. Numer. Anal., 6 (1986), pp. 87–101.  , [INITIAL-BOUNDARY PROBLEMS FOR THE GENERALIZED MULTI-TERM TIME-FRACTIONAL DIFFUSION EQUATION]{}, J. Math. Anal. Appl., 374 (2011), pp. 538–548.  , [EFFICIENT SPECTRAL–[G]{}ALERKIN METHODS FOR FRACTIONAL PARTIAL DIFFERENTIAL EQUATIONS WITH VARIABLE COEFFICIENTS]{}, J. Comput. Phys., 307 (2016), pp. 243–261.  , [A SECOND-ORDER ACCURATE NUMERICAL METHOD FOR A FRACTIONAL WAVE EQUATION]{}, Numer. Math., 105 (2007), pp. 481–510.  , [FINITE DIFFERENCE APPROXIMATIONS FOR FRACTIONAL ADVECTION-DISPERSION FLOW EQUATIONS]{}, J. Comput. Appl. Math., 172 (2004), pp. 65–77.  , [SUPERCONVERGENCE OF A DISCONTINUOUS [G]{}ALERKIN METHOD FOR FRACTIONAL DIFFUSION AND WAVE EQUATIONS]{}, SIAM J. Numer. Anal., 51 (2013), pp. 491–515.  , [SPLINE COLLOCATION METHODS FOR LINEAR MULTI-TERM FRACTIONAL DIFFERENTIAL EQUATIONS]{}, J. Comput. Appl. Math., 236 (2011), pp. 167–176.  , [FRACTIONAL DIFFERENTIAL EQUATIONS]{}, Academic Press, Inc., San Diego, CA, 1999.  , [NUMERICAL APPROXIMATION OF PARTIAL DIFFERENTIAL EQUATIONS]{}, vol. 23 of Springer Series in Computational Mathematics, Springer-Verlag, Berlin, 1994.  , [A FINITE DIFFERENCE METHOD WITH NON-UNIFORM TIMESTEPS FOR FRACTIONAL DIFFUSION AND DIFFUSION-WAVE EQUATIONS]{}, The European Physical Journal Special Topics, 222 (2013), pp. 1987–1998.  , [EFFICIENT AND STABLE NUMERICAL METHODS FOR MULTI-TERM TIME FRACTIONAL SUB-DIFFUSION EQUATIONS]{}, East Asian J. Appl. Math., 4 (2014), pp. 242–266.  , [HOW TO APPROXIMATE THE FRACTIONAL DERIVATIVE OF ORDER []{}]{}, Internat. J. Bifur. Chaos Appl. Sci. Engrg., 22 (2012), pp. 1250075, 13.  , [A CLASS OF SECOND ORDER DIFFERENCE APPROXIMATION FOR SOLVING SPACE FRACTIONAL DIFFUSION EQUATIONS]{}, Math. Comp., 84 (2015), pp. 1703–1727.  , [A HIGH-ACCURACY PRESERVING SPECTRAL [G]{}ALERKIN METHOD FOR THE [D]{}IRICHLET BOUNDARY-VALUE PROBLEM OF VARIABLE-COEFFICIENT CONSERVATIVE FRACTIONAL DIFFUSION EQUATIONS]{}, J. Comput. Phys., 281 (2015), pp. 67–81.  , [COMPACT DIFFERENCE SCHEMES FOR THE MODIFIED ANOMALOUS FRACTIONAL SUB-DIFFUSION EQUATION AND THE FRACTIONAL DIFFUSION-WAVE EQUATION]{}, J. Comput. Phys., 277 (2014), pp. 1–15.  , [MAXIMUM PRINCIPLE AND NUMERICAL METHOD FOR THE MULTI-TERM TIME-SPACE [R]{}IESZ-[C]{}APUTO FRACTIONAL DIFFERENTIAL EQUATIONS]{}, Appl. Math. Comput., 227 (2014), pp. 531–540.  , [WEIGHTED AVERAGE FINITE DIFFERENCE METHODS FOR FRACTIONAL DIFFUSION EQUATIONS]{}, J. Comput. Phys., 216 (2006), pp. 264–274.  , [FRACTIONAL SPECTRAL COLLOCATION METHOD]{}, SIAM J. Sci. Comput., 36 (2014), pp. A40–A62.  , [SECOND-ORDER STABLE FINITE DIFFERENCE SCHEMES FOR THE TIME-FRACTIONAL DIFFUSION-WAVE EQUATION]{}, J. Sci. Comput., 65 (2015), pp. 411–430.  , [THE USE OF FINITE DIFFERENCE/ELEMENT APPROACHES FOR SOLVING THE TIME-FRACTIONAL SUBDIFFUSION EQUATION]{}, SIAM J. Sci. Comput., 35 (2013), pp. A2976–A3000.  height 2pt depth -1.6pt width 23pt, [NUMERICAL ALGORITHMS FOR TIME-FRACTIONAL SUBDIFFUSION EQUATION WITH SECOND-ORDER ACCURACY]{}, SIAM J. Sci. Comput., 37 (2015), pp. A55–A78.  , [A GENERALIZED SPECTRAL COLLOCATION METHOD WITH TUNABLE ACCURACY FOR VARIABLE-ORDER FRACTIONAL DIFFERENTIAL EQUATIONS]{}, SIAM J. Sci. Comput. 37 (2015), pp. A2710–A2732.  height 2pt depth -1.6pt width 23pt, [FAST DIFFERENCE SCHEMES FOR SOLVING HIGH-DIMENSIONAL TIME-FRACTIONAL SUBDIFFUSION EQUATIONS]{}, J. Comput. Phys. 307 (2016), pp. 15–33.  , [FINITE DIFFERENCE METHODS FOR THE TIME FRACTIONAL DIFFUSION EQUATION ON NON-UNIFORM MESHES]{}, J. Comput. Phys., 265 (2014), pp. 195–210.  , [OPTIMAL ERROR ESTIMATES FOR SPECTRAL [P]{}ETROV-[G]{}ALERKIN AND COLLOCATION METHODS FOR INITIAL VALUE PROBLEMS FOR FRACTIONAL DIFFERENTIAL EQUATIONS]{}, SIAM J. Numer. Anal., 53 (2015), pp. 2074–2096.  , [A FOURTH-ORDER COMPACT [ADI]{} SCHEME FOR TWO-DIMENSIONAL NONLINEAR SPACE FRACTIONAL [S]{}CHRÖDINGER EQUATION]{}, SIAM J. Sci. Comput., 36 (2014), pp. A2865–A2886.  , [A HIGH ORDER SPECTRAL METHOD FOR THE MULTI-TERM TIME-FRACTIONAL DIFFUSION EQUATIONS]{}, Appl. Math. Modelling, 2015, in press.  , [QUASI-COMPACT FINITE DIFFERENCE SCHEMES FOR SPACE FRACTIONAL DIFFUSION EQUATIONS]{}, J. Sci. Comput., 56 (2013), pp. 45–66.">
</outline>
<outline text="Supplementary Material" _note="We provide more numerical results to support the theoretical analysis and the proofs of Theorems  –  in Subsection  .">
  <outline text="A preconditioner for the exponential Vandermonde matrix" _note="In order to reduce the condition number of the ill-conditioned system , we can also construct a preconditioner such that the condition number of the preconditioned system is reduced. We present the following preconditioned system where is a basis function satisfying . By properly choosing , the system has lower condition number than that of . If , then we can choose , where is the orthogonal Legendre function given by We numerically tested that the condition number of is bounded, which is about for any , while the condition number of the original system is unbounded. The preconditioned system can be well solved by using the known tools as the multiprecision toolbox (see http://www.mathworks.com/matlabcentral/fileexchange/6446-multiple-precision-toolbox-for-matlab).">
  </outline>
  <outline text="Further investigation of the upper bound of" _note="Numerically, we find a much better upper bound of , which is presented below  We plot a bound of in for , which is shown in Fig.  . We see that does not increase with respect to and .  [(a) .]{}  [(b) .]{}  [(c) . ]{}  [(d) . ]{}">
  </outline>
  <outline text="More numerical results for multi-term FODEs" _note="We present an example using more than ten correction terms to solve the following FODE.    Consider the following two-term FODE subject to the initial condition , and .  Choose a suitable right-hand side function such that the analytical solution of is  Here, we use the multi-precision toolbox with 48 significant digits in the computation in order to avoid round-off errors (see http://www.mathworks.com/matlabcentral /fileexchange/6446-multiple-precision-toolbox-for-matlab).  We consider only the fractional order with in , and the pointwise errors are shown in Figs.  – . We can see that very accurate numerical solutions are obtained as the number of correction terms increases. Although we did not observe the global second-order accuracy, the small factor in the error equation makes numerical solutions very accurate as correction terms increases.  [(a) .]{}  [(b) .]{}  [(c) .]{}  [(d) .]{}  [(a) .]{}  [(b) .]{}  [(c) .]{}  [(d) .]{}">
  </outline>
  <outline text="Proofs of Theorems [thm:stability] and [thm:convergence]" _note="We prove the stability and convergence analysis of LGSEM –. We first introduce a lemma.    Suppose that , and are nonnegative sequence. Let and satisfies Then we have">
    <outline text="Proof of Theorem [thm:stability]" _note="Letting in and in , and eliminating the intermediate term , we obtain where and are defined by in which are defined by . Here can be derived from the fact (see Lemma 3.4 in ) and the definition of [(see )]{}. Also, can be derived from Lemma   with [in ]{}.  Summing up from 0 to and applying Lemma  , we obtain Applying the Cauchy–Schwarz inequality yields where is a positive constant independent of and . For simplicity, we denote Then we obtain [Note from , , and Lemma   that Hence, we derive from – ]{} For small enough , using the assumption , , and , we can get from the above inequality where , and Applying Gronwall’s inequality (Lemma  ) yields Using the condition and leads to Applying , and yields Combining – reaches the conclusion. This completes the proof.">
    </outline>
    <outline text="Proof of Theorem [thm:convergence]" _note="We now focus on the convergence of the scheme –. Introduce the projector : as The properties of the interpolation and projection operators are listed below.    If , then we have    If , then  Denote by , , , and . Then we get the error equation of – as follows where , , and  From Theorem  , –, and the properties , we can similarly derive where  It is easy to obtain and From and the boundedness of and , we derive Using the assumption and applying the property , we obtain  We can get from the assumption, hence Applying the triangle inequality and Lemma   yields the desired result.">
    </outline>
  </outline>
  <outline text="Multi-term time-fractional subdiffusion equation" _note="Consider the following multi-term time-fractional subdiffusion equation where , , , and . Here, we extend LGSEM – to solve , which can be easily extended to more generalized multi-term time-fractional subdiffusion equations, see e.g. . We directly present the LGSEM for as: Find for , such that where , are suitable positive integers, and are defined as in .  The convergence of the scheme – can be similarly proven as that of Theorem  , which is given by where the analytical solution of satisfies , is uniformly bounded for , , and []{}.  If in –, then we have    Consider the following time-fractional subdiffusion equation subject to the homogenous initial and boundary conditions, , and .  Next, we use the scheme – with to solve . Here in space, we use two subdomains: , and . We observe numerically that the resolution in space is fine enough and the total error is dominated by errors from time discretization.  It is known in that the analytical solution to satisfies , where . As we do not have the explicit form of the solution, we use reference solutions that are obtained with smaller time stepsize .  In Table  , we observe that the average errors become smaller when increases. We also observe second-order accuracy when . In the first column of Table  , we also list numerical results from the scheme of applying the L1 method in time with spatial discretization by the spectral element method (L1-SEM). We observe first-order accuracy of the L1-SEM, with the corresponding errors much larger than those by our proposed schemes.  We observe that we do not need to use the correction terms to get second-order accuracy when computing solutions at time far from . Hence, we can still use the method – to solve , but the operator can be replaced with when , i.e., in for . It is shown in Table   that similar error behaviors are obtained, compared to those results in Table  . This can be readily explained by the truncation error defined in : When , is suitably large, the correction term in contributes little to accuracy and convergence rate of the method –.">
  </outline>
  <outline text="The  method and fractional trapezoidal rule used in Example 5.2" _note="L1 method: The Caputo derivatives in are discretized by the L1 method, and the corresponding scheme is given by where and .  Trapezoidal rule method: We transform into its integral form as , then the trapezoidal rule is applied to the fractional integrals. The corresponding scheme is given by where and is given by">
  </outline>
</outline>
  </body>
</opml>