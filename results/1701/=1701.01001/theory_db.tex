\subsection{Main assumptions}

In the following we assess the theoretical properties of our estimator. All proofs are presented in Appendix~\ref{sec:proofs}. We preface our main assumptions by the definition of an \emph{$r$-local Doeblin set}.
\begin{definition} \label{defi:local-Doeblin}
Let $r \in \nsetpos$. A set $C \in \Xfd$ is $r$-\emph{local Doeblin} with respect to $\mk$ and $\pot$ if there exist positive functions $\varepsilon^-_C: \Zsp^r \to \rset^+$ and $\varepsilon^+_C: \Zsp^r \to \rset^+$, a family $\{ \probdoeblin{C}{\bar{z}} ; \bar{z} \in \Zsp^r \}$ of probability measures, and a family $\{\varphi_C \langle \bar{z} \rangle ; \bar{z} \in \Zsp^r \}$ of positive functions such that for all $\bar{z} \in \Zsp^r$, $\probdoeblin{C}{\bar{z}}(C) =1$ and for all $A \in \Xfd$ and $x \in C$,
\begin{equation*} \label{eq:definition-LD-set}
	\varepsilon^-_C \langle \bar{z} \rangle \, \varphi_C \langle \bar{z} \rangle(x) \, \probdoeblin{C}{\bar{z}} (A) \leq \uk[\bar{z}](x, A \cap C) \leq \varepsilon^+_C \langle \bar{z} \rangle \, \varphi_C \langle \bar{z} \rangle(x) \, \probdoeblin{C}{\bar{z}}(A).
\end{equation*}
\end{definition}

Our theoretical analysis is driven by the following assumptions. 

\begin{hypA} \label{assum:likelihoodDrift}
The pertubation process $\{ \per_n \}_{n \in \zset}$, taking on values in $(\Zsp, \Zfd)$, is strictly stationary and ergodic. Moreover, there exist an integer $r \in \nsetpos $ and a set $K \in \Zfd^{\varotimes r}$ such that the following holds.
\begin{enumerate}[(i)]
    \item \label{item:condition-L-K}
    The process $\{\perblock_n \}_{n \in \zset}$, where $\perblock_n \eqdef \chunk{\per}{n r}{(n + 1)r - 1}$, is ergodic and such that $\prob(\bar{\per}_0 \in K) > 2/3$.
    \item For all $\eta > 0$ there exists an $r$-local Doeblin set $C \in \Xfd$ such that for all $\chunk{z}{0}{r - 1} \in K$,
    \begin{equation*}
        \label{eq:bound-eta-G}
        \sup_{x \in C^\complement} \uk[\chunk{z}{0}{r-1}] \1_\Xsp(x) \leq \eta \sup_{x \in \Xsp} \uk[\chunk{z}{0}{r - 1}] \1_\Xsp(x) < \infty
    \end{equation*}
    and
    \begin{equation*} \label{eq:lower-bound}
        \inf_{\chunk{z}{0}{r - 1} \in K} \frac{\varepsilon_C^- \langle \chunk{z}{0}{r - 1} \rangle}{\varepsilon_C^+ \langle \chunk{z}{0}{r - 1} \rangle} > 0,
    \end{equation*}
    where the functions $\varepsilon^+_C$ and $\varepsilon^-_C$ are given in Definition~\ref{defi:local-Doeblin}.
    \item \label{item:condition-minoration}
    There exists a set $D \in \Xfd$ such that
    \begin{equation*}
        \label{eq:condition-minoration}
        \E \left[\ln^- \inf_{x \in D} \uk[\chunk{\per}{0}{r-1}] \1_D(x) \right] < \infty.
    \end{equation*}
\end{enumerate}
\end{hypA}

\begin{hypA}\label{assum:majo-g}
\begin{enumerate}[(i)]
    \item \label{item:assum-pos-g} For all $(x, z) \in \Xsp \times \Zsp$, $\pot[z](x) > 0$.
    \item \label{item:bdd:g} For all $z \in \Zsp$, $\| \pot[z] \|_\infty < \infty$.
    \item \label{item:assum-supg} $\E \left[ \ln^+ \| \pot[\per_0] \|_\infty \right] < \infty$.
\end{enumerate}
\end{hypA}

\begin{remark} \label{rem:simplified:assumptions}
    In the case $r = 1$, \A{assum:likelihoodDrift} may be replaced by the simpler assumption
    that there exists a set $K \in \Zfd$ such that the following holds.
    \begin{enumerate}[(i)]
        \item \label{item:condition-L-K-simplified}
        $\prob \left( \per_0 \in K \right) > 2 / 3$.
        \item \label{item:condition:local:doeblin:simplified}
        For all $\eta > 0$ there exists a $1$-local Doeblin set $C \in \Xfd$ such that for all $z \in K$,
        \begin{equation}
            \label{eq:bound-eta-G-simplified}
            \sup_{x \in C^\complement} \pot[z](x) \leq \eta \| \pot[z] \|_\infty < \infty.
        \end{equation}
        \item \label{item:mino-g-simple} There exists a set $D \in \Xfd$ satisfying
        $$
            \inf_{x \in D} \mk(x, D) > 0 \quad \mbox{and} \quad \E \left[ \ln^- \inf_{x \in D} \pot[\per_0](x) \right] < \infty.
        $$
    \end{enumerate}
    This simplified version will be used in Section~\ref{sec:numerical:study}.
\end{remark}

\subsection{Theoretical properties of the fixed-lag estimator}

As established by the following proposition, for all $n \in \nset$, $\chunk{z}{0}{n - 1} \in \Zsp^n$, and $\lag \in \nset$, the estimator $\varest[2]{\chunk{z}{0}{n - 1}}[\lambda]$ is a consistent for $\variance[2]{\chunk{z}{0}{n - 1}}[\lagtime{n}{\lag}]$, where the latter is given by \eqref{eq:def:as:var} with $\ell = \lagtime{n}{\lag}$. 

\begin{proposition} \label{prop:consistency:fixed:lag}
Assume \A{assum:majo-g}(\ref{item:assum-pos-g}--\ref{item:bdd:g}). Then for all $n \in \nset$, $\chunk{z}{0}{n - 1} \in \Zsp^n$, $\lag \in \nset$, and $h \in \bmf{\Xfd}$, as $\N \rightarrow \infty$, 
$$
\varest[2]{\chunk{z}{0}{n - 1}}[\lambda](h) \plim \variance[2]{\chunk{z}{0}{n - 1}}[\lagtime{n}{\lag}](h). 
$$
\end{proposition}

Now, define, for all $n \in \nset$ and $\chunk{z}{0}{n - 1} \in \Zsp^n$, the \emph{asymptotic bias}  
\begin{equation} \label{eq:def:bias}
\bias{\chunk{z}{0}{n - 1}}{\lag} : \bmf{\Xfd} \ni h \mapsto \variance[2]{\chunk{z}{0}{n - 1}}(h) - \variance[2]{\chunk{z}{0}{n - 1}}[\lagtime{n}{\lag}](h), 
\end{equation}
which is always nonnegative. For the integer $r \in \nsetpos$ and the set $D \in \Xfd$ given in \A{assum:likelihoodDrift}, introduce the class 
\begin{equation} \label{eq:class:initial:distributions}
\mdr(D, r) \eqdef \left\{ \init \in \probmeas{\Xfd} : \E \left[ \ln^- \init \uk[\chunk{\per}{0}{\ell - 1}] \1_D \right] < \infty \mbox{ for all $\ell \in \intvect{0}{r}$} \right \}
\end{equation}
of initial distributions. Then the following theorem, which is the main result of this paper, states that the asymptotic bias can be controlled uniformly in time by the lag $\lambda$. In particular, the bias decreases with $\lambda$ at a geometric rate. 

\begin{theorem} \label{thm:tightness:bias}
Assume \A[assum:likelihoodDrift]{assum:majo-g}. Then there exist a constant $\rate \in (0, 1)$ and a sequence $(\bd_k)_{k \in \nsetpos}$ in $\rset_+$ such that for all $\init \in \mdr(D, r)$ (with $D$ and $r$ given by \A{assum:likelihoodDrift}), $\lag \in \nset$, $h \in \bmf{\Xfd}$, and $k \in \nset$,
\begin{equation} \label{eq:bias:bound}
\sup_{n \in \nset} \prob \left( \frac{\bias{\chunk{\per}{0}{n - 1}}{\lag}(h)}{\rate^{\lambda + 1} \| h \|_{\infty}^2} > c_k  \right) \leq \frac{1}{k}.   
\end{equation}
\end{theorem}

\begin{remark}
We stress that the sequence $\{ \bd_k \}_{k \in \nsetpos}$ as well as the mixing rate $\rho$ in the previous theorem depend exclusively on the properties of the model and not on the lag size $\lag$, the objective function $h$, or the initial distribution $\init$ (as long as this belongs to $\mdr(D, r)$). This means that at any level specified by $k$, the asymptotic bias can be controlled uniformly in time at a geometric rate in $\lag$.
\end{remark} 

The strength of these bounds will be illustrated numerically in Section~\ref{sec:numerical:study}. 

\subsection{Extensions to variance estimators for flows of updated distributions}

In the following we confirm that the previous results can be extended to flows of updated Feynman-Kac distributions (recall the definitions in Section~\ref{sec:updated:measures}). 

\begin{proposition} \label{prop:consistency:fixed:lag:updated:case}
Assume \A{assum:majo-g}(\ref{item:assum-pos-g}--\ref{item:bdd:g}). Then for all $n \in \nset$, $\chunk{z}{0}{n} \in \Zsp^{n + 1}$, $\lag \in \nset$, and $h \in \bmf{\Xfd}$, as $\N \rightarrow \infty$, 
$$
\varestfilt[2]{\chunk{z}{0}{n}}[\lambda](h) \plim \filtvariance[2]{\chunk{z}{0}{n}}[\lagtime{n}{\lag}](h). 
$$
\end{proposition}

Now, as in the previous section, define, for all $n \in \nset$ and $\chunk{z}{0}{n} \in \Zsp^{n + 1}$, the asymptotic bias   
\begin{equation} \label{eq:def:bias:filter}
\biasfilt{\chunk{z}{0}{n}}{\lag} : \bmf{\Xfd} \ni h \mapsto \filtvariance[2]{\chunk{z}{0}{n}}(h) - \filtvariance[2]{\chunk{z}{0}{n}}[\lagtime{n}{\lag}](h). 
\end{equation} 

\begin{theorem} \label{thm:tightness:bias:filter}
Assume \A[assum:likelihoodDrift]{assum:majo-g}. Then the statement of Theorem~\ref{thm:tightness:bias} holds true when $\bias{\chunk{\per}{0}{n - 1}}{\lag}$ is replaced by $\biasfilt{\chunk{\per}{0}{n}}{\lag}$. 
\end{theorem}

\subsection{Bounds on the asymptotic bias under strong mixing assumptions}

Before continuing to the numerical part of the paper, we provide, for the sake of completeness, a stronger bound on the asymptotic bias under the following \emph{strong mixing} assumption, which is standard in the literature of SMC analysis (see \cite{delmoral:guionnet:2001} and, e.g., \cite{delmoral:2004,cappe:moulines:ryden:2005,crisan:heine:2008} for refinements) and points to applications where the state space $\Xsp$ is a compact set.   

\begin{hypB} \label{ass:strong:mixing}
    \begin{enumerate}[(i)]
    \item \label{ass:strong:mixing-1} There exist constants $0 < \mdlow < \mdup < \infty$ and a probability measure $\mu \in \probmeas{\Xfd}$ such that for all $x \in \Xsp$ and $A \in \Xfd$, 
    $$
        \mdlow \mu(A) \leq \mk(x, A) \leq \mdup \mu(A).
    $$
    \item \label{ass:strong:mixing-2} There exist constants $0 < \potlow < \potup < \infty$ such that for all $z \in \Zsp$, $\| \pot[z] \|_\infty \leq \potup$ and for all $(x, z) \in \Xsp \times \Zsp$, $\mk \pot[z](x) \geq \potlow$.
    \end{enumerate}
\end{hypB}

Under \B{ass:strong:mixing}(\ref{ass:strong:mixing-1}), define $\varrho \eqdef 1 - \mdlow / \mdup$; then, instead of bounding the asymptotic bias stochastically (as in Theorem~\ref{thm:tightness:bias}), the following theorem provides a \emph{deterministic} bound on the same. The proof is found in Section~\ref{sec:proof:strong:bias:bound}. 

\begin{theorem} \label{thm:strong:bias:bound}
Assume \B{ass:strong:mixing}. Then there exists a constant $c \in \rsetpos$ such that for all $n \in \nset$, $\chunk{z}{0}{n - 1} \in \Zsp^n$, $\lag \in \nset$, and $h \in \bmf{\Xfd}$, 
\begin{equation*} \label{eq:strong:bias:bound}
\bias{\chunk{z}{0}{n - 1}}{\lag}(h) \leq 
\begin{cases} 
0 & \mbox{for } n \leq \lag, \\
c \varrho^{2(\lambda + 1)} \| h \|_{\infty}^2 & \mbox{for } n > \lag. 
\end{cases} 
\end{equation*}
\end{theorem}
















