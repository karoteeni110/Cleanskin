<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>Counting Lyndon factors</title>
    <abstract>In this paper, we determine the maximum number of distinct Lyndon
factors that a word of length can contain. We also derive formulas for
the expected total number of Lyndon factors in a word of length on an
alphabet of size , as well as the expected number of distinct Lyndon
factors in such a word. The minimum number of distinct Lyndon factors in
a word of length is and the minimum total number is , with both bounds
being achieved by where is a letter. A more interesting question to ask
is WHAT IS THE MINIMUM NUMBER OF DISTINCT LYNDON FACTORS IN A LYNDON
WORD OF LENGTH ? In this direction, it is known that an optimal lower
bound for the number of distinct Lyndon factors in a Lyndon word of
length is , where denotes the GOLDEN RATIO . Moreover, this lower bound
is attained by the so-called finite FIBONACCI LYNDON WORDS, which are
precisely the Lyndon factors of the well-known INFINITE FIBONACCI WORD —
a special example of a INFINITE STURMIAN WORD. Saari conjectured that if
is Lyndon word of length , , containing the least number of distinct
Lyndon factors over all Lyndon words of the same length, then is a
CHRISTOFFEL WORD (i.e., a Lyndon factor of an infinite Sturmian word).
We give a counterexample to this conjecture. Furthermore, we generalise
Saari’s result on the number of distinct Lyndon factors of a Fibonacci
Lyndon word by determining the number of distinct Lyndon factors of a
given Christoffel word. We end with two open problems. </abstract>
  </head>
  <body>
<outline text="Introduction" _note="This paper is concerned with counting Lyndon words occurring in a given&#10;word of length . First, let us recall some terminology and notation from&#10;combinatorics on words (see, e.g., ). A WORD is a (possibly empty)&#10;finite or infinite sequence of symbols, called LETTERS, drawn from a&#10;given finite set , called an ALPHABET, of size . A finite word with each&#10;is said to have LENGTH , written . The [EMPTY WORD]{} is the unique word&#10;of length , denoted by . The set of all finite words over (including the&#10;empty word) is denoted by , and for each integer , the set of all words&#10;of length over is denoted by .&#10;&#10;A finite word is said to be a FACTOR of a given finite word if there&#10;exist words , such that . If , then is said to be a PREFIX of , and if ,&#10;then is said to be a SUFFIX of . If both and are non-empty, we say that&#10;is a PROPER FACTOR of . A prefix (respectively, suffix) of that is not&#10;equal to itself is said to be a PROPER PREFIX (respectively, PROPER&#10;SUFFIX) of . A factor of an infinite word is a finite word that occurs&#10;within it.&#10;&#10;A non-empty word that is both a proper prefix and a proper suffix of a&#10;finite word is said to be a BORDER of . We say that a word which has&#10;only an empty border is BORDERLESS. If, for some word , ( times for some&#10;integer ), we write , and is called the -TH POWER OF . A non-empty&#10;finite word is said to be PRIMITIVE if it is not a power of a shorter&#10;word. Two finite words , are said to be CONJUGATE if there exist words&#10;such that and . Accordingly, conjugate words are cyclic shifts of one&#10;another, and thus conjugacy is an equivalence relation. A primitive word&#10;of length has exactly distinct conjugates. For example, the primitive&#10;word of length has distinct conjugates; namely, itself and the six words&#10;, , , , , . The set of all conjugates of a finite word is called the&#10;CONJUGACY CLASS of .&#10;&#10;In this paper we consider only words on an ordered alphabet where . This&#10;total order on naturally induces a LEXICOGRAPHICAL ORDER (i.e., an&#10;alphabetical order) on the set of all finite words over . A LYNDON WORD&#10;over is a non-empty primitive word that is the lexicographically least&#10;word in its conjugacy class, i.e., or for all non-empty words such that&#10;(e.g., see ). Equivalently, a non-empty finite word over is Lyndon if&#10;and only if or for all proper suffixes of . Note, in particular, that&#10;there is a unique Lyndon word in the conjugacy class of any given&#10;primitive word. For example, is the unique Lyndon conjugate of the&#10;primitive word . Lyndon words are named after R.C. Lyndon , who&#10;introduced them in 1954 under the name of “standard lexicographic&#10;sequences”. Such words are well known to be borderless .&#10;&#10;We begin in Section \[sect-2\] by computing , the maximum number of&#10;distinct Lyndon factors in a word of length on an alphabet of size . In&#10;Section \[sect-3\] we compute , the expected total number of Lyndon&#10;factors (that is, counted according to their multiplicity) in a word of&#10;length over , while Section \[sect-4\] computes , the expected number of&#10;distinct Lyndon factors in word of length over . Section \[sect-5\]&#10;considers distinct Lyndon factors in a Lyndon word of length ; in&#10;particular, we generalise a result of Saari on the number of distinct&#10;Lyndon factors of a FIBONACCI LYNDON WORD by determining the number of&#10;distinct Lyndon factors of a given CHRISTOFFEL WORD (i.e., a Lyndon&#10;factor of an infinite Sturmian word — to be defined later). Lastly, in&#10;Section \[sect-6\], we state some open problems.">
</outline>
<outline text="The maximum number of distinct Lyndon factors in a word" _note="Let be the maximum number of distinct Lyndon factors in a word of length&#10;on the alphabet . We want to find a word that achieves , given and . It&#10;is clear that a necessary condition for attaining the maximum is that&#10;takes the form . This word contains factors of lengths , of which each&#10;is a Lyndon word except those of the form . The number of powers of each&#10;is , including itself. The total number of Lyndon factors in is&#10;therefore&#10;&#10;where the final counts the single letters . We claim that the summation&#10;is minimised when the differ by at most one. Suppose to the contrary&#10;that for some , and . It is easily checked that for . Thus the summation&#10;term will be minimised when each equals either or . If , where , then&#10;and . If then each equals . We therefore have the following result.&#10;&#10;\[T1\] If , where , then and the maximum is attained using&#10;&#10;If then&#10;&#10;If , Theorem \[T1\] gives&#10;&#10;The following table shows values of for low values of .">
</outline>
<outline text="The expected total number of Lyndon factors in a word" _note="We now wish to calculate the total number of Lyndon factors (that is,&#10;counted according to multiplicity) appearing in all words in . Consider&#10;a Lyndon word of length and a position , , in words of length . Words&#10;containing starting at position have the form where is any word on with&#10;length . Thus there will be words in which contain in this position.&#10;This will be the same for any of the possible values of so in the words&#10;in there will be appearances of . This is the same for all Lyndon words&#10;of this length. The number of such Lyndon words is of the number of&#10;primitive words of this length, since exactly one conjugate of each&#10;primitive word is Lyndon. The number of primitive words of length (,&#10;equation (1.3.7)) is where is the Möbius function. To get the total&#10;number of Lyndon factors appearing in , we sum over possible values of :&#10;Dividing by gives the expected total number of Lyndon factors in a word&#10;of length on the alphabet . Table \[table2\] below shows values for and&#10;low values of .">
</outline>
<outline text="The expected number of distinct Lyndon factors in a word" _note="We use the notation from above, with being the set . Most of the&#10;following analysis counts the number of words in that contain at least&#10;one factor equal to a specific Lyndon word . At the end we sum over all&#10;possible . Let be a non-empty set of positions in a word and let if&#10;contains factors equal to at each position in beginning at a position in&#10;the set , and 0 otherwise. Note that may contain other factors equal to&#10;. We claim that&#10;&#10;If contains no factor equal to then equals 0 for all so the “otherwise”&#10;part of the claim holds. Suppose contains copies of beginning at&#10;positions in and nowhere else. Then equals 1 if and only if is any&#10;non-empty subset of , so the left hand side of (\[e3\]) becomes This&#10;equals 1 since the final sum is the binomial expansion of . The number&#10;of words in which contain at least one factor equal to is therefore&#10;&#10;We now evaluate . This is counting the words in which have factors&#10;beginning at positions . It clearly equals 0 if since then there is no&#10;room in for factors (recalling that is Lyndon, therefore borderless, and&#10;therefore cannot intersect a copy of itself). We also need the members&#10;of to be separated by at least . The number of such sets is Once is&#10;chosen there are ways of choosing the letters in which are not in the&#10;specified factors . Thus&#10;&#10;Substituting in (\[e4\]) we see that the number of words in which&#10;contain at least one occurrence of is To get the expected number of&#10;distinct Lyndon factors in a word of length , we sum this over all with&#10;length at most , using the same technique as in the previous section,&#10;and divide by . Replacing with we get the following:&#10;&#10;The following table shows values of for low values of and several values&#10;of .">
</outline>
<outline text="Distinct Lyndon factors in a Lyndon word" _note="Minimising the number of Lyndon factors over words of length is not very&#10;interesting: the minimum number of distinct Lyndon factors is and the&#10;minimum total number is . Both bounds are achieved by where is a letter.&#10;A more interesting question has been studied by Saari : WHAT IS THE&#10;MINIMUM NUMBER OF DISTINCT LYNDON FACTORS IN A LYNDON WORD OF LENGTH ?&#10;He proved that an optimal lower bound for the number of distinct Lyndon&#10;factors in a Lyndon word of length is where denotes the GOLDEN RATIO .&#10;Moreover, this lower bound is attained by the so-called finite FIBONACCI&#10;LYNDON WORDS, which are precisely the Lyndon factors of the well-known&#10;INFINITE FIBONACCI WORD — a special example of a CHARACTERISTIC STURMIAN&#10;WORD.&#10;&#10;Following the notation and terminology in , an infinite word over is&#10;STURMIAN if and only if there exists an irrational , and a real number ,&#10;such that is one of the following two infinite words: defined by&#10;&#10;The irrational is called the SLOPE of and is the INTERCEPT. If , we have&#10;where is called the CHARACTERISTIC STURMIAN WORD of slope . Sturmian&#10;words of the same slope have the same set of factors , so when studying&#10;the factors of Sturmian words, it suffices to consider only the&#10;characteristic ones.&#10;&#10;The INFINITE FIBONACCI WORD is the characteristic Sturmian word of slope&#10;. It can be constructed as the limit of an infinite sequence of&#10;so-called FINITE FIBONACCI WORDS , defined by: That is, , , , , , etc.&#10;(where is a prefix of for each ), and we have&#10;&#10;The length of the -th finite Fibonacci word is the -th FIBONACCI NUMBER&#10;, defined by: for .&#10;&#10;More generally, any characteristic Sturmian word can be constructed as&#10;the limit of an infinite sequence of finite words. To this end, we&#10;recall that every irrational has a unique simple continued fraction&#10;expansion: where each is a positive integer. The -th CONVERGENT of is&#10;defined by where the sequences and are given by&#10;&#10;Suppose , with and all other . To the DIRECTIVE SEQUENCE , we associate&#10;a sequence of words defined by Such a sequence of words is called a&#10;STANDARD SEQUENCE, and we have Note that is a suffix of and is a suffix&#10;of for all .&#10;&#10;Standard sequences are related to characteristic Sturmian words in the&#10;following way. Observe that, for any , is a prefix of , which gives&#10;obvious meaning to as an infinite word. In fact, one can prove that each&#10;is a prefix of , and we have&#10;&#10;The following lemma collects together some properties of the STANDARD&#10;WORDS . Note that from now on when referring to Lyndon words over the&#10;alphabet we assume the natural order .&#10;&#10;\[L:s\_n\] Let be the characteristic Sturmian word of slope with where&#10;the words are defined as above.&#10;&#10;For all , is a primitive word .&#10;&#10;For all , there exist uniquely determined palindromes , , such that&#10;where and .&#10;&#10;For all , the reversal of is the -nd conjugate of , and hence the&#10;conjugacy class of is closed under reversal.&#10;&#10;The Lyndon factors of of length at least are precisely the Lyndon&#10;conjugates of the (primitive) standard words for all .&#10;&#10;The following lemma is a generalisation of .&#10;&#10;\[L:characteristic\] Let be the characteristic Sturmian word of slope&#10;with where with . The Lyndon conjugate of is the word for all .&#10;Moreover, every Lyndon factor of that is shorter than is either a prefix&#10;or a suffix of .&#10;&#10;First we show that, for all , the Lyndon conjugate of is the word . If ,&#10;then is clearly a conjugate of and it is Lyndon . On the other hand, if&#10;, then is a clearly a conjugate of , and since the conjugacy class of is&#10;closed under reversal and is a palindrome (by Lemma \[L:s\_n\]), it&#10;follows that is a conjugate of and it is Lyndon .&#10;&#10;To prove the second claim, it suffices to show that if , then the Lyndon&#10;conjugate of is a prefix or suffix of (since, by Lemma \[L:s\_n\], the&#10;Lyndon factors of of length at least are precisely the Lyndon conjugates&#10;of the (primitive) standard words in ). The claim is true for and since&#10;and . It is also true for because is the Lyndon conjugate of itself, and&#10;is a prefix of if and a suffix of if . Now suppose that . Then implies&#10;that is a prefix of . Furthermore, since is a palindrome, the reversal&#10;of is a suffix of . Therefore if , then its Lyndon conjugate is a prefix&#10;of ; otherwise, if , then its Lyndon conjugate is a suffix of .&#10;&#10;The Lyndon factors of (characteristic) Sturmian words of length at least&#10;(i.e., the Lyndon conjugates of standard words) over are precisely the&#10;so-called CHRISTOFFEL WORDS beginning with the letter  (see, e.g., the&#10;nice survey ). Christoffel words take the form and where and is ITERATED&#10;PALINDROMIC CLOSURE, defined by: where denotes the shortest palindrome&#10;beginning with (called the PALINDROMIC CLOSURE of ). For example, where&#10;the underlined letters indicate the points at which palindromic closure&#10;is applied.&#10;&#10;Let , be co-prime integers with . The rational has two distinct simple&#10;continued fraction expansions: where and all other . The so-called&#10;CHRISTOFFEL WORD OF SLOPE beginning with the letter is the unique&#10;Sturmian Lyndon word over of length containing occurrences of the letter&#10;, given by: For example, the Christoffel word of slope beginning with&#10;the letter is .&#10;&#10;\[R1\] Note, in particular, that the Christoffel word of slope beginning&#10;with the letter is precisely the Lyndon conjugate of the standard word&#10;where , , and for (see, e.g., ).&#10;&#10;For all , the FIBONACCI LYNDON WORD OF LENGTH (i.e., the Lyndon&#10;conjugate of the finite Fibonacci word ) is the Christoffel word of&#10;slope beginning with .&#10;&#10;Saari proved that if is a Lyndon word with for some , then contains at&#10;least distinct Lyndon factors, with equality if and only if is the&#10;Fibonacci Lyndon word of length . For example, is the Fibonacci Lyndon&#10;word of length and contains the minimum number () of distinct Lyndon&#10;factors over all Lyndon words of the same length. Saari also made the&#10;following conjecture.&#10;&#10; If is a Lyndon word of length , , containing the least number of&#10;distinct Lyndon factors over all Lyndon words of the same length, then&#10;is a CHRISTOFFEL WORD.&#10;&#10;The number 6 is excluded because the following words all contain 7&#10;distinct Lyndon factors, which is the minimum for length 6 words, and&#10;only the first and last are Christoffel:&#10;&#10;However the conjecture is not true. The following Lyndon word has length&#10;28 and contains 10 distinct Lyndon factors — the minimum number of&#10;distinct Lyndon factors in a Lyndon word of this length — but it is not&#10;Christoffel (compare the prefix of length 5 to the suffix of length 5):&#10;&#10;The minimum of 10 distinct Lyndon factors for a Lyndon word of length is&#10;also attained by the Lyndon word which is the Christoffel word of slope&#10;.&#10;&#10;We now generalise Saari’s result on the number of distinct Lyndon&#10;factors in a Fibonacci Lyndon word by determining the number of distinct&#10;Lyndon factors in a given Christoffel word. Let denote the number of&#10;distinct Lyndon factors in a word .&#10;&#10;\[T:christoffel\] If is a Sturmian Lyndon word on with , i.e., a&#10;Christoffel word (beginning with the letter ) of slope for some co-prime&#10;integers , with , then .&#10;&#10;The word is the Lyndon conjugate of the standard word with , , and for&#10;(see Remark \[R1\]). By Lemma \[L:characteristic\], the Lyndon&#10;conjugates of for are either prefixes or suffixes of . Moreover, for&#10;each with , the standard word contains distinct Lyndon factors of&#10;lengths for . By Lemma \[L:s\_n\], these are the only Lyndon factors of&#10;the Lyndon word besides itself and the two letters and . Hence .&#10;&#10;The above result is a generalisation of , which reworded (with the&#10;indexing of Fibonacci words and numbers shifted back by ) states that if&#10;is the Fibonacci Lyndon word of length for some , i.e., the Christoffel&#10;word of slope beginning with the letter , then .&#10;&#10;**Examples:**&#10;&#10;The Christoffel word of slope beginning with the letter , namely , is&#10;the FIBONACCI LYNDON WORD of length that contains the minimum number ()&#10;of distinct Lyndon factors for its length.&#10;&#10;The Christoffel word of slope beginning with the letter , namely , is a&#10;Sturmian Lyndon word of length containing the minimum number () of&#10;distinct Lyndon factors for its length.&#10;&#10;The Christoffel word of slope beginning with the letter , namely , is&#10;the Fibonacci Lyndon word of length containing the minimum number () of&#10;distinct Lyndon factors for its length.">
</outline>
<outline text="Open Problems" _note="Open Problem 1&#10;&#10;:   One might suspect that any given Christoffel word contains the&#10;    minimum number of distinct Lyndon factors over all Lyndon words of&#10;    the same length. However, this is not true. For instance, the&#10;    Christoffel word of slope beginning with the letter , namely ,&#10;    contains () distinct Lyndon factors, but the minimum number of&#10;    distinct Lyndon factors of a Lyndon word of length is actually .&#10;    This minimum is attained by the Christoffel word of slope .&#10;&#10;    Is it true that the minimum number of distinct Lyndon factors over&#10;    all Lyndon words of the same length is attained by at least one&#10;    Christoffel word of that length?&#10;&#10;Open Problem 2&#10;&#10;:   Tables \[table2\] and \[table3\], showing values for and , raise the&#10;    question of whether there may exist asymptotic formulas for these&#10;    quantities, simpler than the exact values displayed in equations&#10;    (\[e2\]) and (\[e6\]), respectively.&#10;&#10;[99]{}&#10;&#10;J. Berstel, Sturmian and episturmian words (a survey of some recent&#10;results), CAI 2007, LECTURE NOTES IN COMPUTER SCIENCE, vol. 4728, 2007,&#10;pp. 23–47.&#10;&#10;J. Berstel, A. de Luca, Sturmian words, Lyndon words and trees, THEORET.&#10;COMPUT. SCI. 178 (1997) 171–203.&#10;&#10;T.C. Brown, Descriptions of the characteristic sequence of an&#10;irrational, CANAD. MATH. BULL. 36 (1993) 15–21.&#10;&#10;K.T. Chen, R.H. Fox, R.C. Lyndon, Free differential calculus, IV. The&#10;quotient groups of the lower central series, ANN. MATH. 68 (1958) 81–95.&#10;&#10;A. de Luca, Sturmian words: structure, combinatorics and their&#10;arithmetics, THEORET. COMPUT. SCI. 183 (1997) 45–82.&#10;&#10;A. de Luca, F. Mignosi, Some combinatorial properties of Sturmian words,&#10;THEORET. COMPUT. SCI. 136 (1994) 361–385.&#10;&#10;J.P. Duval, Factorizing words over an ordered alphabet, J. ALGS. 4&#10;(1983) 363–381.&#10;&#10;A.S. Fraenkel, M. Mushkin, U. Tassa, Determination of by its sequence of&#10;differences, CANAD. MATH. BULL. [21]{} (1978) 441–446.&#10;&#10;A. Glen, On Sturmian and episturmian words, and related topics, PHD&#10;THESIS, The University of Adelaide, Australia, April 2006,&#10;&lt;http://hdl.handle.net/2440/37765&gt;.&#10;&#10;M. Lothaire, COMBINATORICS ON WORDS, ENCYCLOPEDIA OF MATHEMATICS AND ITS&#10;APPLICATIONS, vol. 17, CAMBRIDGE UNIVERSITY PRESS, UK, 1997.&#10;&#10;M. Lothaire, ALGEBRAIC COMBINATORICS ON WORDS, ENCYCLOPEDIA OF&#10;MATHEMATICS AND ITS APPLICATIONS, vol. 90, CAMBRIDGE UNIVERSITY PRESS,&#10;UK, 2002.&#10;&#10;R.C. Lyndon, On Burnside’s problem, TRANS. AMER. MATH. SOC. 77 (1954)&#10;202–215.&#10;&#10;K. Saari, Lyndon words and Fibonacci numbers, J. COMBIN. THEORY SER. A&#10;121 (2014) 34–44.">
</outline>
  </body>
</opml>