<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>Subcritical graph classes containing all planar graphs</title>
    <abstract>We construct minor-closed addable families of graphs that are
subcritical and contain all planar graphs. This contradicts (one
direction of) a well-known conjecture of Noy.

KEYWORDS: Subcritical graph class, planar graphs

2010 MSC: Primary: 05C30; Secondary: 05A16, 05C10, 05C80, 05C83 </abstract>
  </head>
  <body>
<outline text="Introduction" _note="Subcritical classes of (finite, simple) graphs are defined by a&#10;technical condition involving their generating functions; we recall the&#10;formal definition in the next section.&#10;&#10;Loosely speaking, graphs from subcritical families can be thought of as&#10;“tree-like”. Indeed, it is shown in that their Benjamini–Schramm limits&#10;are similar to that of random trees. Subcritical graph classes have also&#10;been observed to exhibit tree-like behaviour of a different kind:&#10;Panagiotou, Stufler and Weller showed that the scaling limit of random&#10;graphs from subcritical classes, in the Gromov–Hausdorff sense, is&#10;Aldous’ continuum random tree (see also ).&#10;&#10;Other properties of subcritical families that have been studied include&#10;the degree distribution , extremal parameters such as the maximum degree&#10;and the diameter , and subgraph counts . Important examples of&#10;subcritical graph classes include cacti, outerplanar graphs and&#10;series-parallel graphs.&#10;&#10;Noy made the following well-known conjecture, which attempts a&#10;characterization of the subcritical families that are addable and&#10;minor-closed.&#10;&#10;An addable, minor-closed class of (labelled) graphs is subcritical if&#10;and only if it has a planar forbidden minor.&#10;&#10;A class of graphs is called [MINOR-CLOSED]{} if every minor of a graph&#10;is again in . The class is called [ADDABLE]{}, if it satisfies the&#10;following two requirements: 1) the disjoint union of any two graphs&#10;belongs to , and 2) for every , the graph obtained by adding an edge&#10;between two vertices in distinct components of is again an element of .&#10;&#10;Recall that a minor-closed graph class has a planar forbidden minor if&#10;and only if it has bounded tree-width . Thus, in the light of the above&#10;discussion, Noy’s conjecture can be interpreted as stating that&#10;tree-likeness in the graph minor sense coincides with tree-likeness in&#10;the sense of enumerative and probabilistic combinatorics.&#10;&#10;The aim of this paper is to provide a counterexample to one direction of&#10;Noy’s conjecture: we construct addable, minor-closed, subcritical&#10;classes of graphs that contain all planar graphs[^1]. These classes are&#10;defined as follows:&#10;&#10;\[ref:Gkdefi\] We let be the class of all graphs with the property that&#10;every [BLOCK]{} (i.e. maximal connected subgraph without a cutvertex) is&#10;either planar or can be reduced to a forest by removing at most&#10;vertices.&#10;&#10;Verifying that is indeed addable and minor-closed is not difficult; the&#10;main result will be the fact that it is subcritical for . Heuristically,&#10;the reason is that the “tree-like” blocks become more numerous and thus&#10;asymptotically more important than the planar blocks, and that inherits&#10;the tree-likeness from them.&#10;&#10;The number of graphs with vertices that can be reduced to a forest by&#10;removing at most vertices, from now on called [-APEX FORESTS]{}, has&#10;been obtained asymptotically by Kurauskas and McDiarmid . Combining&#10;their result with our asymptotic enumeration of the 2-connected ones, we&#10;deduce, in Section \[sec 2 conn\], that the probability for a uniformly&#10;random -apex forest to be 2-connected decays exponentially in , and we&#10;determine the rate of exponential decay for each .&#10;&#10;Let us remark that we will only consider labelled graphs in this&#10;manuscript. However, the same approach also applies to the unlabelled&#10;setting. We also emphasize that this only provides a counterexample to&#10;one direction of Noy’s conjecture. The other direction (an addable,&#10;minor-closed graph class with a forbidden planar minor is subcritical)&#10;remains plausible.&#10;&#10;[^1]: Even more, in Section \[secdisc\] we observe that our construction&#10;    can be generalised to contain all graphs from any fixed proper&#10;    minor-closed graph family.">
</outline>
<outline text="Subcriticality" _note="A maximal connected subgraph without a cutvertex is called a BLOCK. A&#10;class of graphs is called BLOCK-STABLE if it satisfies the following&#10;property: a graph lies in if and only if all blocks of lie in . Let&#10;denote the class of all connected graphs in and the class of all blocks&#10;in . Moreover, let , and be the exponential generating functions&#10;associated with , and respectively. The three are connected by the&#10;functional equations where is the exponential generating function for&#10;ROOTED connected graphs in . Let and be the radii of convergence of and&#10;respectively. If , the class is called SUBCRITICAL. This technical&#10;condition ensures that has a dominant singularity at of square-root type&#10;(see ), with many important consequences. As mentioned earlier,&#10;subcritical graphs are tree-like in many ways. The main result of this&#10;manuscript is:&#10;&#10;\[thm:main\] For every , the graph class is subcritical.&#10;&#10;The main idea is as follows: we first determine the radius of&#10;convergence of the exponential generating function associated with the&#10;blocks of . In doing so, we show that planar blocks form a negligible&#10;part of the set of possible blocks. Finally, we prove that goes to&#10;infinity as . This in turn is used to prove subcriticality.">
</outline>
<outline text="Proofs" _note="To prove that the classes of Definition \[ref:Gkdefi\] contradict Noy’s&#10;conjecture, we have to show that they are addable, minor-closed and —for&#10;— subcritical. We start with the first two properties, which are easier&#10;to prove.&#10;&#10;\[prop\_add\_mc\] For every positive integer , the graph class is both&#10;addable and minor-closed.&#10;&#10;To prove that is addable, note first that disjoint unions of graphs in&#10;are trivially elements of again. Next consider any graph , and let be&#10;obtained from by connecting two vertices in distinct connected&#10;components of by an edge. Note that the blocks of are the blocks of and&#10;the newly added edge. Since a single edge is a planar graph and thus an&#10;allowed block, the graph still lies in . Hence the class is addable.&#10;&#10;To show that is also minor-closed, we need to prove that it is closed&#10;under the operations of removing a vertex, removing an edge, or&#10;contracting an edge. When an edge or a vertex is removed, all blocks of&#10;the new graph are subgraphs of blocks of the old graph. Every subgraph&#10;of a planar graph is again planar. Likewise, if a graph can be reduced&#10;to a forest by removing at most vertices, so can any subgraph (by&#10;removing the same vertices or – if some of them are not part of the&#10;subgraph – a subset thereof). Thus the condition in&#10;Definition \[ref:Gkdefi\] remains valid if vertices or edges are&#10;removed.&#10;&#10;The last operation to consider is contraction of edges; it suffices to&#10;consider the block that contains the contracted edge. If this block is&#10;planar, it remains so after the edge contraction. If the block can be&#10;reduced to a forest by removing at most vertices, then this is still&#10;true after the edge contraction: removing the same vertices (possibly&#10;one less, because two of them have been reduced to a single vertex)&#10;yields the original forest, a subgraph thereof (again a forest), or the&#10;original forest with a contracted edge (which is also a forest). In each&#10;of these cases, all newly created blocks (which are subgraphs of the old&#10;block with the contracted edge) satisfy the condition of&#10;Definition \[ref:Gkdefi\], completing our proof.&#10;&#10;We now proceed with the proof of the main result of this paper,&#10;Theorem \[thm:main\]. Recall that there are labelled trees with vertices&#10;and consequently rooted labelled trees. The exponential generating&#10;function associated with rooted labelled trees is sometimes called the&#10;TREE FUNCTION: The tree function is closely related to the LAMBERT&#10;-FUNCTION, which is defined using the functional equation . This&#10;equation defines a multivalued function, and if we let denote its&#10;principal branch, we can express as the power series , see . Thus we&#10;have . Hence satisfies the functional equation .&#10;&#10;The exponential generating function for unrooted (labelled) trees is&#10;given by Note here that represents rooted trees, while is the&#10;exponential generating function for edge-rooted trees (equivalent to&#10;unordered pairs of rooted trees). Since the number of vertices of a tree&#10;is always the number of edges plus , the difference yields exactly the&#10;exponential generating function for unrooted trees. A forest is a&#10;collection of trees, hence the exponential generating function&#10;associated with the class of all forests is . We will denote the class&#10;of all labelled unrooted trees by and the class of all labelled forests&#10;by .&#10;&#10;In the following, we need bivariate versions of that also involve the&#10;number of leaves: let , and be those three exponential generating&#10;functions, where the exponent of equals the number of leaves. The&#10;symbolic method described in Part A of  can be used to obtain functional&#10;equations for these functions. First of all, we have (cf. ) which&#10;follows from the fact that the number of leaves of a rooted tree equals&#10;the sum of the number of leaves over all its branches (the root only&#10;counts as a leaf in this context if it is the only vertex), unless the&#10;tree consists of the root only. The last term takes this into account.&#10;The functional equation  has the explicit solution Furthermore, we have&#10;the explanation being similar to : the first term stands for rooted&#10;trees. The second term corrects for the fact that we did not let the&#10;root count as a leaf in unless it was the only vertex. The last term&#10;represents edge-rooted trees. Finally, since forests are simply&#10;collections of trees, we have In the following, we will make use of the&#10;fact that is analytic in the complex plane, except for a branch cut&#10;along the positive real axis, starting at . Its asymptotic expansion at&#10;the branch point is given by (see ) valid in an any fixed neighbourhood&#10;of the branch point with the real numbers greater than removed. This&#10;will allow us to apply the principles of singularity analysis to some of&#10;the generating functions we encounter. It will be important later that&#10;the term involving vanishes in the generating function as given in : a&#10;simple calculation shows that&#10;&#10;Now let be the exponential generating function associated with blocks in&#10;, and let be the exponential generating function for the “second type”&#10;of blocks in , i.e., 2-connected graphs that can be reduced to a forest&#10;by removing at most vertices. This set of graphs is denoted by . In our&#10;first lemma, we bound the number of elements of , which in turn gives an&#10;estimate for the radius of convergence.&#10;&#10;\[lem:upper\] Let be the smallest positive solution to the equation .&#10;There exists a positive constant (depending on ) such that contains at&#10;most elements with vertices for all positive integers .&#10;&#10;Every element of that is not just a single edge consists of a forest and&#10;additional vertices, ; each leaf of the forest needs to be adjacent to&#10;at least one of the additional vertices, for otherwise the minimum&#10;degree would be , making it impossible for the graph to be -connected.&#10;Let denote the number of leaves of . Given and , there are possibilities&#10;for the edges between the additional vertices, there are possible ways&#10;to connect a leaf of to the additional vertices (any possible set of&#10;edges except for the empty set) and possible ways to connect each other&#10;vertex of . Therefore, an upper bound for the number of elements of with&#10;vertices is given by (the binomial coefficient takes the possible ways&#10;to assign labels to the special vertices into account). Note that this&#10;is indeed just an upper bound rather than the exact number: not all&#10;graphs obtained in this way are -connected, and there is also some&#10;double-counting, see the discussion in the following lemma. The&#10;exponential generating function associated with this estimate is Note&#10;that has positive coefficients, so by Pringsheim’s Theorem it must have&#10;a positive real singularity on its circle of convergence. In view of , &#10;and , inherits its singularities from Note that is real if and only if&#10;either is real or is of the form for some real . Since , the only part&#10;of the open unit disk that is mapped to the real axis by the function is&#10;the real interval . Moreover, this function is increasing on . It&#10;follows that the function is analytic on the unit disk, except for a&#10;branch cut along the positive real axis starting at the solution of the&#10;equation .&#10;&#10;Since this is decreasing as a function of , the term in  dominates the&#10;rest. Now combine  and  to obtain Now we can make use of . Observe also&#10;that we have the Taylor expansion around the point . Putting everything&#10;together, we find that for a constant (that can also be determined, but&#10;it is irrelevant for us). Finally, in view of , Recall that all terms&#10;with in  are asymptotically irrelevant since their smallest&#10;singularities are all greater than . The factor in  results in an&#10;additional factor in the dominant singular term of order . Hence we&#10;obtain that for suitable constants . Specifically, . This is valid in&#10;the intersection of a neighbourhood of with the slit plane that has all&#10;real numbers greater than removed. Apart from this branch cut, is an&#10;analytic function for . Hence yields as , which implies the desired&#10;result.&#10;&#10;Next, we provide a lower bound for that is of the same order as the&#10;upper bound of Lemma \[lem:upper\].&#10;&#10;\[lem:lower\] Let be as defined in the previous lemma. There exists a&#10;positive constant (depending on ) such that contains at least elements&#10;with vertices for all sufficiently large positive integers .&#10;&#10;We provide a matching lower bound in a similar way as in the previous&#10;lemma. Consider the set of all graphs consisting of a tree and a&#10;complete graph and a number of additional edges, each with one end in&#10;and the other in , such that each leaf of is adjacent to at least one of&#10;the vertices in the complete graph. We show that almost all of these&#10;graphs belong to , i.e., they are -connected. Later, we derive a lower&#10;bound for the number of graphs in , which in turn yields a lower bound&#10;for the number of elements of .&#10;&#10;Consider an element of : we show that it is -connected unless an&#10;exceptional situation occurs. Indeed, if one of the tree vertices is&#10;removed, the tree decomposes into several connected components, each of&#10;which contains at least one leaf. Since each of the leaves needs to be&#10;adjacent to at least one of the vertices of the complete graph, the&#10;resulting graph is still connected. On the other hand, if one of the&#10;vertices of the complete graph is removed, the remaining graph consists&#10;of a tree and a complete graph (both of which are connected graphs), and&#10;these two graphs are still connected by at least one edge unless all&#10;edges connecting to the complete graph lead to the same vertex. Since&#10;this is the only scenario for which is not -connected, we can expect&#10;most elements of to be -connected. We will prove this below by obtaining&#10;the exponential generating function for the non--connected elements of .&#10;&#10;First, we can use the same reasoning that gave us  to find that the&#10;exponential generating function for the set of graphs is which has the&#10;same dominant singularity and an asymptotic expansion of the same form&#10;as , albeit with other coefficients. Hence the coefficients of satisfy&#10;an asymptotic formula of the form  (with a different multiplicative&#10;constant).&#10;&#10;However, some more care is needed to complete the proof: firstly, we&#10;need to subtract those graphs that are not -connected because one of the&#10;vertices of the complete graph is an endpoint of all connecting edges.&#10;There must be an edge between this vertex and all leaves, and there&#10;might be further edges between this vertex and other tree vertices, but&#10;no other edges connecting the tree and the complete graph. Hence the&#10;exponential generating function for such graphs is which has a greater&#10;radius of convergence (namely ) than , hence its coefficients are&#10;negligibly small.&#10;&#10;The second issue we need to take into consideration is the potential&#10;double-counting: for a given graph in , the vertices forming the&#10;complete graph may not be unique. We will show, however, that this only&#10;happens for a very small proportion of graphs in .&#10;&#10;To this end, we consider the degrees of the vertices. Among all the&#10;possible combinations consisting of a tree, a complete graph and edges&#10;between the two as described above, pick one at random. The distribution&#10;of the degree of a vertex of the complete graph is almost a binomial&#10;distribution, meaning that the degree is concentrated around . Consider&#10;e.g. the probability that such a vertex has degree at most . The fact&#10;that the vertex is connected by an edge to all other vertices of the&#10;complete graph by default, and the fact that the probability to be&#10;connected to a leaf by an edge is slightly above , only decrease this&#10;probability compared to the binomial distribution. For the binomial&#10;distribution, we find the probability to be at most using the Chernoff&#10;bound for , which is exponentially small in . So the vertices that form&#10;the complete graph have a degree of at least for all but a negligible&#10;set of combinations.&#10;&#10;On the other hand, let us estimate the number of combinations for which&#10;a tree vertex has large degree, say at least . A simple upper bound will&#10;suffice: there are ways to distribute the labels, choices for the vertex&#10;with large degree, and at most possibilities for the edges between tree&#10;and complete graph. The number of labelled trees with vertices for which&#10;a fixed vertex has degree is (by ). Hence we have the upper bound which&#10;by Stirling’s formula is also negligibly small compared to . It follows&#10;that for all but a negligible set of combinations, the vertices of the&#10;complete graph are the only vertices whose degree is at least , which&#10;means that they are unique. This completes the proof of the lower bound.&#10;&#10;\[cor:Bk\] For , the exponential generating function associated with the&#10;set of all possible blocks of graphs in has radius of convergence .&#10;Moreover,&#10;&#10;We make use of the results of Giménez and Noy on the enumeration of&#10;planar graphs. Specifically, the number of -connected labelled planar&#10;graphs with vertices is asymptotically given by for and . Since for , it&#10;follows that the planar blocks form a negligible portion of , as the&#10;number of elements in grows exponentially faster. The statement on the&#10;radius of convergence and the behaviour of the second derivative now&#10;follow immediately from the previous two lemmas.&#10;&#10;Now we are ready to complete the proof of the main theorem.&#10;&#10;It is well known (see or ) that a function that satisfies a functional&#10;equation of the form , where has positive coefficients, has a dominant&#10;square root singularity at , where is the positive real solution to the&#10;equation , provided such a solution exists inside the circle of&#10;convergence of .&#10;&#10;In our situation, where we consider the exponential generating function&#10;of rooted connected graphs in , we can let in view of , so the equation&#10;reduces to . In view of Corollary \[cor:Bk\], we have . Since we also&#10;have and is continuous and increasing as a function of , it follows from&#10;the intermediate value theorem that there is indeed a unique value such&#10;that .&#10;&#10;Consequently, has its dominant square root singularity at , and . This&#10;proves that is a subcritical family.">
</outline>
<outline text="The probability of 2-connectedness" _note="In the previous section we obtained asymptotics for the number of&#10;2-connected -apex forests with vertices. The corresponding asymptotics&#10;for the number of all -vertex -apex forests, not necessarily&#10;2-connected, was determined by Kurauskas and McDiarmid :&#10;&#10;\[KMtheorem\] , where and .&#10;&#10;(Unlike our Lemmas \[lem:upper\] and \[lem:lower\] that leave the&#10;constants and unknown, this result provides an exact constant .)&#10;&#10;Comparing this with Lemmas \[lem:upper\] and \[lem:lower\] immediately&#10;yields the asymptotics of the probability for the uniform random -vertex&#10;-apex forest to be 2-connected:&#10;&#10;The uniformly random -apex forest with vertices is 2-connected with&#10;probability satisfying where is defined as the smallest positive&#10;solution to the equation .&#10;&#10;We remark that it is not straightforward to deduce Lemmas \[lem:upper\]&#10;and \[lem:lower\] from Theorem \[KMtheorem\] using the typical number of&#10;leaves of a uniform random forest and the fact that a -apex forest can&#10;only be 2-connected if each leaf of its underlying forest is connected&#10;to at least one of the apex vertices: calculations show that the rate of&#10;decay of is not determined by the typical number of leaves of the&#10;uniform random forest with vertices (for the uniform random tree the&#10;number of leaves divided by converges in probability to , and this&#10;remains true for the uniform random forest), and is hence influenced by&#10;the ‘unlikely’ forests with much fewer leaves.">
</outline>
<outline text="Extension to all minor-closed families of graphs" _note="Looking back over the above proof, we observe that very little&#10;information about the family of planar graphs was actually used: we only&#10;used the fact that it is minor-closed (in the proof of&#10;Proposition \[prop\_add\_mc\]), and that its exponential generating&#10;function has a non-zero radius of convergence (in the proof of&#10;Corollary \[cor:Bk\]). By a theorem of Norine, Seymour, Thomas and&#10;Wollan , every proper minor-closed family of graphs has the property&#10;that the number of labelled graphs in the family satisfies the&#10;inequality for some positive constant . Hence we can immediately extend&#10;Theorem \[thm:main\] as follows.&#10;&#10;\[thm:general\] Every proper minor-closed family of graphs is contained&#10;in a minor-closed, addable, subcritical family of graphs.&#10;&#10;Analogous to the proof of Theorem \[thm:main\]: consider the family of&#10;graphs whose blocks are either single edges, -connected graphs in , or&#10;-connected -apex forests, and take large enough so that (which is&#10;possible since as ). The resulting family will be minor-closed, addable,&#10;and subcritical.&#10;&#10;In view of Theorem \[thm:general\], there is little hope to achieve a&#10;full characterisation of minor-closed subcritical graph classes in terms&#10;of their forbidden minors. However, as mentioned earlier, it is still&#10;plausible that the other direction of Noy’s conjecture holds, i.e. that&#10;every addable, minor-closed graph class with a forbidden planar minor is&#10;subcritical.">
</outline>
  </body>
</opml>