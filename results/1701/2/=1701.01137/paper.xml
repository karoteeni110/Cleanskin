<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>An architecture for efficient gravitational wave parameter estimation
with multimodal linear surrogate models</title>
    <abstract>The recent direct observation of gravitational waves has further
emphasized the desire for fast, low-cost, and accurate methods to infer
the parameters of gravitational wave sources. Due to expense in waveform
generation and data handling, the cost of evaluating the likelihood
function limits the computational performance of these calculations.
Building on recently developed surrogate models and a novel parameter
estimation pipeline, we show how to quickly generate the likelihood
function as an analytic, closed-form expression. Using a straightforward
variant of a production-scale parameter estimation code, we demonstrate
our method using surrogate models of effective-one-body and numerical
relativity waveforms. Our study is the first time these models have been
used for parameter estimation and one of the first ever parameter
estimation calculations with multi-modal numerical relativity waveforms,
which include all modes. Our grid-free method enables rapid parameter
estimation for any waveform with a suitable reduced-order model. The
methods described in this paper may also find use in other data analysis
studies, such as vetting coincident events or the computation of the
coalescing-compact-binary detection statistic. </abstract>
  </head>
  <body>
<outline text="Introduction" _note="On September 14, 2015, at 09:50:45 UTC, the Laser Interferometer&#10;Gravitational-Wave Observatory (LIGO) made the first direct observation&#10;of a gravitational-wave signal from two coalescing black hole binaries .&#10;By systematically comparing the signal against approximations to the&#10;solutions of Einstein’s equations, the properties of the coalescing&#10;black hole binary were inferred . Similar binary black hole systems will&#10;be detected in coming years , at a rate of up to one per day by advanced&#10;LIGO and Virgo. These discoveries will revolutionize our understanding&#10;of astrophysics (see, e.g., Refs.  and references therein) and provide&#10;tests of gravitational theory to unprecedented accuracies in the regime&#10;of strong-field dynamics with relativistic velocities .&#10;&#10;The vigorous pace of discovery, combined with the tantalizing&#10;opportunities afforded by low-latency and coordinated multimessenger&#10;observations , demand equally rapid inference: LIGO and its&#10;electromagnetic partners should prepare to reliably reconstruct the&#10;source parameters of coalescing binaries as fast as possible .&#10;Especially when using the best-available waveform models, these&#10;calculations can be very costly; see, e.g., .&#10;&#10;Several strategies have been developed to reduce the computational cost&#10;of parameter estimation . Approaches that have appeared in the&#10;literature include generating the approximate solutions more quickly ;&#10;interpolating some combination of the waveform or likelihood ; or&#10;adopting a sparse representation to reduce the computational cost of&#10;data handling . Some methods, however, achieve rapid turnaround through&#10;simplifying approximations. Two rapid strategies eschew significant&#10;approximation: reduced-order models (ROMs), a term we shall use&#10;interchangeably with surrogate models, and refactored likelihoods.&#10;&#10;A surrogate model provides an efficient and highly accurate&#10;representation for the gravitational wave strain. Surrogate models have&#10;been applied to reproduce the radiation from complicated sources,&#10;including long duration signals , arbitrarily many harmonic modes ,&#10;spinning binary systems , precessing binary systems , and neutron star&#10;models with tidal effects . Moreover, as we describe in this paper,&#10;calculations that arise naturally in parameter estimation studies can be&#10;expressed in terms of simple, precomputed quantities constructed from&#10;the reduced-order representation. The result is a dramatic reduction in&#10;the number and complexity of operations needed to carry out&#10;gravitational-wave inference. Similarly, Pankow et al. (henceforth&#10;[ILE]{}, a shorthand for “integrate likelihood over the extrinsic&#10;parameters”) expressed the gravitational-wave strain using the natural&#10;basis provided by a spin-weighted spherical harmonic decomposition of&#10;the waves. By almost eliminating overhead from data handling (e.g., the&#10;cost of performing Fourier transforms and inner products needed to&#10;evaluate ), this representation allows for rapid likelihood evaluations,&#10;enabling direct Monte Carlo integration over all “fast” variables (e.g.,&#10;extrinsic parameters corresponding to the spacetime location and&#10;orientation of the binary, which leave the binary’s intrinsic dynamics&#10;unchanged). The ILE framework was recently applied in , to directly&#10;compare GW150914 against numerical simulations of Einstein’s equations,&#10;without any intermediate approximation.&#10;&#10;In this work, we demonstrate that these two approaches can and should be&#10;naturally unified, dramatically enhancing overall performance. This&#10;combination increases the performance of [ILE]{} by removing the need&#10;for a brute-forced grid-based exploration of the intrinsic parameter&#10;space, which can be a source of error. Additionally, we present the&#10;first parameter estimation results using multimodal numerical relativity&#10;surrogates.&#10;&#10;This paper is organized as follows. In Section \[sec:Methods\] we&#10;introduce the likelihood calculation (Section \[sec:sub:PEBackground\]),&#10;describe how to refactor the log-likelihood for efficient use of&#10;reduced-order gravitational-wave models (Section \[sec:sub:Refactor\]),&#10;and implement our procedure as a simple extension of an existing,&#10;production scale parameter estimation pipeline by interfacing this&#10;pipeline with low-level surrogate data-access tools (Section&#10;\[sec:sub:Implementation\]). Section \[sec:Results\] demonstrates the&#10;method using end-to-end comparisons with the traditional [ILE]{}&#10;framework. For simplicity and to facilitate illustrations and&#10;comparisons, we emphasize examples using a previously-reported and&#10;widely available nonspinning, comparable-mass effective-one-body (EOB)&#10;surrogate [^1] provides the exact code snapshot of LAL at the time the&#10;surrogate was built. and a nonspinning numerical relativity surrogate&#10;model  including harmonic modes up to and trained on a mass ratio&#10;interval of , where and are the binary’s component masses.&#10;&#10;[^1]: \[foot:GWS\]This surrogate model, which is distributed with the&#10;    `gwsurrogate` package , was built for the EOB model described in&#10;    Ref.  and implemented in the routine EOBNRv2 as part of the publicly&#10;    available LIGO Analysis Library (LAL) Suite. The git hash&#10;    59c12886b026c863397f191e6c2ca69ef3498616 (available, e.g., at&#10;    `https://github.com/lscsoft/lalsuite`)">
</outline>
<outline text="Methods">
  <outline text="Inference by (Monte Carlo) integration">
    <outline text="Preliminaries" _note="Given a value of the intrinsic parameters (eight parameters&#10;characterizing the two masses and spin vectors) and extrinsic parameters&#10;(four spacetime coordinates for the coalescence event; three Euler&#10;angles for the binary’s orientation relative to the Earth), we can&#10;predict the response of LIGO’s two operational instruments, denoted as ,&#10;to an impinging gravitational wave signal. Assuming a Gaussian,&#10;stationary noise model, we can evaluate the log-likelihood of LIGO’s&#10;network of observatories having recorded a gravitational wave signal.&#10;Except for the overall normalization constant, and omitting calibration&#10;uncertainty, our expression  agrees with Eq. (1) in . Here is the&#10;detector data in instrument , is a noise-weighted inner product implied&#10;by the th-detector’s noise power spectrum , is the Fourier transform of&#10;, denotes complex conjugation of , and is frequency; see, e.g., for more&#10;details. In practice, and as discussed in the next section, we adopt a&#10;low-frequency cutoff such that all inner products are modified to&#10;&#10;A key task of any parameter estimation study is to compute the joint&#10;posterior probability of which follows from Bayes’ theorem. Here and are&#10;priors on the (independent) variables .[^1]&#10;&#10;[^1]: For simplicity, we assume all binary black hole systems are&#10;    equally likely anywhere in the universe, at any orientation relative&#10;    to the detector. Future direct observations may favor a correlated&#10;    distribution, including the formation of more massive black holes at&#10;    larger redshift .">
    </outline>
    <outline text="Fast and slow intrinsic parameters" _note="Following , we partition the intrinsic parameter into “fast” and “slow”&#10;parameters denoted by and , respectively. In principle, this division&#10;depends entirely on the computational cost of waveform generation.&#10;“Fast&quot; parameters are those for which new waveform evaluations can be&#10;quickly generated from existing ones as the value of changes. Typically,&#10;this is accomplished by an explicit, closed-form expression. In the&#10;original ILE study , the fast (slow) parameters were the extrinsic&#10;(intrinsic) parameters. By contrast, for this paper, and as we show for&#10;any other ILE-based investigation using linear surrogates that represent&#10;the scale-free general relativity solution, the only “slow” parameter is&#10;the binary system’s total mass . Having split the intrinsic parameters&#10;into a fast and slow set, we shall now view the likelihood function as .&#10;For a fixed value of , integration over all fast parameters leads to an&#10;intermediate result[^1]: Note that unlike in the original ILE framework,&#10;we have explicitly retained the prior in this expression. For the&#10;[ILE]{} study , included all intrinsic parameters, with being empty. In&#10;that work, a function proportional to was evaluated on a grid;&#10;interpolated, fitted, or otherwise approximated; and hence used to&#10;generate the posterior as a function of which follows by integrating Eq.&#10;(\[eq:Posterior:General\]) over and .[^2] The denominator of this&#10;quantity, the (Bayesian) evidence for our model, can be used to assess&#10;how well our model fits the data. The ILE grid-based design was intended&#10;to minimize the severe computational cost of evaluating waveforms at&#10;different values of . In Sec. \[sec:sub:Refactor\], we show how linear&#10;surrogate models remove any need for expensive, high-dimensional grids.&#10;If the integral appearing in Eq.  is performed by direct Monte Carlo&#10;integration, and this computation is repeated on a dense and uniform&#10;grid in (here, , the total binary mass), the posterior may be estimated&#10;using a fit-free method. ILE used this same method – henceforth denoted&#10;ILEMC – to infer posterior distributions in . Assuming we have random&#10;samples drawn from a sampling distribution at fixed value of , then the&#10;numerical approximation to the true marginalized likelihood computed by&#10;Monte Carlo integration is:&#10;&#10;\[eq:MonteCarlo\]&#10;&#10;We repeat this process for a uniform grid in , using the same number of&#10;samples, N, each time. As a result and in particular, we can estimate&#10;the true one-dimensional cumulative distribution by the numerical&#10;approximation : i.e., by a Monte Carlo integral over the interval . Here&#10;can be any parameter in or , indexes the Monte Carlo samples over the&#10;union of all of the values of , refers to the value of parameter for the&#10;th sample, and is the Heaviside step function. Using higher-dimensional&#10;weighted density estimates (e.g., kernel density estimators or weighted&#10;histograms), we can likewise estimate the joint posterior distribution&#10;in any set of dimensions, with sufficiently dense sampling.&#10;&#10;[^1]: In general the prior in will not be separable: the range of&#10;    allowed mass ratios will depend on total mass, for example.&#10;&#10;[^2]: Note that in this expression (and in contrast to the notation in&#10;    ), our expression for includes the prior over , allowing us to&#10;    employ the same expression for the posterior to describe the method&#10;    used in this work and in .">
    </outline>
  </outline>
  <outline text="Refactored likelihood for linear surrogates">
    <outline text="Surrogate-enabled ILE" _note="A complex gravitational-wave strain can be expressed in terms of its two&#10;fundamental polarizations and . Here, denotes time, and are the polar&#10;and azimuthal angles for the direction of gravitational wave propagation&#10;away from the source. The complex gravitational-wave strain can be&#10;written in terms of spin-weighted spherical harmonics as where the sum&#10;includes all harmonic modes made available by the model; where is a&#10;fiducial reference distance; and where , the luminosity distance to the&#10;source, is one of the extrinsic parameters.&#10;&#10;Following a standard ROM prescription, we assume access to a [LINEAR]{}&#10;surrogate model for each harmonic mode associated with some fiducial&#10;distance , which can be expressed as a [LINEAR]{} expansion in a set of&#10;reduced basis functions . Different surrogate modeling techniques&#10;prescribe different approaches for the coefficients – these details need&#10;not concern us here. Crucially, this decomposition naturally identifies&#10;the “fast” and “slow” intrinsic parameters. Since the time and total&#10;mass are coupled through the basis functions, , we are unable to “pull&quot;&#10;out of the inner products (cf. Eq. ); computing the likelihood for new&#10;values of will require the computation of many slow overlap integrals.&#10;Conversely, as the remaining intrinsic parameters only enter through the&#10;expansion coefficients, , computing the likelihood for new values of is&#10;accomplished with fast evaluations of these coefficients (cf. Eq. ).&#10;This approach requires that the coefficients are given by a known,&#10;closed-form expression and the model’s temporal and parametric&#10;dependence has an affine factorization of Eq. . In particular, this&#10;restriction precludes surrogate models whose temporal dependence has a&#10;[NON-LINEAR]{} relationship to the basis (say, by an amplitude and phase&#10;decomposition). As described later on, we do not believe this to be any&#10;real restriction in practice since all surrogates can be brought into&#10;the form . Indeed, the numerical relativity surrogate model used in this&#10;paper , expressed as two independent linear expansions of the amplitude&#10;and phase of each mode , was originally in a format incompatible with&#10;the representation .&#10;&#10;Following , we substitute expression  for into the expression for the&#10;detector response , where is the arrival time at the th detector (at&#10;position ) for a plane wave propagating along and is the time of&#10;coalescence . We then substitute these expressions for into the&#10;likelihood function  thereby generating &#10;&#10;where where are the complex-valued detector response functions of the th&#10;detector and the quantities depend on and the data as&#10;&#10;\[eq:QUV\]&#10;&#10;Finally, substituting  into while fixing the value of , we find that all&#10;three parameter-dependent functions can be expressed in terms of the&#10;surrogate interpolating functions, , and correlations between the&#10;reduced basis functions and data:&#10;&#10;\[eq:QuantitiesViaSurrogate\]&#10;&#10;Here is a time-translation operator . In other words, after a handful of&#10;inner product evaluations that can be computed once and for all, the&#10;likelihood can be subsequently evaluated for all intrinsic parameters&#10;ANALYTICALLY, as are known analytic expressions (made directly available&#10;by the surrogate model) and are easily tabulated arrays.">
    </outline>
    <outline text="Discussion and further compression" _note="Equation  needs to be evaluated for each basis function in the surrogate&#10;model. Current multimodal surrogates (including the surrogates employed&#10;here) treat each mode independently, so the total number of basis&#10;functions grows with the number of modes as well as the number of basis&#10;functions per mode. For example, in some of our parameter estimation&#10;studies we use a non-spinning NR surrogate that contains modes and about&#10;basis per mode, implying an enormous number of inner products .&#10;&#10;The basis size can be reduced three ways. Our procedure follows a&#10;combination of the first two observations described below; we hope to&#10;explore the final approach (which requires building a new surrogate&#10;model) in future work.&#10;&#10;First, we can eliminate superfluous modes from our expansion; for&#10;example, the mode is rarely practically relevant (i.e., ; cf. the&#10;caption of Fig. \[fig:basis\_convergences\]). Our ILE implementation&#10;automatically eliminates modes which are unlikely to be relevant, based&#10;on a reference set of parameters provided by the gravitational wave&#10;search. Second, we can easily reduce the number of basis elements needed&#10;per mode. As shown in Fig. \[fig:basis\_convergences\], surrogate errors&#10;typically converge exponentially and employ an excessively accurate&#10;basis (often with overlap errors around ) for parameter estimation&#10;purposes. So the basis size can be reduced by as much as a factor of 2&#10;in our case without a significant loss in accuracy.[^1] To be concrete,&#10;Eq.  can be expressed in terms of orthogonal basis functions, , which&#10;are related to the basis functions, , by a linear transformation, . The&#10;transformation matrix is a necessary part of the surrogate building&#10;process  and is readily available for use by the ILE codes. In the&#10;orthogonal representation, the basis elements are ordered by&#10;significance; we can therefore dramatically reduce the number of basis&#10;elements needed, by adopting a basis size suitable to the comparatively&#10;lower accuracy needed for our calculations. For simplicity and&#10;modularity, however, our current implementation uses Eq.&#10;(\[eq:QuantitiesViaSurrogate\]) directly, without additional&#10;refactoring. Instead, our current implementation can drop higher-order&#10;(orthogonal) basis functions before the computation of and hence Eq. .&#10;&#10;Finally, we can reduce the overall set of by using another surrogate&#10;construction procedure, employing the same basis set for all the modes.&#10;This straightforward second-generation surrogate should require fewer&#10;basis coefficients, particularly since modes with the same harmonic&#10;index share similar frequency content at early times.&#10;&#10;[^1]: To assess just how excessively accurate these surrogate model&#10;    constructions can be, we compare the typical accuracy shown in Fig.&#10;    (\[fig:basis\_convergences\]) to the largest mismatch error that&#10;    could introduce a significant deviation into a parameter estimation&#10;    posterior: an overlap error of order . This nominal overlap error is&#10;    also often significantly smaller than other systematic effects&#10;    associated with intrinsic NR error due to finite resolution and&#10;    extraction, as well as to effects associated with the neglect of&#10;    higher-order modes.">
    </outline>
    <outline text="Implementation considerations" _note="Our approach requires the surrogate model to be expressed as a linear&#10;combination of basis elements. However, not all surrogates have this&#10;form. For example, some models are built to separately reconstruct the&#10;amplitude and phase of see, e.g., . That said, any surrogate can be used&#10;to train a secondary “surrogate-of-a-surrogate&quot; that has the necessary&#10;form given by Eq. . We have found that building a secondary surrogate is&#10;significantly easier than the original surrogate since (i) the waveform&#10;training data is already aligned \[i.e., the surrogate-builder does not&#10;need to duplicate the effort needed to establish a consistent definition&#10;of the event time\][^1] and (ii) arbitrarily many waveform evaluations&#10;can be supplied by the primary surrogate. Moreover, several modern&#10;surrogates are already expressed in as a linear combination of basis to&#10;enable their use in reduced-order-quadrature methods . Our method can&#10;therefore be applied to all available surrogates without loss of&#10;generality.&#10;&#10;As described in , the `gwsurrogate` package  provides an interface to&#10;generic surrogates for gravitational wave radiation from coalescing&#10;binaries. As part of this paper, we have extended gwsurrogate’s API to&#10;allow for a convenient interface with low level surrogate waveform data&#10;as needed by the surrogate-enabled ILE pipeline. In this work we will&#10;demonstrate our method using one of the surrogates provided with it: a&#10;zero-spin, equal-mass surrogate tuned to the nonspinning&#10;effective-one-body model . For each total mass , we can extract the&#10;basis functions and construct the inner products appearing in Eq.&#10;(\[eq:QuantitiesViaSurrogate\]), once and for all. To evaluate the&#10;likelihood any mass ratio and extrinsic parameters , we use the [ILE]{}&#10;likelihood \[Eq. (\[eq:def:lnL:Decomposed\])\], where are evaluated&#10;using Eq. (\[eq:QuantitiesViaSurrogate\]) and the coefficients are&#10;provided by our surrogate model.&#10;&#10;[^1]: In our case, the initial surrogate was aligned so that the maximum&#10;    of occurs at ; see Eq. (2) in Ref. .">
    </outline>
  </outline>
  <outline text="Two methods to infer parameters" _note="In Sec. \[sec:Results\] we will directly compare two ILE-type approaches&#10;to infer parameters: traditional ILE  and its extension developed here.&#10;While both methods have been presented for generic binary black hole&#10;systems, the parameter estimation results of Sec. \[sec:Results\] are&#10;for non-spinning binaries. And so, for concreteness, we briefly&#10;summarize these methods when specialized to such systems.&#10;&#10;**Traditional ILE.** We use ILE to (i) evaluate by direct Monte Carlo&#10;integration, (ii) fit this function, as  [^1], and then (iii) integrate&#10;to evaluate the posterior.&#10;&#10;In contrast to given by Eq. , which is a function only of the total&#10;binary mass and which in this work is used only for normalization, the&#10;function depends on all intrinsic binary parameters .&#10;&#10;We perform the integration carried out in the third step via Monte&#10;Carlo, using a uniform prior density in such that each component mass is&#10;greater than and the total mass is less than . The prior’s boundary is&#10;defined by a right triangle with verticies at , , and \], so in this&#10;region . In an coordinate system, in the region consistent with our&#10;constraints this prior has the form . The extra factor of 2 arises by&#10;compressing the two regions and into a single region in the plane (i.e.,&#10;by requiring or .) **ILEMC.** In the new approach described in this&#10;paper, we perform the Monte Carlo procedure described in Eq.&#10;(\[eq:MonteCarlo\]) for a dense and uniform grid in total mass ().&#10;One-dimensional posterior distributions are found via&#10;Eq.(\[eq:MCPosterior:1d\]).&#10;&#10;To be concrete, in Sec. \[sec:Results\] our numerical experiment will be&#10;to (i) generate a specific list of candidate signals, (ii) prepare mock&#10;data for the expected LIGO response, and finally (iii) apply the&#10;traditional ILE and ILEMC procedures to these synthetic datasets. We&#10;assume both instruments operate at the LIGO O1 sensitivity . We analyze&#10;data segments of 32s in duration sampled at a rate of Hz. Our candidate&#10;signals are nonspinning black hole binaries, with an inclination of (in&#10;the first case) or (in the remaining cases) relative to the line of&#10;sight, and with the distance D scaled so the network signal-to-noise&#10;ratio is or . For simplicity, all candidate signals have been generated&#10;with a multimodal effective-one-body model for nonspinning binary black&#10;holes , henceforth denoted EOBHM. The EOB surrogate model used in this&#10;paper has been trained on EOBHM , but for signal injection we continue&#10;to use the original EOBHM model. The original EOBHM model is also used&#10;for parameter estimation with the traditional ILE method while the ILEMC&#10;will always use the surrogate model in its analysis. The likelihood&#10;calculation uses frequencies between and . A template’s duration depends&#10;on the model. For EOBHM, the (2,2) mode starts at , to insure mode&#10;starts before 20 [ [Hz]{}]{}. For the ROM, the entire dimensionless&#10;surrogate model is used when computing Eq.  so the starting frequency&#10;depends on the binary mass; for a sense of scale, at and , the mode has&#10;a starting frequency of roughly .&#10;&#10;[^1]: To ensure robust results, we have employed both low-order&#10;    polynomial and Gaussian process fits; our results do not change&#10;    significantly (i.e., the average difference between two cumulative&#10;    distribution function estimates is a few percent over the interval&#10;    shown in our figures).">
  </outline>
</outline>
<outline text="Demonstrations" _note="Figures \[fig:Results\] and \[fig:Results:2\] compare results obtained&#10;by traditional ILE and ILEMC applied to identical sources, summarized in&#10;Table \[tab:Parameters\], using a range of candidate models that may&#10;include or omit higher order modes. Section \[sec:sub:Implementation\]&#10;provides a complete description of the demonstration’s setup.">
  <outline text="Single mode, non-spinning EOB surrogate model" _note="Figure \[fig:Results\] shows two cumulative posterior distributions from&#10;a parameter estimation study performed on a synthetic dataset with&#10;source parameters (entry ID 0) summarized in Table \[tab:Parameters\] –&#10;a configuration motivated by the parameters of GW150914 . The solid red&#10;curve shows the posterior distribution recovered with traditional ILE&#10;and the EOBHM model. The green curve shows the results derived from our&#10;new ILEMC approach and a surrogate trained to reproduce the mode of&#10;EOBHM. Despite the surrogate model ignoring higher harmonic mode content&#10;we expect these two methods to produce nearly-identical posteriors.&#10;Indeed, this choice of inclination angle and mass ratio is well known to&#10;minimize the importance of higher modes. For nearly equal-mass binaries&#10;at this relatively low total mass, previous studies have shown higher&#10;harmonics have negligible impact on parameter estimation; see, e.g., .&#10;&#10;As expected, the red (traditional ILE) and green (ILEMC) curves nearly&#10;agree. The discrete steps apparent in the ILEMC posterior (green) arise&#10;because of the Monte Carlo procedure used to estimate the cumulative; by&#10;contrast, the smooth results produced by traditional ILE follow from&#10;applying a simple approximation to the function . In , this&#10;approximation was a second-order Taylor series approximation near the&#10;peak; in , this approximation was an interpolating function based on a&#10;discrete sampling grid. Here, we have compared parameter estimation (PE)&#10;with and without surrogates, using a surrogate tuned to the same model.&#10;Models like EOB have parameters which have been calibrated against&#10;numerical relativity in a certain region and with a certain accuracy.&#10;They have systematic errors, which grow increasingly significant when&#10;moving away from the region where they have been best-calibrated. For&#10;example, even for these binary parameters – deep inside a&#10;thoroughly-explored region of parameter space – we do not see this level&#10;of agreement when carrying out a similar analysis using other EOB models&#10;.">
  </outline>
  <outline text="Multi-mode, non-spinning EOB and NR" _note="In Figure \[fig:Results:2\] we show results for parameter estimation via&#10;ILE with EOBHM (solid red); via ILE with only the leading-order mode&#10;from EOBHM (dotted red); via ILEMC, with a surrogate which reproduces&#10;the mode of numerical relativity simulations (dotted green); via ILE,&#10;using the same surrogate model (dotted black); and with the same&#10;surrogate but including higher-order modes, via ILE (solid black). The&#10;top panels show a result with ; the bottom panels show results for a&#10;binary with . By design, both scenarios are comparable to cases examined&#10;in with a different parameter estimation engine (e.g., their Fig 9)&#10;using a similar model, albeit at higher SNR.&#10;&#10;First and foremost, the bottom two panels show that, as with Figure&#10;\[fig:Results\], ILEMC and ILE agree when the models do. We compare&#10;calculations performed using the same NR surrogate model, using ILE&#10;(black) and ILEMC (green) for parameter inference parameter inference.&#10;For example, in every panel the dotted black and green lines – two&#10;independent parameter inference methods using the modes of the NR&#10;surrogate – are in good agreement with one another.&#10;&#10;Second, the bottom right panel shows by example that at this binary mass&#10;higher harmonics matter, since the dotted and solid lines do not agree.&#10;As illustrated clearly by directly comparable prior work like , higher&#10;harmonics break degeneracies and improve parameter estimation accuracy.&#10;The good agreement in the bottom panels of Figure \[fig:Results:2\]&#10;persists despite employing a completely different model for the source&#10;and template. Finally, in both the top and bottom panels of Figure&#10;\[fig:Results:2\], we see generally good agreement between the red&#10;curves (PE with ILE, carried out using EOBHM) and the black curves (PE&#10;with ILE, carried out using our NR surrogate). Despite systematic&#10;differences between the NR surrogate and EOBHM, in most cases this&#10;agreement persists even when higher modes are omitted (dotted lines) or&#10;used (solid lines).&#10;&#10;">
  </outline>
</outline>
<outline text="Conclusions" _note="In this paper, we unified two strategies to accelerate parameter&#10;estimation – surrogate models and factored likelihoods – and implemented&#10;the result in a production-scale environment, ready-to-use on real LIGO&#10;data. Our code can be used with any (time-domain) linear surrogate&#10;model, leveraging parallel efforts to better model the multimodal&#10;gravitational wave signal from coalescing binaries .&#10;&#10;With our existing implementation, we can rapidly reconstruct parameters&#10;of arbitrary sources whose runtime is mostly limited by the cost of a&#10;low-dimensional adaptive Monte Carlo integral. Based on operation&#10;counts, we project parameter estimates could be carried out in seconds&#10;to minutes. When operating at its theoretical limit, this approach can&#10;conceivably provide real-time parameter estimation and Bayesian evidence&#10;factors . These rapid calculations will be helpful to improve current&#10;detection procedures or to supplement investigations into the impact of&#10;non-Gaussian noise (“glitches”) on GW parameter estimation. Finally, as&#10;an illustration of our method’s broad utility, we have demonstrated how&#10;waveform modeling errors can, for sufficiently massive systems ( in&#10;dimensionless units), cause us to draw less sharp and reliable&#10;conclusions about the progenitor’s properties. Our method can make&#10;direct use of high-fidelity surrogate models trained on numerical&#10;relativity waveform data without any approximations to general&#10;relativity and including all harmonic modes resolved by the simulation.&#10;For heavy black holes in particular, where systematic biases are&#10;expected to be the most extreme , we demonstrate by example that&#10;modeling error such as neglecting higher harmonic modes can impact our&#10;interpretation of candidate events.">
</outline>
<outline text="Acknowledgments" _note="We acknowledge helpful discussions with Chad Galley and Rory Smith, Chad&#10;Galley for significant coding effort on the gwsurrogate project, and&#10;both anonymous reviewers for numerous helpful suggestions. R.&#10;O’Shaughnessy was supported by NSF PHY-1505629 and PHY 1607520. S. Field&#10;was partially supported by the NSF under award nos. TCAN AST-1333129 and&#10;PHY-1606654, and by the Sherman Fairchild Foundation. The group&#10;gratefully acknowledges Caltech and AEI-Hannover for computational&#10;resources.">
</outline>
  </body>
</opml>