<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>Enforcing conservation laws in nonequilibrium cluster perturbation
theory</title>
    <abstract>Using the recently introduced time-local formulation of the
nonequilibrium cluster perturbation theory (CPT), we construct a
generalization of the approach such that macroscopic conservation laws
are respected. This is achieved by exploiting the freedom for the choice
of the starting point of the all-order perturbation theory in the
inter-cluster hopping. The proposed conserving CPT is a self-consistent
propagation scheme which respects the conservation of energy, particle
number and spin, which treats short-range correlations exactly up to the
linear scale of the cluster, and which represents a mean-field-like
approach on length scales beyond the cluster size. Using Green’s
functions, conservation laws are formulated as local constraints on the
local spin-dependent particle and the doublon density. We consider them
as conditional equations to self-consistently fix the time-dependent
intra-cluster one-particle parameters. Thanks to the intrinsic causality
of the CPT, this can be set up as a step-by-step time propagation scheme
with a computational effort scaling linearly with the maximum
propagation time and exponentially in the cluster size. As a proof of
concept, we consider the dynamics of the two-dimensional,
particle-hole-symmetric Hubbard model following a weak interaction
quench by simply employing two-site clusters only. Conservation laws are
satisfied by construction. We demonstrate that enforcing them has strong
impact on the dynamics. While the doublon density is strongly
oscillating within plain CPT, a monotonic relaxation is observed within
the conserving CPT. </abstract>
  </head>
  <body>
<outline text="Introduction" _note="A major challenge of the theory of strongly correlated lattice-fermion&#10;models is to predict the real-time dynamics of local observables on a&#10;long time scale. Using exact-diagonalization techniques, i.e., full&#10;diagonalization or Krylov-space methods, only lattices with a small&#10;number of sites can be addressed such that artificial boundary effects&#10;start to dominate the dynamics after a few elementary hopping processes.&#10;Much larger systems are in principle accessible by means of quantum&#10;Monte-Carlo methods, at least in thermal equilibrium. As concerns&#10;real-time dynamics, however, the sign (or complex phase) problem still&#10;prevents a computationally efficient simulation, even for impurity-type&#10;models which are typically sign-problem-free at thermal equilibrium, and&#10;despite substantial progress in the recent past. For impurity and for&#10;one-dimensional systems, recent extensions of the numerical&#10;renormalization group and of the density-matrix renormalization group to&#10;the time domain have been shown to be highly efficient and accurate.&#10;&#10;For lattice models in two or higher dimensions, on the other hand, one&#10;has to resort to approximations, e.g., to the time-dependent variational&#10;principle evaluated with Gutzwiller or with Jastrow-like variational&#10;wave functions. Using a Green’s-function-based approach, on the other&#10;hand, one may also treat the problem within weak-coupling perturbation&#10;theory. Naive perturbative techniques, however, usually violate the&#10;macroscopic conservation laws that result from the continuous symmetries&#10;of the lattice-fermion model. As has been shown by Baym and Kadanoff,&#10;“conserving approximations” can be constructed diagrammatically by&#10;deriving the self-energy from a (truncated) Luttinger-Ward functional&#10;involving, e.g., certain infinite re-summations of diagram classes, and&#10;by calculating the single-particle Green’s function self-consistently.&#10;Due to the necessary approximation of the functional, however, certain&#10;low-order diagrams are neglected which implies that, strictly speaking,&#10;such conserving approximations are usually restricted to the&#10;weak-coupling limit.&#10;&#10;Nonperturbative conserving approximations can either be constructed with&#10;the help of the many-body wave function, or, using Green’s functions,&#10;within the framework of the nonequilibrium generalization of&#10;self-energy-functional theory (SFT). Here, the Green’s function is&#10;self-consistently obtained from an optimal self-energy which makes the&#10;grand potential of the initial thermal state, expressed as a functional&#10;of the nonequilibrium self-energy, stationary. The equilibrium SFT&#10;comprises different approximations, such as the variational cluster&#10;approximation and the dynamical impurity approximation. These techniques&#10;have been extended to real-time dynamics and have been applied recently&#10;to study the dynamical Mott transition in the Hubbard model and a&#10;variant of the periodic Anderson model.&#10;&#10;Another nonperturbative conserving approach, which can be derived within&#10;the SFT framework but has actually been proposed much earlier, is the&#10;(nonequilibrium) dynamical mean-field theory. Being the exact theory in&#10;the limit of infinite spatial dimensions, conservation laws are in&#10;principle naturally satisfied in this case. In practice, however, this&#10;requires the exact solution of a highly nontrivial quantum-impurity&#10;model out of equilibrium. First cluster extensions of the DMFT have been&#10;reported as well. Those combine the mean-field concept with an improved&#10;description of spatial correlations.&#10;&#10;The nonequilibrium extension of cluster-perturbation theory (CPT) is a&#10;strongly simplified variant of a cluster-embedding approach. Still, the&#10;numerical solution of the basic CPT equation is complicated by the&#10;presence of memory effects which are encoded in real-time Green’s&#10;functions within the Keldysh formalism. This is very similar to the&#10;nonequilibrium Dyson or Kadanoff-Baym equations in other diagrammatic&#10;approaches. As has been shown recently, however, the problem can be&#10;mapped exactly onto a noninteracting problem with additional auxiliary&#10;degrees of freedom. Adopting this idea, we could demonstrate that the&#10;CPT real-time dynamics can be understood as a simple Markovian dynamics&#10;of a system of noninteracting fermions but in a much larger&#10;time-dependent bath of virtual degrees of freedom. Using this&#10;reformulation of the CPT, it has been possible to formally study the&#10;real-time dynamics of an inhomogeneous setup in the two-dimensional&#10;Hubbard model consisting of sites up to times of the order of where the&#10;inverse nearest-neighbor hopping serves as the time unit.&#10;&#10;Those plain CPT calculations, however, suffer from a couple of&#10;conceptual problems. The drawback of [ANY]{} mean-field theory is the&#10;missing feedback of certain correlations on the dynamics of the&#10;observables of interest, such as, e.g., the missing feedback of nonlocal&#10;spatial correlations on the local self-energy in the case of the DMFT.&#10;In the case of plain CPT, the situation is even worse as there is no&#10;feedback at all. In particular, plain CPT calculations cannot be&#10;expected to respect the macroscopic conservation laws emerging from the&#10;symmetries of the underlying Hamiltonian. This can be traced back to the&#10;fact that the plain CPT does not contain any element of&#10;self-consistency. Therefore, it is not surprising that a violation of,&#10;e.g., total-energy conservation has been observed.&#10;&#10;With the present study we give a proof of principle that this drawback&#10;can be overcome. We make use of the fact that the CPT can be viewed as&#10;an all-order perturbation theory in the inter-cluster hopping around a&#10;system of decoupled clusters, where the starting point, i.e., the&#10;intra-cluster Hamiltonian, is not at all predetermined. The idea is to&#10;formulate the macroscopic conservation laws as local constraints on the&#10;spin-dependent particle and doublon density. These equations are then&#10;used to fix the intra-cluster one-particle parameters and thereby to&#10;optimize the starting point for the cluster-perturbation expansion. This&#10;defines a novel “conserving cluster-perturbation theory.” The theory is&#10;conserving by construction, it is nonperturbative, and in principle&#10;controlled by the inverse cluster size as a small parameter. In&#10;practice, however, the accessible cluster size is limited by the&#10;exponential growth of the cluster Hilbert space. Hence, conserving CPT&#10;must be seen as a typical cluster mean-field theory which correctly&#10;accounts for nonlocal correlations up to the linear scale of the&#10;cluster. Opposed to standard mean-field theories, the “mean-field” or&#10;the renormalization of the one-particle parameters is determined by&#10;imposing local constraints expressing conservation laws, i.e., it is&#10;finally the symmetries of the lattice model which dictates the&#10;time-dependent cluster embedding. As the theory relies on [LOCAL]{}&#10;self-consistency or conditional equations, it can easily be extended to&#10;inhomogeneous models or inhomogeneous initial states.&#10;&#10;While the underlying idea is conceptually simple, its practical&#10;realization requires a couple of new theoretical concepts which are&#10;discussed here in detail. In particular, the implementation of a causal&#10;time-stepping algorithm requires a careful analysis to which order the&#10;renormalization of the intra-cluster parameters at a certain time slice&#10;enters the conditional equations. We are able to demonstrate that an&#10;efficient numerical implementation of the theory is possible and discuss&#10;first results for weak interaction quenches in a two-dimensional Hubbard&#10;model. The algorithm scales linearly with the propagation time and&#10;exponentially in the cluster size. Conservation laws are satisfied with&#10;numerical accuracy. Yet, long time scales cannot be achieved with the&#10;present implementation due to singular points which are found to evolve&#10;during the time propagation.&#10;&#10;The next section briefly states the model and the necessary elements of&#10;the Keldysh formalism. Section \[sec:prep\] introduces the CPT and&#10;discusses the formulation of the local constraints. The mapping onto a&#10;noninteracting auxiliary problem is described in&#10;Sec. \[sec:hamiltonian\_based\]. The main theoretical work addresses the&#10;solution of the local constraints for the optimal starting point of the&#10;all-order perturbation theory. This is presented in&#10;Sec. \[sec:solve\_for\_lambda\]. Numerical results are discussed in&#10;Sec. \[sec:num\], and the conclusions are summarized in&#10;Sec. \[sec:con\].">
</outline>
<outline text="Model and nonequilibrium formalism" _note="We consider the single-band, fermionic Hubbard model on an arbitrary&#10;lattice with a time-dependent hopping matrix and interaction strength .&#10;The hopping is assumed as spin-diagonal for simplicity. The Hamiltonian&#10;reads where the operators () create (annihilate) a fermion with spin at&#10;site (), and where denotes the spin-dependent local density operator. At&#10;time , the system is assumed to be in thermal equilibrium with inverse&#10;temperature and chemical potential . Nonequilibrium real-time dynamics&#10;for is initiated by the time dependence of the hopping matrix or the&#10;interaction strength. In principle, this covers challenging experimental&#10;setups such as time-resolved photoemission spectroscopy or experiments&#10;with ultracold gases in optical lattices.&#10;&#10;Our central quantity of interest is the one-particle Green’s function&#10;which is defined as Here “” traces over the Fock space, i.e., we take&#10;averages using the grand-canonical ensemble. defines the grand-canonical&#10;partition function and the time-ordering operator on the&#10;Keldysh-Matsubara contour . The time variables and are thus understood&#10;as contour times. An in-depth introduction to the Keldysh formalism can&#10;be found in Refs., . Throughout the text we use the convention that&#10;operators with a hat carry a time dependence according to the Heisenberg&#10;picture, i.e., , where , for , is the system’s time-evolution operator&#10;and the time-ordering operator. The dependence of the Green’s function&#10;on and is made explicit in the notation using subscripts, i.e., , where&#10;convenient. A similar notation is also used for other quantities.&#10;&#10;Through Dyson’s equation, the Green’s function is linked to the&#10;self-energy where is the noninteracting propagator. Its (contour)&#10;inverse is In Eq. (\[eq:dyson\]) we made use of the shorthand notation&#10;“” for the convolution of contour matrices. In particular Note that in&#10;this context we implicitly assume a contour Dirac delta function present&#10;in case of time-local quantities. For example, should be replaced by in&#10;a contour convolution, so that&#10;&#10;Combining Dyson’s equation with the equation of motion for the&#10;one-particle Green’s function, we get where is the two-particle Green’s&#10;function and where indicates a flip of the spin index , i.e., and vice&#10;versa. Analogously to Eq., we furthermore have where is defined as The&#10;local doublon density can be expressed through the two-particle Green’s&#10;functions as with being infinitesimally “later” than in the sense of&#10;time ordering on the Keldysh-Matsubara contour.">
</outline>
<outline text="Preparations" _note="To enforce conservation laws within cluster perturbation theory (CPT),&#10;we proceed in two steps. First, we work out that the CPT approach is not&#10;unique and that there are free parameters at one’s disposal. Second, to&#10;fix these parameters, we suggest to employ local constraints expressing&#10;the conservation laws that result from continuous symmetries of the&#10;Hubbard model. We start with a discussion of the main idea of the CPT&#10;and of the local constraints on the spin-dependent particle and doublon&#10;density.">
  <outline text="Conventional cluster perturbation theory" _note="The idea of the CPT is to partition the lattice into clusters small&#10;enough to be treated exactly, e.g., using Krylov-space methods or full&#10;diagonalization, and to subsequently include the connections between the&#10;clusters perturbatively. On the level of the Hamiltonian one starts by&#10;partitioning the full hopping matrix into the intra-cluster hopping and&#10;the inter-cluster hopping so that only contains terms which connect&#10;lattice sites within the individual clusters, while contains all&#10;remaining terms such that , see Fig. \[fig:cpt\_vs\_optcpt\].&#10;Corresponding to the intra-cluster hopping, we define a cluster&#10;Hamiltonian which describes the system of isolated clusters, also&#10;referred to as the reference system. Its Green’s function and&#10;self-energy are denoted as and , respectively.&#10;&#10;For the equilibrium as well as for the nonequilibrium case, the CPT can&#10;be seen as an all-order perturbation theory in the inter-cluster hopping&#10;which provides the one-particle Green’s function of the original system&#10;by expanding around the cluster Green’s function: We also have: In the&#10;noninteracting case, this is exact since . For finite , however, the CPT&#10;Green’s function represents an approximation of the exact Green’s&#10;function .&#10;&#10;A closer look reveals that the CPT is not unique since one may consider&#10;a different starting point for the all-order perturbation theory in . To&#10;this end, consider a starting point with a renormalized intra-cluster&#10;hopping, , resulting in a renormalized cluster Green’s function and&#10;self-energy . Correspondingly, also the inter-cluster hopping must be&#10;renormalized as . Summation of the geometrical series yields where we&#10;emphasized the special role of the renormalization parameter by square&#10;brackets. For , we have for any . For an interacting system, however,&#10;the choice for is crucial, i.e., the resulting CPT Green’s function does&#10;depend on the starting point of the all-order perturbation theory in the&#10;inter-cluster hopping.&#10;&#10;This ambiguity in the definition of the CPT seems to be problematic on&#10;first sight, yet it can be turned into an advantage by interpreting the&#10;renormalization as an optimization parameter. This has been worked out&#10;systematically in the context of the (nonequilibrium) self-energy&#10;functional theory (SFT), where the optimal is derived from a variational&#10;principle based on the self-energy. Here, we will take a different route&#10;and use the freedom in to enforce the local constraints on&#10;spin-dependent particle and doublon density. Physically, the parameter&#10;set must be interpreted as a nonlocal mean-field and the resulting&#10;conserving CPT as a cluster mean-field theory.">
  </outline>
  <outline text="Formulation of the conservation laws as local constraints" _note="While conservation laws like particle-number or energy conservation are&#10;naturally fulfilled if one is able to treat a physical problem exactly,&#10;this is not necessarily the case when working with approximate methods.&#10;For Green’s-function-based methods it was shown by Baym and Kadanoff&#10;that respecting certain symmetry relations for the two-particle Green’s&#10;function is sufficient to ensure that an approximation is conserving.&#10;&#10;Here, we build on an equivalent formulation of the macroscopic&#10;conservation laws for the particle number, spin and energy and&#10;reformulate them as local constraints for the spin-dependent particle&#10;density and the doublon density, respectively. This is in the spirit of&#10;expressing conservation laws of a classical field theory as continuity&#10;equations and follows the work of Baym and Kadanoff. One should note,&#10;however, that in our case the local constraints cannot be written in the&#10;standard form of continuity equations, as here we aim at an approach for&#10;a discrete lattice model.&#10;&#10;To discuss the local constraints, we first consider the exact time&#10;evolution of a system described by the Hubbard Hamiltonian . We write ,&#10;and in this subsection to keep the notation simple. The exact time&#10;evolution of the system will preserve the total particle number and the&#10;-component of the total spin as can be expressed by the following local&#10;constraint for the spin-dependent density: as can be verified directly&#10;using Eq. .&#10;&#10;The first line of Eq.  constitutes the discrete-lattice analog of the&#10;continuity equation for the spin-dependent particle density. Opposed to&#10;a continuum theory, however, the divergence of the spin-dependent&#10;particle-current density is replaced by the commutator. The second line&#10;of Eq.  is an equivalent formulation of the same constraint as has&#10;originally been mentioned by Baym and Kadanoff.&#10;&#10;Next, we consider the following local constraint for the doublon density&#10;\[cf. Eq. \]: In the exact theory, this constraint together with the&#10;above constraint expresses the necessity that the doublon density can be&#10;derived consistently from either or and for each spin component in Eq. .&#10;&#10;More important, in case of a time-independent Hamiltonian, i.e., if for&#10;, Eq.  (\[eq:con\_energy\]) implies total-energy conservation. This is&#10;explicitly shown in the Appendix \[ap:con\_double\_occ\] where, for&#10;completeness, also a formal derivation of Eq.  is carried out.&#10;&#10;While in the exact theory the equations and must hold necessarily, this&#10;is no longer guaranteed in an approximate approach. In particular, the&#10;equations are usually violated within the conventional CPT.&#10;&#10;The important point is that via Eqs. (\[eq:g2l\_def\]) and&#10;(\[eq:g2r\_def\]) both, and , can be expressed in terms of the&#10;single-particle Green’s function and the self-energy and thus both&#10;equations and can be expressed in terms of the central quantities of the&#10;CPT. Furthermore, as is shown below, they can be incorporated in the&#10;Markovian time-propagation scheme based on the Hamiltonian formulation&#10;of the CPT. The latter is essential for the numerical treatment.&#10;&#10;Our main idea is thus to enforce the local constraints and within the&#10;context of the CPT by exploiting the above-discussed freedom in the&#10;choice of the CPT starting point, i.e., by choosing an appropriate&#10;renormalization . If can be found, this automatically ensures the&#10;conservation of particle number, spin and energy.">
  </outline>
</outline>
<outline text="Hamiltonian-based formulation" _note="In the last section we have introduced the CPT in its usual form, i.e.,&#10;based on the self-energy of the reference system and Dyson’s equation. A&#10;major drawback of this approach is its limitation for the maximum&#10;propagation time that can be reached in a practical numerical&#10;calculation. This is due to the fact that the CPT Green’s function and&#10;the self-energy of the reference system are nonlocal in time through&#10;their dependence on two contour times. The necessary storage for these&#10;quantities scales quadratically with the maximum propagation time, the&#10;effort for solving Dyson’s equation scales cubically. This intrinsic&#10;limitation can be overcome if a so-called Lehmann representation of the&#10;self-energy is available. This allows us to solve the Dyson equation by&#10;means of a Markovian propagation scheme which permits to reach much&#10;longer time scales. In the following, we consider this Lehmann&#10;representation of the self-energy as given. Its existence for an&#10;arbitrary, fermionic lattice system out of equilibrium has been shown in&#10;Ref.  where also a constructive numerical scheme has been presented. It&#10;can be used in case of small clusters accessible to&#10;exact-diagonalization techniques. In the following we briefly recall the&#10;main results and then discuss the application to conservation laws and&#10;the respective local constraints.">
  <outline text="Convolution-free definition of  and" _note="The nonequilibrium self-energy of any lattice-fermion model has a unique&#10;Lehmann representation: Here, is the time-local Hartree-Fock term. The&#10;second term has a hybridization-function-like structure where denotes&#10;the hopping between a physical site and an additional VIRTUAL site&#10;labeled by the index . The time-independent on-site energy of the&#10;virtual site is given by . Furthermore, is the noninteracting Green’s&#10;function of an isolated one-particle mode () with excitation energy :&#10;Here, denotes the Fermi-function, and refers to the contour variant of&#10;the Heaviside step function, i.e., for , and otherwise.&#10;&#10;The hybridization-function-like structure is the immediate and important&#10;advantage of the Lehmann representation. It allows to write down an&#10;effective, noninteracting model specified by the Hamiltonian which&#10;reproduces the one-particle Green’s function EXACTLY when evaluated at&#10;the physical sites . We emphasize that includes all correlation effects&#10;through the hybridization strengths and on-site energies of the virtual&#10;sites. Furthermore, the previously mentioned interpretation of the&#10;-degrees of freedom as additional virtual sites becomes obvious in Eq. .&#10;&#10;For a given arbitrary self-energy one would typically have to consider a&#10;continuum of virtual sites. Here, however, the situation is much simpler&#10;since is the CPT self-energy, i.e., the self-energy of our reference&#10;model consisting of a system of decoupled clusters. In this case the&#10;total number of physical and of necessary virtual sites equals the&#10;number of single-particle excitations with nonzero weight. As the latter&#10;grows exponentially with the size of the individual cluster, the exact&#10;mapping and the exact numerical construction of the effective&#10;Hamiltonian is limited to clusters small enough to allow for an exact&#10;numerical diagonalization. The computation of the parameters of the&#10;effective Hamiltonian (\[eq:heff\]) is nontrivial but straightforward&#10;and numerically completely stable. Details are described in Ref. .&#10;&#10;For clarity, we use the following convention throughout the paper:&#10;Defining , the effective Hamiltonian can be written as&#10;(cf. Fig. \[fig:hcpt\]) The corresponding Green’s function is given on&#10;the physical but also on the virtual sites, so that the original,&#10;physical Green’s function is obtained if we restrict to physical sites&#10;only, i.e., .&#10;&#10;Many-particle correlation functions, e.g., spin-spin correlations, are&#10;in general not accessible from the effective Hamiltonian. There is,&#10;however, one important exception. Namely, the two-particle Green’s&#10;functions and can be expressed as contour convolutions of the system’s&#10;self-energy with the Green’s function, cf. Eqs.  and . In the&#10;Hamiltonian-based formalism this convolution is greatly simplified and&#10;becomes a straightforward matrix multiplication. By comparing Dyson’s&#10;equation with the equation of motion that follows from Eq. , one readily&#10;finds the identity An analogous relation can be derived for .&#10;&#10;The result can be written in a more compact form by defining a new&#10;quantity via and . This is consistent with the alternative definition&#10;given in Appendix \[ap:math\_eff\] which also holds for . In the&#10;physical sector it implies as follows from \[cf. Eqs. , and \]. With&#10;this definition for and with the relations and we get Recall at this&#10;point that quantities like or (as well as , , etc.) are functionals of&#10;and .">
  </outline>
  <outline text="Hamiltonian-based formulation of the CPT" _note="Let us now discuss how the CPT Green’s function can be obtained from an&#10;effective one-particle Hamiltonian and how to set up a Markovian&#10;time-propagation scheme. As discussed in Sec. \[sec:cpt\], we have where&#10;is the renormalized intra-cluster and the renormalized inter-cluster&#10;hopping. For each set of parameters , an effective one-particle CPT&#10;Hamiltonian can be defined by adding the inter-cluster hopping to the&#10;effective Hamiltonian of the reference system: The CPT Green’s function,&#10;as computed from , then coincides with the original definition in Eq. &#10;if only the physical sector is considered, i.e., . This can be verified&#10;easily by integrating out the virtual, degrees of freedom from . Eq. &#10;reflects the freedom we have in the CPT construction as the -terms&#10;cancel in the physical sector. only enters implicitly through the&#10;hybridization strengths , through the on-site energies (where ) and&#10;through the Hartree-Fock term of the reference system’s Hamiltonian .&#10;&#10;For each set of parameters , the two-particle correlation function is&#10;approximated within the context of the CPT as where we have defined&#10;Eq. (\[eq:g2lcpt\]) corresponds to the exact expression given by&#10;Eq.(\[eq:g2l\_hambased\]). is defined analogously, and thus the symmetry&#10;relation is ensured within the CPT independently of . Note that this&#10;symmetry is not sufficient to allow for an unambiguous definition of the&#10;doublon density based on and \[cf. Eq. \]. Instead, it requires both&#10;constraints to be respected as discussed in Sec. \[sec:con\_eqs\]. In&#10;case of an arbitrary, non-conserving set of parameters this ambiguity&#10;needs to be circumvented by defining the doublon density as an average&#10;For , however, we have The final forms of the conditional equations for&#10;are obtained by replacing and by their CPT approximations and in the&#10;expressions for and given by Eqs.  and : We note that the number of free&#10;parameters must be chosen to match the number of linear independent&#10;constraints defined by Eq. to ensure the existence of a unique solution&#10;.">
  </outline>
</outline>
<outline text="Solving the self-consistency equations" _note="Having formulated the self-consistency conditions (\[eq:selfcon\_cpt\]),&#10;it remains to explicitly solve these equations for . An important&#10;simplification arises from the fact that the CPT is by construction a&#10;fully causal theory, i.e., the time-local elements of the CPT Green’s&#10;function at time , for example, only depend on quantities at earlier&#10;times. The same holds for and for . This allows us to construct a&#10;strategy for the solution of Eq. (\[eq:selfcon\_cpt\]) in the form of a&#10;time-propagation algorithm. Let us therefore assume that is known for&#10;all time points on a discrete time grid and that only the parameters at&#10;the latest point of time are unknown.&#10;&#10;Therewith, the actual task is to solve Eq. (\[eq:selfcon\_cpt\]) for&#10;[ONLY AT THE GIVEN LATEST POINT OF TIME]{} . To this end we have to&#10;analyze at time the dependence of the relevant quantities, i.e., of and&#10;, see Eqs. (\[eq:con\_dens\]) and (\[eq:con\_energy\]). First of all,&#10;the dependence of (and ) on at time is due to the CPT Hamiltonian \[see&#10;Eq. (\[eq:hcpt\]) and see Eqs. (\[eq:gcpt\]) and (\[eq:g2lcpt\])\]. The&#10;-dependence of the latter is exclusively due to the time-evolution&#10;operator of the reference system. The detailed construction of is not&#10;important here, and we refer to Ref.  for a comprehensive discussion.&#10;Finally, the functional dependence of on is through an integration over&#10;all times between and . With this information at hand, we are in fact&#10;able to characterize the dependence on at time of the quantities and&#10;which enter the local constraints (\[eq:selfcon\_cpt\]) that serve to&#10;enforce the conservation laws.&#10;&#10;The most important point for the following discussion is the fact that,&#10;in the limit of vanishing time step , the parameter set at the latest&#10;point of time enters basically all central quantities as a null set&#10;only: Consider, for example, . Its first-order response due to a&#10;variation of at time [VANISHES]{} (as shown below). On the one hand,&#10;this missing sensitivity implies a complication of the theory since one&#10;has to account for this mathematical property explicitly when setting up&#10;a numerical implementation. On the other hand, once one has recognized&#10;the property, it actually helps to the solve Eqs. (\[eq:selfcon\_cpt\]).&#10;Consider a given arbitrary causal functional . The main trick is to&#10;enhance the sensitivity of to variations of at time by taking its time&#10;derivative. Typically, if the first-order response of vanishes, is a&#10;[LINEAR]{} function of at time . Clearly, this is the key to solve an&#10;equation like for .&#10;&#10;In the following subsections \[sec:a\] – \[sec:d\] the above-sketched&#10;ideas are worked out on a more technical level. Finally, the section&#10;\[sec:initial\_state\] addresses the initial state at time .">
  <outline text="Time-local variations" _note="Assume that we have found the optimal renormalization for . We introduce&#10;a variation which affects the current (the -th) time step only: For&#10;simplicity, we require the variations to be symmetric, i.e., . This&#10;implies a restriction to symmetric solutions . Consider now an&#10;arbitrary, causal functional , i.e., a functional that at time only&#10;depends on with . For such an object, the variational operator is&#10;related to the conventional functional derivative through where the&#10;restriction is necessary because of the symmetry requirement .&#10;&#10;We now take the combined limit such that we always have to define the&#10;time-local variation in the continuum limit with the corresponding&#10;variational quotient This variational quotient describes the linear&#10;response of when varying the parameters at the latest time step:">
  </outline>
  <outline text="Integrated quantities in" _note="With the appropriate variation for our purposes at hand, we can study&#10;the effect of the variation on the main quantities within the CPT&#10;framework. We first consider the time-evolution operator (“propagator”)&#10;of the reference system . It is instructive to study the effect of the&#10;operator first, i.e., the effect of a time-local variation with finite&#10;time step . Keeping only terms of the order one finds In lowest order we&#10;thus have . This means that the linear response vanishes identically in&#10;the limit . This property originates from the fact that is integrated&#10;over time within the propagator , and that the contribution of a single&#10;time step, , to this integral is of zero measure in the limit .&#10;&#10;A finite time-local variation is obtained for the first time derivative&#10;of the propagator rather than for the propagator itself. Namely, the&#10;corresponding time-local variational quotient remains non-zero in the&#10;continuum limit: Multiplying this equation with , summing over and&#10;comparing with the standard equation of motion , shows that the time&#10;derivative of the propagator is of the general form where . Note that&#10;the dependence on at time is strictly [LINEAR]{} in the limit .&#10;&#10;With this definition and with Eq. , it is obvious that the variational&#10;derivative and on the right-hand side of Eq. (\[eq:dU\_form\]) depend on&#10;only through an integration over time within the propagator . We will&#10;call such quantities INTEGRATED quantities in . Integrated quantities in&#10;inherit an important property from the cluster propagator , see Eq. :&#10;Their time-local variation vanishes in the limit .&#10;&#10;Furthermore, the time derivative of any quantity that is integrated in ,&#10;i.e., the time derivative of a functional of the form , can be brought&#10;into a form analogous to Eq. . This follows immediately from the chain&#10;rule in calculus as . Explicitly this result reads where and are again&#10;integrated quantities in . We furthermore conclude that a time-local&#10;variation of the time derivative of an integrated quantity in is&#10;non-zero in general.&#10;&#10;The main idea in the following is to combine the conditional equations&#10;into a single equation such that is of the form where and are integrated&#10;quantities in . This is formally easily solved for by matrix inversion&#10;and allows to derive an efficient propagation scheme for numerical&#10;purposes.">
  </outline>
  <outline text="-dependence of  and" _note="The main building blocks of the local constraints on the spin-dependent&#10;density, Eq.  , and the doublon density, Eq. , are given by the&#10;two-particle correlation functions and . Within the CPT approximation&#10;they are defined through Eq.  . We therefore have to understand the&#10;dependence of and .&#10;&#10;One can easily see that is an integrated quantity in . Consider, for&#10;example, the physical sector. From Eq. we have . The only -dependence of&#10;this expression indeed stems from the propagator . To obtain a&#10;non-vanishing time-local variation we thus have to consider the first&#10;derivative with respect to time. This is worked out in Appendix&#10;\[ap:d\_eta\]: where the newly introduced tensor is cluster-diagonal,&#10;i.e., if and only if and refer to lattice sites within the same cluster.&#10;It furthermore follows that can be brought into the form specified by&#10;Eq. , where the variational derivative , as given by Eq. , and are&#10;integrated quantities in . An explicit expression for the latter is not&#10;needed for our purposes.&#10;&#10;Let us now take a look at the CPT Green’s function. It depends on&#10;through the Hamiltonian , which in turn depends on through the&#10;hybridization strengths and the Hartree-Fock term . The Hamiltonian is&#10;therefore an integrated quantity in . As the propagator involves a&#10;second integral over time, we conclude that . In this sense, must be&#10;seen as an integrated quantity in of second order. Consequently, the&#10;time-local variation of its first derivative with respect to time&#10;vanishes: We note that the time derivative involves the product of the&#10;matrix elements of the CPT Hamiltonian, Eq. (\[eq:hcpt\]), with , i.e.,&#10;the product of an integrated quantity in with an integrated quantity in&#10;of second order, respectively. Obviously, the product scales like an&#10;ordinary integrated quantity in when a time-local variation is applied,&#10;i.e., in lowest order in .&#10;&#10;Concluding, to get a non-vanishing time-local variation, one must&#10;consider the first time derivative of the two-particle Green’s functions&#10;and . We find and an analogous expression for . Only the -term&#10;contributes to the variation, cf. Eq. , while the variation of the CPT&#10;Green’s function vanishes, cf. Eq. . We also note that Eq.  may be used&#10;at this point and that \[and analogously \] is of the form where both,&#10;the variational derivative , as given by Eq. , and the quantity , which&#10;is not needed in explicit form for our purposes, scale like integrated&#10;quantities in under time-local variations. This follows from the fact&#10;that scales like an integrated quantity in under time-local variations&#10;and the related discussion above.">
  </outline>
  <outline text="-dependence of the local constraints" _note="The local constraint on the spin-dependent density, Eq., is formulated&#10;in terms of the difference between and . Therefore its first derivative&#10;with respect to time must be considered to obtain a non-vanishing&#10;time-local variation: For the time-local variation of the local&#10;constraint on the doublon density, Eq. , on the other hand, one finds&#10;since , where we made use of the fact that is the hopping of the&#10;original system and thus independent of .&#10;&#10;To treat both constraints in a combined formal frame, we define the&#10;functional : where is the number of lattice sites. With this, the&#10;conditional equation for the optimal renormalization reads . From the&#10;previous discussion and Eq.  it follows that is of the form where we&#10;introduced the super-index which labels the set of free parameters: , .&#10;Both and scale like integrated quantities in under time-local&#10;variations. The Jacobian matrix is defined as The matrix is quadratic if&#10;the number of free parameters is chosen such that it equals the number&#10;of conditional equations \[see Eq. \]. Assuming that is regular, one can&#10;formally solve the conditional equation for the optimal renormalization:&#10;see Eq. (\[eq:Gform\]). This completes our derivation.&#10;&#10;Let us emphasize that the single point represents a null set with&#10;respect to the time-integrations in and . This can be exploited to&#10;derive an efficient numerical scheme to obtain step by step on the time&#10;axis as detailed in Appendix \[sec:high-order\]. There we also argue why&#10;finding an explicit expression for can in fact be circumvented. An&#10;explicit expression for in terms of known quantities, on the other hand,&#10;is available via Eqs. , , and .">
  </outline>
  <outline text="The equilibrium initial state" _note="Initially, at time the system is assumed to be in a thermal state. The&#10;CPT approximation for the initial thermal state suffers from the fact&#10;that the starting point of the all-order perturbation theory in the&#10;inter-cluster hopping is not unique. This is completely analogous to the&#10;CPT description of the real-time dynamics. Unlike the real-time&#10;dynamics, however, the local constraints cannot be used to fix the&#10;renormalization parameters for the initial state, and thus a nontrivial&#10;self-consistency condition is not available, unfortunately.&#10;&#10;This can be seen as follows: Let us assume that the hopping matrix , and&#10;consequently and , are real and symmetric. Consider at times . Via Eq. &#10;this is given as . In Appendix \[ap:math\_eff\] it is shown that at time&#10;the imaginary part vanishes, independently of . Hence, Eq.  implies that&#10;is real and symmetric, and therefore is purely imaginary. Consequently,&#10;is real. Finally, we conclude with Eq. that This directly proves that ,&#10;and furthermore irrespective of , i.e., both constraints hold trivially.&#10;&#10;For the concrete numerical calculations we therefore circumvent this&#10;issue and consider a noninteracting initial state. In this case the CPT&#10;is exact, independent of the choice of . The initial value is then fixed&#10;by requiring to be continuous so that .">
  </outline>
</outline>
<outline text="Numerical results" _note="The conserving CPT has been implemented numerically. First results are&#10;discussed for the two-dimensional Hubbard model on an square lattice&#10;with periodic boundary conditions. As these results shall serve as a&#10;proof of concept only, we restrict ourselves to the most simple&#10;approximation, i.e., to the smallest meaningful cluster as the building&#10;block of the reference system, namely a cluster consisting of sites.&#10;Hence, the entire system is partitioned into clusters in total, see&#10;Fig. \[fig:setup\].&#10;&#10;Initially, the system is prepared in its noninteracting ground state at&#10;half-filling by choosing . Note that the CPT description of this initial&#10;state is exact (and independent of the renormalization). The hopping of&#10;the original system is restricted to nearest neighbors, and we set the&#10;nearest-neighbor hopping to fix energy and time units. To drive the&#10;system out of equilibrium we consider an interaction quench where the&#10;Hubbard- is suddenly, at time , switched on to a finite value : Here,&#10;denotes the Heaviside step function. For times the interaction strength&#10;is constant. To maintain particle-hole symmetry and half-filling, the&#10;chemical potential is quenched as well, from to in the final state.&#10;&#10;Studying the model at the particle-hole symmetric point is convenient&#10;since the conservation of the total particle number is trivially&#10;respected in this case. For a spin-independent parameter quench, as&#10;considered here, the CPT also trivially respects the conservation of the&#10;total spin. Total-energy conservation, on the other hand, is violated in&#10;a conventional CPT approach as has been explicitly demonstrated&#10;recently. For the present setup we will therefore employ the&#10;nearest-neighbor hopping within the reference system to enforce the&#10;energy-conservation law. This specifies the time-dependent&#10;renormalization parameter (see Fig.\[fig:setup\]).&#10;&#10;We note that the computational effort to self-consistently evaluate the&#10;presented theory numerically is essentially determined by the underlying&#10;solver for the conventional nonequilibrium CPT with little overhead.&#10;Here, we use the time-local, Hamiltonian-based solver developed in Ref. &#10;which constructs the effective Hamiltonian of each cluster by exact&#10;diagonalization. For the reference system under consideration, only two&#10;virtual sites are needed for an exact mapping. This gives us four sites&#10;per cluster so that the CPT-Hamiltonian comprises sites in total.&#10;Furthermore, regarding computational demands, our approach inherits a&#10;constant memory consumption from the CPT solver as well as the linear&#10;scaling in the maximum propagation time. In particular, we have used a&#10;time step of to propagate the system up to steps up to a maximum&#10;propagation time of . For each such time step , the scheme developed in&#10;Appendix \[sec:high-order\] has been employed with , i.e., we have&#10;calculated the Taylor coefficients and .&#10;&#10;While the required computational resources are very moderate, accessing&#10;longer time scales has turned out to be hindered by mathematical&#10;complications. As is obvious from Eq. , an inversion of the Jacobian&#10;matrix is necessary to obtain at each time step. However, with&#10;increasing this matrix exhibits singular points of non-invertibility at&#10;earlier and earlier times. In fact, one finds numerically that also the&#10;starting point is singular, namely the Jacobian matrix vanishes: .&#10;Fortunately, one also has , such that this problem is fixed by applying&#10;L’Hôpital’s rule. At time , the defining equation for becomes While this&#10;solves the problem at time , finding a systematic and convenient way to&#10;propagate beyond the singular points of the Jacobian matrix at&#10;[FINITE]{} times remains topic for future investigations.&#10;&#10;Apart from this technical problem, the suggested scheme works as&#10;expected. Results for the time evolution of the doublon density are&#10;shown in Fig.\[fig:docc\]. It is evident that the renormalization has a&#10;strong influence on the dynamics and leads to qualitatively different&#10;results when comparing the plain unoptimized CPT calculation with the&#10;novel conserving CPT. While the dynamics is characterized by ongoing&#10;oscillations when using plain CPT, there is a monotonic decay of the&#10;doublon density in case of the conserving CPT. The longest maximum&#10;propagation time is achieved for the quench . Here, the first singular&#10;point of the Jacobian shows up at . On this time scale, the doublon&#10;density seems to relax to a stationary state with little to no&#10;oscillations.&#10;&#10;The qualitatively different time dependence of the doublon density&#10;reflects the qualitatively different behavior found for the total energy&#10;in the plain and the conserving CPT: This is shown in the inset of&#10;Fig. \[fig:energy\]. For the conserving CPT, the total energy is&#10;perfectly conserved within numerical accuracy – by construction of the&#10;approach. In the plain CPT calculation, however, the total energy shows&#10;unphysical oscillations. Here, maxima and minima of nicely correspond to&#10;maxima and minima in the plain-CPT doublon density seen in&#10;Fig. \[fig:docc\]. It must be concluded that those are artifacts of the&#10;plain CPT approach. We also note that small unphysical oscillations of&#10;the total energy [DENSITY]{} (with ) with amplitudes less than lead to&#10;much stronger oscillations in the doublon density with amplitudes of&#10;about 0.04.&#10;&#10;The main part of Fig. \[fig:energy\] displays the results for the time&#10;evolution of the renormalization parameter . Its dependence on turns out&#10;to be rather weak on a time scale of a few inverse hoppings.&#10;Irrespective to the final interaction strength , the initial equilibrium&#10;value is found as . For and for all , the renormalization parameter&#10;rapidly increases to within a very short time . This corresponds to the&#10;rapid initial drop of the doublon density (cf. Fig.\[fig:docc\]).&#10;Results for longer times are again only available for the quench . On&#10;the time scale up to , we observe a subsequent slow relaxation of toward&#10;an average final value with small superimposed oscillations. It seems&#10;reasonable to assume that a similar behavior would also be found for the&#10;other quenches, given that the short-time dynamics is very similar for&#10;the different .&#10;&#10;One should note that amounts , i.e., a vanishing renormalized&#10;intra-cluster hopping. Apart from the remaining oscillations of the&#10;renormalization parameter around , this means that the system “chooses”&#10;the atomic limit of the Hubbard model as the optimal starting point for&#10;the all-order perturbation theory in the inter-cluster hopping for long&#10;times. This may be interpreted as follows: First of all, the remaining&#10;oscillations are understood as being necessary to keep the total energy&#10;constant within the conserving CPT. Disregarding the oscillations, the&#10;value means that, on the level of the reference system, the doublon&#10;density becomes a conserved quantity for long times. This, however, is&#10;in fact a plausible starting point if the doublon density of the full&#10;lattice model approaches a constant in the course of time. As is seen in&#10;Fig. \[fig:docc\], this is almost the case. The remaining time&#10;dependence of the doublon density of the lattice model is weak and would&#10;be exclusively due to the inter-cluster hopping (if exactly).&#10;&#10;Let us compare the CPT result for the doublon density with the results&#10;of previous calculations for the one-dimensional Hubbard model using the&#10;density-matrix renormalization group (DMRG) and for the model in&#10;infinite dimensions using the dynamical mean-field theory (DMFT). In&#10;both cases, a very fast relaxation of the doublon density on a time&#10;scale of one inverse hopping has been found in fact. Typically, however,&#10;the doublon density first develops a minimum before it saturates to an&#10;almost constant value. This minimum is absent in the conserving CPT&#10;calculations (see Fig.\[fig:docc\]). Note, that for weak quenches and on&#10;the intermediate time scale discussed here and in the DMRG and DMFT&#10;studies, the doublon density does not relax to its thermal value due to&#10;kinematic constraints becoming active after the ultrashort initial&#10;relaxation step. Indeed, one expects a subsequent relaxation on a much&#10;longer time scale. Let us emphasize that while our data in&#10;Fig. \[fig:docc\] are compatible with these expectations, serious&#10;predictions using the conserving CPT are not yet possible. This would&#10;require a much more systematic study involving different and in&#10;particular larger clusters, an analysis of the dependence on the cluster&#10;shape and also a systematic discussion of the different possibilities to&#10;choose renormalization parameters for the self-consistent procedure.">
</outline>
<outline text="Conclusions" _note="Cluster-perturbation theory, as proposed originally, represents the most&#10;simple way to construct a mean-field theory which incorporates to some&#10;extent the effects of short-range correlations. We have emphasized that&#10;the starting point of the perturbational expansion in the inter-cluster&#10;hopping is by no means predetermined and that the according freedom in&#10;the choice of the intra-cluster hopping parameters can be exploited to&#10;“optimize” the mean-field theory. There are different conceivable&#10;optimization schemes. One way is to add an additional self-consistency&#10;condition as, for example, a self-consistent renormalization of the&#10;on-site energies which would be very much in the spirit of the Hubbard-I&#10;approximation. The disadvantage of such ideas is their [AD HOC]{}&#10;character. An optimization following a general variational principle is&#10;much more satisfying and physically appealing. This is the route that is&#10;followed up by self-energy-functional theory. Unfortunately,&#10;total-energy conservation is not straightforwardly implemented within&#10;the SFT context. An appealing idea is thus to use the above-mentioned&#10;freedom to [ENFORCE]{} energy conservation, and actually any&#10;conservation law dictated by the symmetries of the problem at hand. This&#10;leads to the conserving CPT proposed in the present paper.&#10;&#10;As we have argued (see Sec. \[sec:initial\_state\]), this idea can&#10;exclusively be used to constrain the CPT real-time dynamics while other&#10;concepts must be invoked for the initial thermal state. On the other&#10;hand, there is an urgent need for numerical approaches, even for&#10;comparatively simple cluster mean-field concepts, which are able to&#10;address the real-time dynamics of strongly correlated lattice fermion&#10;models beyond the more simple extreme limits of one and infinite lattice&#10;dimension.&#10;&#10;With the present paper we could give a proof of principle that a&#10;nonequilibrium conserving cluster-perturbation theory is possible and&#10;can be evaluated numerically in practice. An highly attractive feature&#10;of this approach is the linear scaling with the propagation time, while&#10;the exponential scaling with the cluster size is the typical bottleneck&#10;of any cluster mean-field theory.&#10;&#10;The mapping of the original nonequilibrium CPT onto an effective&#10;auxiliary problem specified by a noninteracting Hamiltonian with&#10;additional virtual (“bath”) degrees of freedom is crucial for the&#10;practical implementation of the approach. One should note that the&#10;number of virtual sites is related to the number of one-particle&#10;excitations and thus grows exponentially with the original cluster size.&#10;Hence, any practical calculation is limited to a few (say, at most 10)&#10;cluster sites only. This implies that a systematic finite-size scaling&#10;analysis will be problematic if long-range correlations dominate the&#10;essential physical properties – this is the above-mentioned drawback&#10;that is shared with any available cluster-mean-field theory. We&#10;therefore expect that the field of applications of conserving CPT is&#10;limited to problems with possibly strong but short-ranged correlations.&#10;&#10;Due to its formulation in terms of Green’s functions with time arguments&#10;on the Keldysh contour, the CPT has an inherently causal structure. With&#10;the present paper we could in particular demonstrate how to exploit this&#10;causality for an efficient time-stepping algorithm where updates of the&#10;parameter renormalization can be limited to the respective last time&#10;slice during time propagation. The essential problem that had to be&#10;solved here consists in controlling the order (in the sense of a Taylor&#10;series) at which the parameter renormalization on a single time slice&#10;enters other physical quantities, such as the basic time-evolution&#10;operator, Green’s functions, etc. This has allowed us to set up a highly&#10;accurate numerical algorithm where conservation laws are respected with&#10;machine precision.&#10;&#10;For convenience, first numerical results have been generated for&#10;interaction quenches of the two-dimensional Hubbard model on a square&#10;lattice at half-filling, where particle-number and spin conservation are&#10;respected trivially. Energy conservation has been enforced by&#10;time-dependent renormalization of the intra-cluster hopping in the&#10;reference cluster. It is worth pointing out that even with this simple&#10;approximation (small cluster) the impact of the self-consistency&#10;condition is substantial. Comparing the conserving against plain CPT,&#10;there is a qualitative change of the time-dependence of the doublon&#10;density which is plausible and improves the theory: Artificial&#10;oscillations due to the finite cluster size are almost completely&#10;suppressed, and an ultrafast relaxation to a (prethermal) state with&#10;nearly constant doublon density is predicted as might be expected from&#10;previous computations for one- and infinite-dimensional lattices.&#10;&#10;Let us emphasize once more that the purpose of the present paper has&#10;been to formally develop the very idea of a constrained CPT and to&#10;provide a proof of principle for its practicability. There are a couple&#10;of future tasks that suggest themselves immediately but are beyond the&#10;scope of the present paper: First of all, a more systematic study of the&#10;dependence on the cluster size and shape is needed. Note that this also&#10;includes the necessity to take into account more than a single&#10;optimization parameter as there are four local constraints to be&#10;satisfied in the present formulation of the theory \[see&#10;Eq. (\[eq:selfcon\_cpt\])\], corresponding to the conservation of spin&#10;and particle density as well as two constraints for the doublon density&#10;(implying energy conservation). Hence, for a cluster consisting of&#10;sites, at most parameters are needed. In addition, both the number of&#10;constraints and the optimization parameters depend on the spatial&#10;symmetries and other symmetries, e.g., particle-hole symmetry, of the&#10;original and the reference system. If necessary, more degrees of freedom&#10;and correspondingly more parameters can be generated by coupling&#10;uncorrelated “bath” sites to the physical sites in the reference system&#10;in the spirit of (cluster) dynamical mean-field theory. Systematic&#10;studies addressing the mentioned issues are necessary before a&#10;systematic and quantitative comparison with other approaches or with&#10;experiments is meaningful.&#10;&#10;Interestingly, the conditional equations for the renormalization&#10;parameters feature singular points of non-invertibility. Technically,&#10;this currently restricts our investigations to quenches with small final&#10;interaction and short propagation times. It is not clear at the moment&#10;whether or not a physical meaning can be attributed to those singular&#10;points; also this requires further systematic studies. According to our&#10;present experience, it is well conceivable that, with a suitable&#10;regularization scheme, time propagation through a singularity of the&#10;Jacobian is possible and has no apparent impact on the time dependence&#10;of physical observables. Developing such a regularization scheme is the&#10;next task for future studies and the most important issue to make the&#10;conserving CPT a powerful numerical tool to address, e.g., real-time&#10;magnetization dynamics, even of inhomogeneous models and on long time&#10;scales.&#10;&#10;We thank Roman Rausch for providing an exact-diagonalization solver for&#10;the Hubbard model and Felix Hofmann for valuable discussions. This work&#10;has been supported by the Deutsche Forschungsgemeinschaft through the&#10;excellence cluster “The Hamburg Centre for Ultrafast Imaging -&#10;Structure, Dynamics and Control of Matter at the Atomic Scale” and&#10;through the Sonderforschungsbereich 925 (project B5). Numerical&#10;calculations were performed on the PHYSnet computer cluster at the&#10;University of Hamburg.">
</outline>
<outline text="Local constraint on the doublon density" _note="Within this subsection we will use the shorthand notation and . To prove&#10;the local constraint on the doublon density, we consider where we used&#10;that the double occupation operator commutes with the interaction term&#10;of the Hamiltonian . Using further that we find the final form by&#10;comparing with Eqs.  and and using the relation . This implies which&#10;completes our derivation of Eq. .&#10;&#10;To prove that Eq. indeed ensures energy conservation, let us consider a&#10;time-independent Hamiltonian with and . We consider the time-derivative&#10;of the kinetic energy first. Since the kinetic part of the Hamiltonian&#10;trivially commutes with itself, one obtains This term cancels with&#10;assuming Eq. holds thus proving energy conservation for a&#10;time-independent Hamiltonian.">
</outline>
<outline text="Mathematical structure of the effective Hamiltonian" _note="In Eq.  we have stated the effective one-particle Hamiltonian for an&#10;interacting lattice system. Its corresponding matrix elements are given&#10;by , cf.  Eq. . In Ref.  it is shown that can be constructed from the&#10;Lehmann representation of the one-particle Green’s function . It is&#10;given by The matrix can explicitly be stated within the physical sector&#10;only (i.e., ). There it takes the form where denotes the -th eigenstate&#10;with corresponding eigenenergy of the initial Hamiltonian, i.e., .&#10;denotes the grand-canonical partition function, the inverse temperature&#10;of the equilibrium initial state. The remaining matrix elements are&#10;defined uniquely, up to rotations in invariant subspaces, by requiring&#10;to be a unitary transform, see Ref.  for details. Eq.  is now easily&#10;derived from where With the definition we arrive at Eq. . It is&#10;instructive to note that the elements in the physical sector are easily&#10;evaluated as where denotes the anti-commutator. From a numerical point&#10;of view we note, that as well as its derivatives with respect to time of&#10;arbitrary order can be easily evaluated using the&#10;exact-diagonalization-based scheme presented in Ref. .&#10;&#10;Regarding our discussion of the initial state in&#10;Sec. \[sec:initial\_state\] it is now easy to proof that . At time the&#10;elements can be chosen as real, since the Hamiltonian is symmetric and&#10;therefore has real eigenvectors . Similarly, the physical sector is real&#10;in this case and completion to a unitary matrix allows for an&#10;orthogonal, i.e., real . It then follows that from Eq. . We note that&#10;any non-real choice can be brought into the form , where the matrix&#10;contains the phase factors and possibly rotations in invariant&#10;subspaces. However, from Eq. it follows that and therefore the matrix&#10;cancels. The same proof holds for the reference system, i.e., , assuming&#10;is real.">
</outline>
<outline text="Calculating the time-local variation of" _note="Let denote the matrix elements of the effective Hamiltonian of the&#10;reference system , cf. Eqs. and . Through Eq. , or equivalently Eq.  , a&#10;corresponding matrix is defined. We are interested in how it transforms&#10;under time-local variations. Since is an integrated quantity in , we&#10;first calculate its derivative with respect to time. Eq.  implies where&#10;and . With , the time-local variation of is given by where we further&#10;introduced and exploited . The time-local variation of , on the other&#10;hand, vanishes since it is an integrated quantity in . This follows&#10;directly from the definition of its physical sector, cf. Eq. . We define&#10;and therewith obtain Eq. .">
</outline>
<outline text="High-order time propagation scheme" _note="Finally, we like to set up an efficient numerical scheme to determine .&#10;This should be based on a time-propagation algorithm where the error is&#10;of high order in the basic time step . Let us assume that for each time&#10;step the Taylor expansion of is well defined. For each time interval and&#10;for arbitrary we then have where each -term must be considered as a&#10;tuple with components labelled by the super-index , e.g., , where refers&#10;to the -th time interval, and where runs from up to the maximum order of&#10;the polynomial . During the time propagation, the polynomial&#10;approximation must be updated after each time step. This is done by&#10;fixing the coefficients at each interfacing time such that . For times&#10;we then have . Writing and for short and applying the product rule to ,&#10;the self-consistency condition is readily rewritten in terms of the&#10;Taylor coefficients:&#10;&#10;Suppose that is known for all , i.e., suppose that the propagation has&#10;been completed over the interval . The next step is to update the&#10;coefficients. At this point we can exploit that and scale like&#10;integrated quantities in under time-local variations which implies and .&#10;Hence, at , both are independent of . We define Then, and we are now&#10;able to solve Eq.  for . The first derivatives and explicitly depend on&#10;, which is now known, but are integrated quantities in the first&#10;derivative , i.e., they are independent of . Therefore, the same idea&#10;can be applied and in fact be repeated again and again until finally is&#10;known up to the desired order. We emphasize that the presented algorithm&#10;gives a fully converged for within a single iteration.&#10;&#10;[51]{} natexlab\#1[\#1]{}bibnamefont \#1[\#1]{}bibfnamefont&#10;\#1[\#1]{}citenamefont \#1[\#1]{}url \#1[`#1`]{}urlprefix\[2\][\#2]{}&#10;\[2\]\[\][[\#2](#2)]{}&#10;&#10;, , , , ****, ().&#10;&#10;, , , , , , ****, ().&#10;&#10;, ****, ().&#10;&#10;, , , ****, ().&#10;&#10;, , , , ****, ().&#10;&#10;, in: Computational Many-Particle Physics, Vol. 739 of Lecture Notes in&#10;Physics, edited by H. Fehske, R. Schneider, and A. Weiße, pp. 277 (, ,&#10;).&#10;&#10;, ****, ().&#10;&#10;P. Werner, T. Oka, and A. J. Millis, Phys. Rev. B ****, ().&#10;&#10;, ****, ().&#10;&#10;, , , , ****, ().&#10;&#10;, ****, ().&#10;&#10;, ****, ().&#10;&#10;, ****, ().&#10;&#10;, , , , , ****, ().&#10;&#10;, , , ****, ().&#10;&#10;, , , ****, ().&#10;&#10;, , , , ****, ().&#10;&#10;, ****, ().&#10;&#10;, ****, ().&#10;&#10;, ****, ().&#10;&#10;, , , ****, ().&#10;&#10;, , , ****, ().&#10;&#10;, , , , ****, ().&#10;&#10;, ****, ().&#10;&#10;, , Ed. by A. Avella and F. Mancini, Springer Series in Solid-State&#10;Sciences, Vol. 171, p. 303 (, , ).&#10;&#10;, , , ****, ().&#10;&#10;, , , , , ****, ().&#10;&#10;, ****, ().&#10;&#10;, , , ****, ().&#10;&#10;, , , ****, ().&#10;&#10;, , , ****, ().&#10;&#10;, ****, ().&#10;&#10;, cond-mat/0202046.&#10;&#10;, , , ****, ().&#10;&#10;, , , , ****, ().&#10;&#10;, , , , ****, ().&#10;&#10;, ****, ().&#10;&#10;, ****, ().&#10;&#10;, ****, ().&#10;&#10;, , , ****, ().&#10;&#10;, ****, ().&#10;&#10;, , , , ****, ().&#10;&#10;, ****, ().&#10;&#10;, , , , , , , , , ****, ().&#10;&#10;, , , ****, ().&#10;&#10;, ****, () \[Sov. Phys. JETP 20, 1018 (1965)\].&#10;&#10;, (, , ).&#10;&#10;, , , , , , vol. of (, , ).&#10;&#10;R. Rausch and M. Potthoff, Phys. Rev. B [**95**]{}, 045152 (2017)&#10;&#10;, ****, ().&#10;&#10;, , , , , ****, ().">
</outline>
  </body>
</opml>