\begin{tikzpicture}[every node/.style={thick,rectangle,inner sep=0pt}]
\def\recB{3.5}
\def\recX{3.5}
\def\recXX{3.5}
\def\recXXX{3.5}
\def\aXX{0.5}
\def\recY{0.5}
\def\midX{0.75}
\def \a {0.6}
\node (d1) at (0 * \recB, 1.5) [draw=black,rectangle,minimum width = \recB cm, minimum height = \recY cm] {\small$0$th row of $\mathbf{H}$};
\node (md1) [right=-1pt of d1, draw=black,rectangle,minimum width = \midX cm, minimum height = \recY cm] {$\dots$};
\node (d2) [right=-1pt of md1,draw=black,rectangle,minimum width = \recB cm, minimum height = \recY cm] {\small$j$th row of $\mathbf{H}$};
\node (md2) [right=-1pt of d2, draw=black,rectangle,minimum width = \midX cm, minimum height = \recY cm] {$\dots$};
\node (d3) [right=-1pt of md2,draw=black,rectangle,minimum width = \recB cm, minimum height = \recY cm] {\small($m-1$)th row of $\mathbf{H}$};
\node at (d1.north) [anchor=south] {$B_0$};
\node at (d2.north) [anchor=south] {$B_j$};
\node at (d3.north) [anchor=south] {$B_{m-1}$};

\node (a1) at (0 * \recX + \aXX, 0) [draw=black,rectangle,minimum width = \recX cm, minimum height = \recY cm] {$h_{j, (0, \ast, \dots, \ast)}$};
\node (m1) [right=-1pt of a1, draw=black,rectangle,minimum width = \midX cm, minimum height = \recY cm] {$\dots$};
\node (a2) [right=-1pt of m1,draw=black,rectangle,minimum width = \recX cm, minimum height = \recY cm] {$h_{j, (\ell_0, \ast, \dots, \ast)}$};
\node (m2) [right=-1pt of a2, draw=black,rectangle,minimum width = \midX cm, minimum height = \recY cm] {$\dots$};
\node (a3) [right=-1pt of m2,draw=black,rectangle,minimum width = \recX cm, minimum height = \recY cm] {$h_{j, (L_{0} - 1, \ast, \dots, \ast)}$};

\node (sum1) [below=8pt of a2] {\large$\sum$};
\node at (a1.north) [anchor=south] {$H_{j,0}$};
\node at (a2.north) [anchor=south] {$H_{j,\ell_0}$};
\node at (a3.north) [anchor=south] {$H_{j, L_0-1}$};


\node (b1) at (0 * \recXX + 2*\aXX, -1.5) [draw=black,rectangle,minimum width = \recXX cm, minimum height = \recY cm] {$h_{j, (\ell_0, 0, \ast, \dots, \ast)}$};
\node (mb1) [right=-1pt of b1, draw=black,rectangle,minimum width = \midX cm, minimum height = \recY cm] {$\dots$};
\node (b2) [right=-1pt of mb1,draw=black,rectangle,minimum width = \recXX cm, minimum height = \recY cm] {$h_{j, (\ell_0, \ell_1, \ast, \dots, \ast)}$};
\node (mb2) [right=-1pt of b2, draw=black,rectangle,minimum width = \midX cm, minimum height = \recY cm] {$\dots$};
\node (b3) [right=-1pt of mb2,draw=black,rectangle,minimum width = \recXX cm, minimum height = \recY cm] {$h_{j, (\ell_0, L_{1} - 1, \ast, \dots, \ast)}$};

\node (sum2) [below=8pt of b2] {\large$\sum$};

\draw [thick, black, dashed] (a2.south west) -- (b1.north west);
\draw [thick, black, dashed] (a2.south east) -- (b3.north east);

\node (c1) at (0 * \recXXX + 3*\aXX, -3) [draw=black,rectangle,minimum width = \recXXX cm, minimum height = \recY cm] {$h_{j, (\ell_0, \ell_1, 0,  \ast, \dots, \ast)}$};
\node (mc1) [right=-1pt of c1, draw=black,rectangle,minimum width = \midX cm, minimum height = \recY cm] {$\dots$};
\node (c2) [right=-1pt of mc1,draw=black,rectangle,minimum width = \recXXX cm, minimum height = \recY cm] {$h_{j, (\ell_0, \ell_1, \ell_2,\ast,  \dots, \ast)}$};
\node (mc2) [right=-1pt of c2, draw=black,rectangle,minimum width = \midX cm, minimum height = \recY cm] {$\dots$};
\node (c3) [right=-1pt of mc2,draw=black,rectangle,minimum width = \recXXX cm, minimum height = \recY cm] {$h_{j, (\ell_0, \ell_1, L_{2} - 1, \ast, \dots, \ast)}$};

\draw [thick, black, dashed] (b2.south west) -- (c1.north west);
\draw [thick, black, dashed] (b2.south east) -- (c3.north east);

\draw [thick, black, dashed] (d2.south west) -- (a1.north west);
\draw [thick, black, dashed] (d2.south east) -- (a3.north east);

\node (dots1) [below=4pt of c2] {\large$\ddots$};

\node (e1) at (0 * \recXXX + 3.5*\aXX, -4.5) [draw=black,rectangle,minimum width = \recXXX cm, minimum height = \recY cm] {$h_{j, (\ell_0, \ell_1, \dots, 0)}$};
\node (me1) [right=-1pt of e1, draw=black,rectangle,minimum width = \midX cm, minimum height = \recY cm] {$\dots$};
\node (e2) [right=-1pt of me1,draw=black,rectangle,minimum width = \recXXX cm, minimum height = \recY cm] {$h_{j, (\ell_0, \ell_1, \dots, \ell_{\lambda-1})}$};
\node (me2) [right=-1pt of e2, draw=black,rectangle,minimum width = \midX cm, minimum height = \recY cm] {$\dots$};
\node (e3) [right=-1pt of me2,draw=black,rectangle,minimum width = \recXXX cm, minimum height = \recY cm] {$h_{j, (\ell_0, \ell_1, \dots, L_{\lambda-1})}$};

\node (sum3) [below=12pt of e2,draw,circle, inner sep=3pt]{\large $6$};

\def\inputKeys{{"*","B_j","*","*","B_j","B_j","*","*","B_j","*","*","B_j","*","*","B_j","*"}}

\def\localOffset{{"*","0","*","*","1","2","*","*","3","*","*","4","*","*","5","*"}}

\node (A) at (0 * \recXXX + 4*\aXX, -6.5) [minimum height = \recY cm] {\text{buckets    }};
\node (l) [below=0pt of A, minimum height = \recY cm] {\small\text{local offset  }};
\foreach \x in {0,...,15}{
	\node (A) [right=-1pt of A, draw=black,rectangle,minimum width = \a cm, minimum height = \recY cm] {$\pgfmathparse{\inputKeys[\x]}\pgfmathresult$};
	\node (l) [below=6pt of A] {$\pgfmathparse{\localOffset[\x]}\pgfmathresult$};
	\ifthenelse{\x=1 \OR \x=4 \OR \x=5 \OR \x=8 \OR \x=11 \OR \x=14}{\draw(A.north)--(sum3);}{}	
}

\draw [thick,black] (sum3.north) -- (e2.south);
\end{tikzpicture}